import{d as a,g as l,n}from"./index.1d7144b8.js";const u=a({name:"VideoPlayerPlugin",props:{root:{type:String,required:!0},subfolder:{type:String,required:!0},yamlConfig:String,config:Object,thumbnail:Boolean},data:()=>({movieSource:"",title:"",myState:{},fileApi:null,playerOptions:{muted:!1,language:"en",playbackRates:[.5,1,1.5,2,5],preload:"metadata",responsive:!0,fluid:!1,playsInline:!0,controls:!0,sources:[]}}),beforeDestroy(){this.thumbnail||l.commit("setFullScreen",!1)},mounted(){this.fileApi=this.getFileSystem(this.root),this.myState={subfolder:this.subfolder,yamlConfig:this.yamlConfig,thumbnail:this.thumbnail,imageData:""},this.playerOptions.fluid=!!this.thumbnail,this.thumbnail||l.commit("setFullScreen",!0),this.yamlConfig?(this.myState.subfolder=this.subfolder,this.myState.yamlConfig=this.yamlConfig,this.buildMovieSource()):this.buildRouteFromUrl(),this.getVizDetails()},watch:{yamlConfig(){this.myState.yamlConfig=this.yamlConfig,this.getVizDetails()},subfolder(){this.myState.subfolder=this.subfolder,this.getVizDetails()}},methods:{buildMovieSource(){var t;this.movieSource=`${(t=this.fileApi)==null?void 0:t.baseURL}/${this.myState.subfolder}/${this.myState.yamlConfig}`,this.playerOptions.sources.push({type:"video/mp4",src:this.movieSource})},getFileSystem(t){const e=this.$store.state.svnProjects.filter(s=>s.slug===t);if(e.length===0)throw console.log("no such project"),Error;return e[0]},async buildRouteFromUrl(){const t=this.$route.params;if(!t.project||!t.pathMatch){console.log("I CANT EVEN: NO PROJECT/PARHMATCH");return}this.fileApi=this.getFileSystem(t.project);const e=1+t.pathMatch.lastIndexOf("/"),s=t.pathMatch.substring(0,e),i=t.pathMatch.substring(e);this.myState.subfolder=s,this.myState.yamlConfig=i,this.buildMovieSource()},async generateBreadcrumbs(){const t=this.getFileSystem(this.$route.params.project);if(!t)return[];const e=[{label:t.name,url:"/"+t.slug}],s=this.myState.subfolder.split("/");let i="/";for(const o of s)!o||(i+=o+"/",e.push({label:o,url:"/"+t.slug+i}));return l.commit("setBreadCrumbs",e),e},async getVizDetails(){this.title=this.myState.yamlConfig.replace(/_/g," "),this.title=this.title.substring(0,this.title.lastIndexOf(".")),this.title&&this.$emit("title",this.title)}}});var h=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"video-plugin-container",class:{thumbnail:t.thumbnail}},[t.thumbnail?t._e():s("h3",[t._v(t._s(t.title))]),s("div",{staticClass:"vid-container"},[s("video",{attrs:{controls:t.controls,loop:t.loop,allowfullscreen:t.allowfullscreen,autoplay:t.autoplay},domProps:{muted:t.muted}},[t._l(t.sources,function(i,o){return s("source",{key:o,attrs:{src:i,type:o}})}),t._l(t.sources,function(i,o){return s("p",{key:o},[t._v("Video tag not supported. Download the video\xA0"),s("a",{attrs:{href:i,target:"_blank"}},[t._v("here")])])})],2)])])},c=[];const r={};var m=n(u,h,c,!1,f,"236ee6d2",null,null);function f(t){for(let e in r)this[e]=r[e]}var p=function(){return m.exports}();export{p as default};
//# sourceMappingURL=VideoPlayer.2c83f106.js.map
