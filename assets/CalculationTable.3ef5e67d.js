import{d as a,g as s,n as o}from"./index.1d7144b8.js";import{b as r}from"./index.d10190c4.js";import{H as n}from"./HTTPFileSystem.33aea9ff.js";import{T as c}from"./TopSheet.f44901df.js";const f="url('assets/thumbnail.jpg') no-repeat;",u=a({name:"CalculationTable",components:{TopSheet:c},props:{root:{type:String,required:!0},subfolder:{type:String,required:!0},yamlConfig:String,config:Object,thumbnail:Boolean},data:()=>({globalState:s.state,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},files:[],isLoaded:!1,vizDetails:{title:"",description:"",thumbnail:""}}),computed:{fileApi(){return new n(this.fileSystem,s)},fileSystem(){const t=this.$store.state.svnProjects.filter(e=>e.slug===this.root);if(t.length===0)throw console.log("no such project"),Error;return t[0]},urlThumbnail(){return f}},methods:{async getVizDetails(){if(!this.fileApi)return;console.log(this.yamlConfig);try{const e=await this.fileApi.getFileText(this.subfolder+"/"+this.yamlConfig);this.vizDetails=r.parse(e)}catch{console.error("failed")}const t=this.vizDetails.title?this.vizDetails.title:"Table";this.$emit("title",t)}},async mounted(){await this.getVizDetails(),this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.subfolder);const{files:t}=await this.fileApi.getDirectory(this.subfolder);this.files=t,this.isLoaded=!0,this.thumbnail}});var h="/assets/table.439da6cc.png",m=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"my-component",class:{"hide-thumbnail":!t.thumbnail},attrs:{oncontextmenu:"return false"}},[t.thumbnail?i("img",{staticClass:"thumb",attrs:{src:h,width:128}}):t._e(),!t.thumbnail&&t.isLoaded?i("div",{staticClass:"topsheet"},[i("p",{staticClass:"header"},[t._v(t._s(t.subfolder))]),i("h2",[t._v(t._s(t.vizDetails.title))]),i("p",[t._v(t._s(t.vizDetails.description))]),i("hr"),i("TopSheet",{tag:"component",staticClass:"dash-card",attrs:{fileSystemConfig:t.fileSystem,subfolder:t.subfolder,config:t.vizDetails,yaml:t.yamlConfig,files:t.files,cardTitle:t.vizDetails.title,cardId:"table1",allConfigFiles:t.allConfigFiles}})],1):t._e()])},d=[];const l={};var p=o(u,m,d,!1,_,"7b398d58",null,null);function _(t){for(let e in l)this[e]=l[e]}var y=function(){return p.exports}();export{y as default};
//# sourceMappingURL=CalculationTable.3ef5e67d.js.map
