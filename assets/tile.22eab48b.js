import{d as l,g as r,S as o,n as c}from"./index.1d7144b8.js";import{r as d}from"./index.a906c0e7.js";import{P as m}from"./papaparse.min.61fc48be.js";import{H as u}from"./HTTPFileSystem.33aea9ff.js";import{a as f}from"./util.5fe75924.js";var g=l({name:"OverviewPanel",components:{},props:{fileSystemConfig:{type:Object,required:!0},subfolder:{type:String,required:!0},files:{type:Array,required:!0},config:{type:Object,required:!0},cardTitle:{type:String,required:!1},cardId:String,datamanager:{type:Object,required:!0}},data:()=>({globalState:r.state,id:"tiles-"+Math.floor(1e12*Math.random()),dataSet:{},YAMLrequirementsOverview:{dataset:""},colors:["#F08080","#FFB6C1","#FFDAB9","#FFECB3","#B0E0E6","#98FB98","#FFD700","#FFA07A","#E0FFFF","#FFDAB9","#FFC0CB","#FFA500","#FF8C00","#FF7F50","#FFE4B5","#ADD8E6","#90EE90","#FFD700","#FFC0CB","#FFA500"],colorsD3:["#1F77B4","#FF7F0E","#2CA02C","#D62728","#9467BD","#8C564B","#E377C2","#7F7F7F","#BCBD22","#17BECF"],localTileIcons:["departure_board","directions_car","emoji_transportation","local_taxi","subway","directions_bike","directions_subway","ev_station","local_gas_station","motorcycle","train","directions_boat","electric_car","group","local_parking","person","transportation","directions_bus","electric_rickshaw","groups","local_shipping","route","two_wheeler"],testImage:"",base64Images:[],imagesAreLoaded:!1,tileNameIndex:0,tileValueIndex:1,tileImageIndex:2}),computed:{fileApi(){return new u(this.fileSystemConfig,r)}},async mounted(){this.dataSet=await this.loadFile(),this.validateDataSet(),await this.loadImages(),this.$emit("isLoaded")},methods:{forceRerender(){this.imagesAreLoaded=!1,this.$nextTick(()=>{this.imagesAreLoaded=!0})},async loadImages(){this.imagesAreLoaded=!1;for(let e=0;e<this.dataSet.data.length;e++){const i=this.dataSet.data[e];if(this.checkIfItIsACustomIcon(i[this.tileImageIndex]))try{const t=await this.fileApi.getFileBlob(this.subfolder+"/"+this.config.dataset+"/../"+i[this.tileImageIndex].trim()),s=await d.arraybuffer(t),a=f(s);a&&(this.base64Images[e]=`center / cover no-repeat url(data:image/png;base64,${a})`)}catch(t){t instanceof Response&&this.$store.commit("setStatus",{type:o.WARNING,msg:t.statusText,desc:`The file ${i[this.tileImageIndex]} was not found in this path ${this.subfolder+"/"+this.config.dataset+"/../"+i[this.tileImageIndex]}.`})}this.forceRerender()}this.imagesAreLoaded=!0},async loadFile(){const e=await this.fileApi.getFileText(this.subfolder+"/"+this.config.dataset);return m.parse(e,{comments:"#",delimitersToGuess:[";","	",","," "],dynamicTyping:!0,header:!1,skipEmptyLines:!0})},validateYAML(){for(const e in this.YAMLrequirementsOverview)e in this.config||this.$store.commit("setStatus",{type:o.ERROR,msg:`YAML file missing required key: ${e}`,desc:"Check this.YAMLrequirementsXY for required keys"})},validateDataSet(){},checkIfIconIsInAssetsFolder(e){return this.localTileIcons.includes(e.trim())},checkIfItIsACustomIcon(e){if(e!=null)return!!(e.includes(".png")||e.includes(".jpg")||e.includes(".svg")||e.includes(".jpeg"))}}}),I=function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",{staticClass:"content"},[e.imagesAreLoaded?t("div",{staticClass:"tiles-container"},e._l(this.dataSet.data,function(s,a){return t("div",{staticClass:"tile",style:{"background-color":e.colors[a%e.colors.length]}},[t("p",{staticClass:"tile-title"},[e._v(e._s(s[e.tileNameIndex]))]),t("p",{staticClass:"tile-value"},[e._v(e._s(s[e.tileValueIndex]))]),s[e.tileImageIndex]!=null&&e.checkIfItIsACustomIcon(s[e.tileImageIndex])?t("div",{staticClass:"tile-image",style:{background:e.base64Images[a],"background-size":"contain"}}):s[e.tileImageIndex]!=null&&e.checkIfIconIsInAssetsFolder(s[e.tileImageIndex])?t("img",{staticClass:"tile-image",style:{background:""},attrs:{src:"/src/assets/tile-icons/"+s[e.tileImageIndex].trim()+".svg"}}):s[e.tileImageIndex]!=null?t("font-awesome-icon",{staticClass:"tile-image",style:{background:"",color:"black"},attrs:{icon:s[e.tileImageIndex].trim(),size:"2xl"}}):e._e()],1)}),0):e._e()])},h=[];const n={};var p=c(g,I,h,!1,F,"f5334ca2",null,null);function F(e){for(let i in n)this[i]=n[i]}var C=function(){return p.exports}();export{C as default};
//# sourceMappingURL=tile.22eab48b.js.map
