import{d as X,n as G,p as _t,g as w,V as pt,S as Cs,f as is,c as qe,s as rs}from"./index.1d7144b8.js";import{H as Xe,m as J}from"./HTTPFileSystem.33aea9ff.js";import{m as Ke}from"./index.29851aa5.js";import{b as Ye}from"./index.d10190c4.js";import{D as ws}from"./DashBoard.c40bb82f.js";import{T as Ts}from"./TopSheet.f44901df.js";import{D as Es}from"./DashboardDataManager.6cb84912.js";import"./util.5fe75924.js";import"./RoadNetworkLoader.worker.655695af.js";import"./index.5877f313.js";/*! @license DOMPurify 2.4.7 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.4.7/LICENSE */function ce(e){return ce=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},ce(e)}function vt(e,s){return vt=Object.setPrototypeOf||function(a,i){return a.__proto__=i,a},vt(e,s)}function As(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Be(e,s,t){return As()?Be=Reflect.construct:Be=function(i,n,d){var u=[null];u.push.apply(u,n);var g=Function.bind.apply(i,u),k=new g;return d&&vt(k,d.prototype),k},Be.apply(null,arguments)}function Y(e){return Ds(e)||Ls(e)||ks(e)||xs()}function Ds(e){if(Array.isArray(e))return gt(e)}function Ls(e){if(typeof Symbol!="undefined"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function ks(e,s){if(!!e){if(typeof e=="string")return gt(e,s);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return gt(e,s)}}function gt(e,s){(s==null||s>e.length)&&(s=e.length);for(var t=0,a=new Array(s);t<s;t++)a[t]=e[t];return a}function xs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Rs=Object.hasOwnProperty,Pt=Object.setPrototypeOf,Os=Object.isFrozen,Fs=Object.getPrototypeOf,$s=Object.getOwnPropertyDescriptor,I=Object.freeze,Z=Object.seal,zs=Object.create,ns=typeof Reflect!="undefined"&&Reflect,Ze=ns.apply,yt=ns.construct;Ze||(Ze=function(s,t,a){return s.apply(t,a)});I||(I=function(s){return s});Z||(Z=function(s){return s});yt||(yt=function(s,t){return Be(s,Y(t))});var Ps=B(Array.prototype.forEach),Nt=B(Array.prototype.pop),Re=B(Array.prototype.push),Ge=B(String.prototype.toLowerCase),lt=B(String.prototype.toString),Ns=B(String.prototype.match),q=B(String.prototype.replace),Ms=B(String.prototype.indexOf),Is=B(String.prototype.trim),M=B(RegExp.prototype.test),ct=Hs(TypeError);function B(e){return function(s){for(var t=arguments.length,a=new Array(t>1?t-1:0),i=1;i<t;i++)a[i-1]=arguments[i];return Ze(e,s,a)}}function Hs(e){return function(){for(var s=arguments.length,t=new Array(s),a=0;a<s;a++)t[a]=arguments[a];return yt(e,t)}}function p(e,s,t){var a;t=(a=t)!==null&&a!==void 0?a:Ge,Pt&&Pt(e,null);for(var i=s.length;i--;){var n=s[i];if(typeof n=="string"){var d=t(n);d!==n&&(Os(s)||(s[i]=d),n=d)}e[n]=!0}return e}function ve(e){var s=zs(null),t;for(t in e)Ze(Rs,e,[t])===!0&&(s[t]=e[t]);return s}function je(e,s){for(;e!==null;){var t=$s(e,s);if(t){if(t.get)return B(t.get);if(typeof t.value=="function")return B(t.value)}e=Fs(e)}function a(i){return console.warn("fallback value for",i),null}return a}var Mt=I(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),dt=I(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),ut=I(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),js=I(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mt=I(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Ws=I(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),It=I(["#text"]),Ht=I(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),ht=I(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jt=I(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),We=I(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Us=Z(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Bs=Z(/<%[\w\W]*|[\w\W]*%>/gm),Gs=Z(/\${[\w\W]*}/gm),Vs=Z(/^data-[\-\w.\u00B7-\uFFFF]/),qs=Z(/^aria-[\-\w]+$/),Ys=Z(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Zs=Z(/^(?:\w+script|data):/i),Xs=Z(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ks=Z(/^html$/i),Js=function(){return typeof window=="undefined"?null:window},Qs=function(s,t){if(ce(s)!=="object"||typeof s.createPolicy!="function")return null;var a=null,i="data-tt-policy-suffix";t.currentScript&&t.currentScript.hasAttribute(i)&&(a=t.currentScript.getAttribute(i));var n="dompurify"+(a?"#"+a:"");try{return s.createPolicy(n,{createHTML:function(u){return u},createScriptURL:function(u){return u}})}catch{return console.warn("TrustedTypes policy "+n+" could not be created."),null}};function os(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Js(),s=function(r){return os(r)};if(s.version="2.4.7",s.removed=[],!e||!e.document||e.document.nodeType!==9)return s.isSupported=!1,s;var t=e.document,a=e.document,i=e.DocumentFragment,n=e.HTMLTemplateElement,d=e.Node,u=e.Element,g=e.NodeFilter,k=e.NamedNodeMap,x=k===void 0?e.NamedNodeMap||e.MozNamedAttrMap:k,j=e.HTMLFormElement,U=e.DOMParser,Q=e.trustedTypes,N=u.prototype,Fe=je(N,"cloneNode"),Je=je(N,"nextSibling"),Qe=je(N,"childNodes"),Ae=je(N,"parentNode");if(typeof n=="function"){var R=a.createElement("template");R.content&&R.content.ownerDocument&&(a=R.content.ownerDocument)}var z=Qs(Q,t),K=z?z.createHTML(""):"",de=a,_=de.implementation,l=de.createNodeIterator,ye=de.createDocumentFragment,T=de.getElementsByTagName,O=t.importNode,f={};try{f=ve(a).documentMode?a.documentMode:{}}catch{}var h={};s.isSupported=typeof Ae=="function"&&_&&_.createHTMLDocument!==void 0&&f!==9;var b=Us,S=Bs,v=Gs,F=Vs,W=qs,ie=Zs,V=Xs,ue=Ys,E=null,$e=p({},[].concat(Y(Mt),Y(dt),Y(ut),Y(mt),Y(It))),A=null,re=p({},[].concat(Y(Ht),Y(ht),Y(jt),Y(We))),C=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),me=null,ne=null,ze=!0,De=!0,_e=!1,be=!0,oe=!1,ee=!1,he=!1,Le=!1,le=!1,fe=!1,Pe=!1,bt=!0,St=!1,hs="user-content-",et=!0,ke=!1,Se={},Ce=null,Ct=p({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),wt=null,Tt=p({},["audio","video","img","source","image","track"]),tt=null,Et=p({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ne="http://www.w3.org/1998/Math/MathML",Me="http://www.w3.org/2000/svg",te="http://www.w3.org/1999/xhtml",we=te,st=!1,at=null,fs=p({},[Ne,Me,te],lt),pe,ps=["application/xhtml+xml","text/html"],vs="text/html",D,Te=null,gs=a.createElement("form"),At=function(r){return r instanceof RegExp||r instanceof Function},it=function(r){Te&&Te===r||((!r||ce(r)!=="object")&&(r={}),r=ve(r),pe=ps.indexOf(r.PARSER_MEDIA_TYPE)===-1?pe=vs:pe=r.PARSER_MEDIA_TYPE,D=pe==="application/xhtml+xml"?lt:Ge,E="ALLOWED_TAGS"in r?p({},r.ALLOWED_TAGS,D):$e,A="ALLOWED_ATTR"in r?p({},r.ALLOWED_ATTR,D):re,at="ALLOWED_NAMESPACES"in r?p({},r.ALLOWED_NAMESPACES,lt):fs,tt="ADD_URI_SAFE_ATTR"in r?p(ve(Et),r.ADD_URI_SAFE_ATTR,D):Et,wt="ADD_DATA_URI_TAGS"in r?p(ve(Tt),r.ADD_DATA_URI_TAGS,D):Tt,Ce="FORBID_CONTENTS"in r?p({},r.FORBID_CONTENTS,D):Ct,me="FORBID_TAGS"in r?p({},r.FORBID_TAGS,D):{},ne="FORBID_ATTR"in r?p({},r.FORBID_ATTR,D):{},Se="USE_PROFILES"in r?r.USE_PROFILES:!1,ze=r.ALLOW_ARIA_ATTR!==!1,De=r.ALLOW_DATA_ATTR!==!1,_e=r.ALLOW_UNKNOWN_PROTOCOLS||!1,be=r.ALLOW_SELF_CLOSE_IN_ATTR!==!1,oe=r.SAFE_FOR_TEMPLATES||!1,ee=r.WHOLE_DOCUMENT||!1,le=r.RETURN_DOM||!1,fe=r.RETURN_DOM_FRAGMENT||!1,Pe=r.RETURN_TRUSTED_TYPE||!1,Le=r.FORCE_BODY||!1,bt=r.SANITIZE_DOM!==!1,St=r.SANITIZE_NAMED_PROPS||!1,et=r.KEEP_CONTENT!==!1,ke=r.IN_PLACE||!1,ue=r.ALLOWED_URI_REGEXP||ue,we=r.NAMESPACE||te,C=r.CUSTOM_ELEMENT_HANDLING||{},r.CUSTOM_ELEMENT_HANDLING&&At(r.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=r.CUSTOM_ELEMENT_HANDLING.tagNameCheck),r.CUSTOM_ELEMENT_HANDLING&&At(r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=r.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),r.CUSTOM_ELEMENT_HANDLING&&typeof r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=r.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),oe&&(De=!1),fe&&(le=!0),Se&&(E=p({},Y(It)),A=[],Se.html===!0&&(p(E,Mt),p(A,Ht)),Se.svg===!0&&(p(E,dt),p(A,ht),p(A,We)),Se.svgFilters===!0&&(p(E,ut),p(A,ht),p(A,We)),Se.mathMl===!0&&(p(E,mt),p(A,jt),p(A,We))),r.ADD_TAGS&&(E===$e&&(E=ve(E)),p(E,r.ADD_TAGS,D)),r.ADD_ATTR&&(A===re&&(A=ve(A)),p(A,r.ADD_ATTR,D)),r.ADD_URI_SAFE_ATTR&&p(tt,r.ADD_URI_SAFE_ATTR,D),r.FORBID_CONTENTS&&(Ce===Ct&&(Ce=ve(Ce)),p(Ce,r.FORBID_CONTENTS,D)),et&&(E["#text"]=!0),ee&&p(E,["html","head","body"]),E.table&&(p(E,["tbody"]),delete me.tbody),I&&I(r),Te=r)},Dt=p({},["mi","mo","mn","ms","mtext"]),Lt=p({},["foreignobject","desc","title","annotation-xml"]),ys=p({},["title","style","font","a","script"]),Ie=p({},dt);p(Ie,ut),p(Ie,js);var rt=p({},mt);p(rt,Ws);var _s=function(r){var o=Ae(r);(!o||!o.tagName)&&(o={namespaceURI:we,tagName:"template"});var c=Ge(r.tagName),y=Ge(o.tagName);return at[r.namespaceURI]?r.namespaceURI===Me?o.namespaceURI===te?c==="svg":o.namespaceURI===Ne?c==="svg"&&(y==="annotation-xml"||Dt[y]):Boolean(Ie[c]):r.namespaceURI===Ne?o.namespaceURI===te?c==="math":o.namespaceURI===Me?c==="math"&&Lt[y]:Boolean(rt[c]):r.namespaceURI===te?o.namespaceURI===Me&&!Lt[y]||o.namespaceURI===Ne&&!Dt[y]?!1:!rt[c]&&(ys[c]||!Ie[c]):!!(pe==="application/xhtml+xml"&&at[r.namespaceURI]):!1},se=function(r){Re(s.removed,{element:r});try{r.parentNode.removeChild(r)}catch{try{r.outerHTML=K}catch{r.remove()}}},nt=function(r,o){try{Re(s.removed,{attribute:o.getAttributeNode(r),from:o})}catch{Re(s.removed,{attribute:null,from:o})}if(o.removeAttribute(r),r==="is"&&!A[r])if(le||fe)try{se(o)}catch{}else try{o.setAttribute(r,"")}catch{}},kt=function(r){var o,c;if(Le)r="<remove></remove>"+r;else{var y=Ns(r,/^[\r\n\t ]+/);c=y&&y[0]}pe==="application/xhtml+xml"&&we===te&&(r='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+r+"</body></html>");var H=z?z.createHTML(r):r;if(we===te)try{o=new U().parseFromString(H,pe)}catch{}if(!o||!o.documentElement){o=_.createDocument(we,"template",null);try{o.documentElement.innerHTML=st?K:H}catch{}}var P=o.body||o.documentElement;return r&&c&&P.insertBefore(a.createTextNode(c),P.childNodes[0]||null),we===te?T.call(o,ee?"html":"body")[0]:ee?o.documentElement:P},xt=function(r){return l.call(r.ownerDocument||r,r,g.SHOW_ELEMENT|g.SHOW_COMMENT|g.SHOW_TEXT,null,!1)},bs=function(r){return r instanceof j&&(typeof r.nodeName!="string"||typeof r.textContent!="string"||typeof r.removeChild!="function"||!(r.attributes instanceof x)||typeof r.removeAttribute!="function"||typeof r.setAttribute!="function"||typeof r.namespaceURI!="string"||typeof r.insertBefore!="function"||typeof r.hasChildNodes!="function")},xe=function(r){return ce(d)==="object"?r instanceof d:r&&ce(r)==="object"&&typeof r.nodeType=="number"&&typeof r.nodeName=="string"},ae=function(r,o,c){!h[r]||Ps(h[r],function(y){y.call(s,o,c,Te)})},Rt=function(r){var o;if(ae("beforeSanitizeElements",r,null),bs(r)||M(/[\u0080-\uFFFF]/,r.nodeName))return se(r),!0;var c=D(r.nodeName);if(ae("uponSanitizeElement",r,{tagName:c,allowedTags:E}),r.hasChildNodes()&&!xe(r.firstElementChild)&&(!xe(r.content)||!xe(r.content.firstElementChild))&&M(/<[/\w]/g,r.innerHTML)&&M(/<[/\w]/g,r.textContent)||c==="select"&&M(/<template/i,r.innerHTML))return se(r),!0;if(!E[c]||me[c]){if(!me[c]&&Ft(c)&&(C.tagNameCheck instanceof RegExp&&M(C.tagNameCheck,c)||C.tagNameCheck instanceof Function&&C.tagNameCheck(c)))return!1;if(et&&!Ce[c]){var y=Ae(r)||r.parentNode,H=Qe(r)||r.childNodes;if(H&&y)for(var P=H.length,$=P-1;$>=0;--$)y.insertBefore(Fe(H[$],!0),Je(r))}return se(r),!0}return r instanceof u&&!_s(r)||(c==="noscript"||c==="noembed"||c==="noframes")&&M(/<\/no(script|embed|frames)/i,r.innerHTML)?(se(r),!0):(oe&&r.nodeType===3&&(o=r.textContent,o=q(o,b," "),o=q(o,S," "),o=q(o,v," "),r.textContent!==o&&(Re(s.removed,{element:r.cloneNode()}),r.textContent=o)),ae("afterSanitizeElements",r,null),!1)},Ot=function(r,o,c){if(bt&&(o==="id"||o==="name")&&(c in a||c in gs))return!1;if(!(De&&!ne[o]&&M(F,o))){if(!(ze&&M(W,o))){if(!A[o]||ne[o]){if(!(Ft(r)&&(C.tagNameCheck instanceof RegExp&&M(C.tagNameCheck,r)||C.tagNameCheck instanceof Function&&C.tagNameCheck(r))&&(C.attributeNameCheck instanceof RegExp&&M(C.attributeNameCheck,o)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(o))||o==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&M(C.tagNameCheck,c)||C.tagNameCheck instanceof Function&&C.tagNameCheck(c))))return!1}else if(!tt[o]){if(!M(ue,q(c,V,""))){if(!((o==="src"||o==="xlink:href"||o==="href")&&r!=="script"&&Ms(c,"data:")===0&&wt[r])){if(!(_e&&!M(ie,q(c,V,"")))){if(c)return!1}}}}}}return!0},Ft=function(r){return r.indexOf("-")>0},$t=function(r){var o,c,y,H;ae("beforeSanitizeAttributes",r,null);var P=r.attributes;if(!!P){var $={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:A};for(H=P.length;H--;){o=P[H];var He=o,L=He.name,ot=He.namespaceURI;if(c=L==="value"?o.value:Is(o.value),y=D(L),$.attrName=y,$.attrValue=c,$.keepAttr=!0,$.forceKeepAttr=void 0,ae("uponSanitizeAttribute",r,$),c=$.attrValue,!$.forceKeepAttr&&(nt(L,r),!!$.keepAttr)){if(!be&&M(/\/>/i,c)){nt(L,r);continue}oe&&(c=q(c,b," "),c=q(c,S," "),c=q(c,v," "));var zt=D(r.nodeName);if(!!Ot(zt,y,c)){if(St&&(y==="id"||y==="name")&&(nt(L,r),c=hs+c),z&&ce(Q)==="object"&&typeof Q.getAttributeType=="function"&&!ot)switch(Q.getAttributeType(zt,y)){case"TrustedHTML":{c=z.createHTML(c);break}case"TrustedScriptURL":{c=z.createScriptURL(c);break}}try{ot?r.setAttributeNS(ot,L,c):r.setAttribute(L,c),Nt(s.removed)}catch{}}}}ae("afterSanitizeAttributes",r,null)}},Ss=function m(r){var o,c=xt(r);for(ae("beforeSanitizeShadowDOM",r,null);o=c.nextNode();)ae("uponSanitizeShadowNode",o,null),!Rt(o)&&(o.content instanceof i&&m(o.content),$t(o));ae("afterSanitizeShadowDOM",r,null)};return s.sanitize=function(m){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o,c,y,H,P;if(st=!m,st&&(m="<!-->"),typeof m!="string"&&!xe(m))if(typeof m.toString=="function"){if(m=m.toString(),typeof m!="string")throw ct("dirty is not a string, aborting")}else throw ct("toString is not a function");if(!s.isSupported){if(ce(e.toStaticHTML)==="object"||typeof e.toStaticHTML=="function"){if(typeof m=="string")return e.toStaticHTML(m);if(xe(m))return e.toStaticHTML(m.outerHTML)}return m}if(he||it(r),s.removed=[],typeof m=="string"&&(ke=!1),ke){if(m.nodeName){var $=D(m.nodeName);if(!E[$]||me[$])throw ct("root node is forbidden and cannot be sanitized in-place")}}else if(m instanceof d)o=kt("<!---->"),c=o.ownerDocument.importNode(m,!0),c.nodeType===1&&c.nodeName==="BODY"||c.nodeName==="HTML"?o=c:o.appendChild(c);else{if(!le&&!oe&&!ee&&m.indexOf("<")===-1)return z&&Pe?z.createHTML(m):m;if(o=kt(m),!o)return le?null:Pe?K:""}o&&Le&&se(o.firstChild);for(var He=xt(ke?m:o);y=He.nextNode();)y.nodeType===3&&y===H||Rt(y)||(y.content instanceof i&&Ss(y.content),$t(y),H=y);if(H=null,ke)return m;if(le){if(fe)for(P=ye.call(o.ownerDocument);o.firstChild;)P.appendChild(o.firstChild);else P=o;return(A.shadowroot||A.shadowrootmod)&&(P=O.call(t,P,!0)),P}var L=ee?o.outerHTML:o.innerHTML;return ee&&E["!doctype"]&&o.ownerDocument&&o.ownerDocument.doctype&&o.ownerDocument.doctype.name&&M(Ks,o.ownerDocument.doctype.name)&&(L="<!DOCTYPE "+o.ownerDocument.doctype.name+`>
`+L),oe&&(L=q(L,b," "),L=q(L,S," "),L=q(L,v," ")),z&&Pe?z.createHTML(L):L},s.setConfig=function(m){it(m),he=!0},s.clearConfig=function(){Te=null,he=!1},s.isValidAttribute=function(m,r,o){Te||it({});var c=D(m),y=D(r);return Ot(c,y,o)},s.addHook=function(m,r){typeof r=="function"&&(h[m]=h[m]||[],Re(h[m],r))},s.removeHook=function(m){if(h[m])return Nt(h[m])},s.removeHooks=function(m){h[m]&&(h[m]=[])},s.removeAllHooks=function(){h={}},s}var ea=os();/*! medium-zoom 1.0.8 | MIT License | https://github.com/francoischalifour/medium-zoom */var ge=Object.assign||function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},Ue=function(s){return s.tagName==="IMG"},ta=function(s){return NodeList.prototype.isPrototypeOf(s)},Ve=function(s){return s&&s.nodeType===1},Wt=function(s){var t=s.currentSrc||s.src;return t.substr(-4).toLowerCase()===".svg"},Ut=function(s){try{return Array.isArray(s)?s.filter(Ue):ta(s)?[].slice.call(s).filter(Ue):Ve(s)?[s].filter(Ue):typeof s=="string"?[].slice.call(document.querySelectorAll(s)).filter(Ue):[]}catch{throw new TypeError(`The provided selector is invalid.
Expects a CSS selector, a Node element, a NodeList or an array.
See: https://github.com/francoischalifour/medium-zoom`)}},sa=function(s){var t=document.createElement("div");return t.classList.add("medium-zoom-overlay"),t.style.background=s,t},aa=function(s){var t=s.getBoundingClientRect(),a=t.top,i=t.left,n=t.width,d=t.height,u=s.cloneNode(),g=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,k=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft||0;return u.removeAttribute("id"),u.style.position="absolute",u.style.top=a+g+"px",u.style.left=i+k+"px",u.style.width=n+"px",u.style.height=d+"px",u.style.transform="",u},Ee=function(s,t){var a=ge({bubbles:!1,cancelable:!1,detail:void 0},t);if(typeof window.CustomEvent=="function")return new CustomEvent(s,a);var i=document.createEvent("CustomEvent");return i.initCustomEvent(s,a.bubbles,a.cancelable,a.detail),i},ia=function e(s){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=window.Promise||function(f){function h(){}f(h,h)},i=function(f){var h=f.target;if(h===ye){N();return}R.indexOf(h)!==-1&&Fe({target:h})},n=function(){if(!(K||!l.original)){var f=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;Math.abs(de-f)>_.scrollOffset&&setTimeout(N,150)}},d=function(f){var h=f.key||f.keyCode;(h==="Escape"||h==="Esc"||h===27)&&N()},u=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f;if(f.background&&(ye.style.background=f.background),f.container&&f.container instanceof Object&&(h.container=ge({},_.container,f.container)),f.template){var b=Ve(f.template)?f.template:document.querySelector(f.template);h.template=b}return _=ge({},_,h),R.forEach(function(S){S.dispatchEvent(Ee("medium-zoom:update",{detail:{zoom:T}}))}),T},g=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e(ge({},_,f))},k=function(){for(var f=arguments.length,h=Array(f),b=0;b<f;b++)h[b]=arguments[b];var S=h.reduce(function(v,F){return[].concat(v,Ut(F))},[]);return S.filter(function(v){return R.indexOf(v)===-1}).forEach(function(v){R.push(v),v.classList.add("medium-zoom-image")}),z.forEach(function(v){var F=v.type,W=v.listener,ie=v.options;S.forEach(function(V){V.addEventListener(F,W,ie)})}),T},x=function(){for(var f=arguments.length,h=Array(f),b=0;b<f;b++)h[b]=arguments[b];l.zoomed&&N();var S=h.length>0?h.reduce(function(v,F){return[].concat(v,Ut(F))},[]):R;return S.forEach(function(v){v.classList.remove("medium-zoom-image"),v.dispatchEvent(Ee("medium-zoom:detach",{detail:{zoom:T}}))}),R=R.filter(function(v){return S.indexOf(v)===-1}),T},j=function(f,h){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return R.forEach(function(S){S.addEventListener("medium-zoom:"+f,h,b)}),z.push({type:"medium-zoom:"+f,listener:h,options:b}),T},U=function(f,h){var b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return R.forEach(function(S){S.removeEventListener("medium-zoom:"+f,h,b)}),z=z.filter(function(S){return!(S.type==="medium-zoom:"+f&&S.listener.toString()===h.toString())}),T},Q=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f.target,b=function(){var v={width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,left:0,top:0,right:0,bottom:0},F=void 0,W=void 0;if(_.container)if(_.container instanceof Object)v=ge({},v,_.container),F=v.width-v.left-v.right-_.margin*2,W=v.height-v.top-v.bottom-_.margin*2;else{var ie=Ve(_.container)?_.container:document.querySelector(_.container),V=ie.getBoundingClientRect(),ue=V.width,E=V.height,$e=V.left,A=V.top;v=ge({},v,{width:ue,height:E,left:$e,top:A})}F=F||v.width-_.margin*2,W=W||v.height-_.margin*2;var re=l.zoomedHd||l.original,C=Wt(re)?F:re.naturalWidth||F,me=Wt(re)?W:re.naturalHeight||W,ne=re.getBoundingClientRect(),ze=ne.top,De=ne.left,_e=ne.width,be=ne.height,oe=Math.min(Math.max(_e,C),F)/_e,ee=Math.min(Math.max(be,me),W)/be,he=Math.min(oe,ee),Le=(-De+(F-_e)/2+_.margin+v.left)/he,le=(-ze+(W-be)/2+_.margin+v.top)/he,fe="scale("+he+") translate3d("+Le+"px, "+le+"px, 0)";l.zoomed.style.transform=fe,l.zoomedHd&&(l.zoomedHd.style.transform=fe)};return new a(function(S){if(h&&R.indexOf(h)===-1){S(T);return}var v=function ue(){K=!1,l.zoomed.removeEventListener("transitionend",ue),l.original.dispatchEvent(Ee("medium-zoom:opened",{detail:{zoom:T}})),S(T)};if(l.zoomed){S(T);return}if(h)l.original=h;else if(R.length>0){var F=R;l.original=F[0]}else{S(T);return}if(l.original.dispatchEvent(Ee("medium-zoom:open",{detail:{zoom:T}})),de=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,K=!0,l.zoomed=aa(l.original),document.body.appendChild(ye),_.template){var W=Ve(_.template)?_.template:document.querySelector(_.template);l.template=document.createElement("div"),l.template.appendChild(W.content.cloneNode(!0)),document.body.appendChild(l.template)}if(l.original.parentElement&&l.original.parentElement.tagName==="PICTURE"&&l.original.currentSrc&&(l.zoomed.src=l.original.currentSrc),document.body.appendChild(l.zoomed),window.requestAnimationFrame(function(){document.body.classList.add("medium-zoom--opened")}),l.original.classList.add("medium-zoom-image--hidden"),l.zoomed.classList.add("medium-zoom-image--opened"),l.zoomed.addEventListener("click",N),l.zoomed.addEventListener("transitionend",v),l.original.getAttribute("data-zoom-src")){l.zoomedHd=l.zoomed.cloneNode(),l.zoomedHd.removeAttribute("srcset"),l.zoomedHd.removeAttribute("sizes"),l.zoomedHd.removeAttribute("loading"),l.zoomedHd.src=l.zoomed.getAttribute("data-zoom-src"),l.zoomedHd.onerror=function(){clearInterval(ie),console.warn("Unable to reach the zoom image target "+l.zoomedHd.src),l.zoomedHd=null,b()};var ie=setInterval(function(){l.zoomedHd.complete&&(clearInterval(ie),l.zoomedHd.classList.add("medium-zoom-image--opened"),l.zoomedHd.addEventListener("click",N),document.body.appendChild(l.zoomedHd),b())},10)}else if(l.original.hasAttribute("srcset")){l.zoomedHd=l.zoomed.cloneNode(),l.zoomedHd.removeAttribute("sizes"),l.zoomedHd.removeAttribute("loading");var V=l.zoomedHd.addEventListener("load",function(){l.zoomedHd.removeEventListener("load",V),l.zoomedHd.classList.add("medium-zoom-image--opened"),l.zoomedHd.addEventListener("click",N),document.body.appendChild(l.zoomedHd),b()})}else b()})},N=function(){return new a(function(f){if(K||!l.original){f(T);return}var h=function b(){l.original.classList.remove("medium-zoom-image--hidden"),document.body.removeChild(l.zoomed),l.zoomedHd&&document.body.removeChild(l.zoomedHd),document.body.removeChild(ye),l.zoomed.classList.remove("medium-zoom-image--opened"),l.template&&document.body.removeChild(l.template),K=!1,l.zoomed.removeEventListener("transitionend",b),l.original.dispatchEvent(Ee("medium-zoom:closed",{detail:{zoom:T}})),l.original=null,l.zoomed=null,l.zoomedHd=null,l.template=null,f(T)};K=!0,document.body.classList.remove("medium-zoom--opened"),l.zoomed.style.transform="",l.zoomedHd&&(l.zoomedHd.style.transform=""),l.template&&(l.template.style.transition="opacity 150ms",l.template.style.opacity=0),l.original.dispatchEvent(Ee("medium-zoom:close",{detail:{zoom:T}})),l.zoomed.addEventListener("transitionend",h)})},Fe=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f.target;return l.original?N():Q({target:h})},Je=function(){return _},Qe=function(){return R},Ae=function(){return l.original},R=[],z=[],K=!1,de=0,_=t,l={original:null,zoomed:null,zoomedHd:null,template:null};Object.prototype.toString.call(s)==="[object Object]"?_=s:(s||typeof s=="string")&&k(s),_=ge({margin:0,background:"#fff",scrollOffset:40,container:null,template:null},_);var ye=sa(_.background);document.addEventListener("click",i),document.addEventListener("keyup",d),document.addEventListener("scroll",n),window.addEventListener("resize",N);var T={open:Q,close:N,toggle:Fe,update:u,clone:g,attach:k,detach:x,on:j,off:U,getOptions:Je,getImages:Qe,getZoomedImage:Ae};return T};function ra(e,s){s===void 0&&(s={});var t=s.insertAt;if(!(!e||typeof document=="undefined")){var a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",t==="top"&&a.firstChild?a.insertBefore(i,a.firstChild):a.appendChild(i),i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e))}}var na=".medium-zoom-overlay{position:fixed;top:0;right:0;bottom:0;left:0;opacity:0;transition:opacity .3s;will-change:opacity}.medium-zoom--opened .medium-zoom-overlay{cursor:pointer;cursor:zoom-out;opacity:1}.medium-zoom-image{cursor:pointer;cursor:zoom-in;transition:transform .3s cubic-bezier(.2,0,.2,1)!important}.medium-zoom-image--hidden{visibility:hidden}.medium-zoom-image--opened{position:relative;cursor:pointer;cursor:zoom-out;will-change:transform}";ra(na);var ls=ia;const oa={messages:{en:{title:"Key Performance Indicators"}}};var la=X({name:"TopsheetsFinder",i18n:oa,components:{TopSheet:Ts},props:{fileSystemConfig:{type:Object,required:!0},subfolder:{type:String,required:!0},files:{type:Array,required:!0}},computed:{fileApi(){return new Xe(this.fileSystemConfig)}},data:()=>({allConfigFiles:{},topsheets:[]}),watch:{subfolder(){this.filesUpdated()},files(){this.filesUpdated()}},methods:{async findTopsheetsForThisFolder(){return this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.subfolder),Object.values(this.allConfigFiles.topsheets)},async filesUpdated(){this.files.length&&(this.topsheets=await this.findTopsheetsForThisFolder())}}}),ca=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"topsheets-finder curate-content"},e._l(e.topsheets,function(a){return t("top-sheet",{key:a,attrs:{fileSystemConfig:e.fileSystemConfig,subfolder:e.subfolder,files:e.files,yaml:a,allConfigFiles:e.allConfigFiles}})}),1)},da=[];const Bt={};var ua=G(la,ca,da,!1,ma,"13752aaf",null,null);function ma(e){for(let s in Bt)this[s]=Bt[s]}var cs=function(){return ua.exports}();const ha={messages:{en:{Maps:"Maps",Images:"Images",Analysis:"Analysis",Files:"Files",Folders:"Folders",Topsheet:"Topsheet"},de:{Maps:"Karten",Images:"Bilder",Analysis:"Ergebnisse",Files:"Dateien",Folders:"Ordner",Topsheet:"Topsheet"}}},fa={"":"#118860","aggregate-od":"#E98B52","vehicle-anim":"#330033","x-y-t":"#583270","carrier-viewer":"#c97A2C",events:"#4400ff",hexagons:"#900564","area-map":"#c94264",network:"#894654",sankey:"#D8A672",summary:"#2EA95B",transit:"#3B6FE4"};var pa=X({name:"FolderBrowser",i18n:ha,components:Object.assign({TopsheetsFinder:cs},_t),props:{root:{type:String,required:!0},allConfigFiles:{type:Object,required:!0},xsubfolder:String},data:()=>({globalState:w.state,summaryYamlFilename:"viz-summary.yml",mdRenderer:new Ke({html:!0,linkify:!0,typographer:!0}),myState:{errorStatus:"",folders:[],files:[],isLoading:!1,readme:"",svnProject:null,svnRoot:void 0,subfolder:"",vizes:[],summary:!1}}),computed:{vizImages(){const e={};for(let s=0;s<this.myState.vizes.length;s++)this.myState.vizes[s].component==="image-view"&&(e[s]=this.myState.vizes[s]);return e},vizMaps(){const e={};for(let s=0;s<this.myState.vizes.length;s++)this.myState.vizes[s].component!=="image-view"&&(e[s]=this.myState.vizes[s]);return e}},methods:{cleanName(e){return decodeURIComponent(e)},getFileSystem(e){const s=w.state.svnProjects.filter(t=>t.slug===e);if(s.length===0)throw console.log("no such project"),Error;return s[0]},generateBreadcrumbs(){if(!this.myState.svnProject)return[];const e=[{label:"SimWrapper",url:"/"},{label:this.myState.svnProject.name,url:"/"+this.myState.svnProject.slug}],s=this.myState.subfolder.split("/");let t="/";for(const a of s)!a||(t+=a+"/",e.push({label:a,url:"/"+this.myState.svnProject.slug+t}));return w.commit("setBreadCrumbs",e),e},clickedVisualization(e){const s=this.myState.vizes[e];if(s.component==="image-view"||!this.myState.svnProject)return;const t={root:this.myState.svnProject.slug,xsubfolder:this.myState.subfolder,subfolder:this.myState.subfolder,yamlConfig:s.config,thumbnail:!1};this.$emit("navigate",{component:s.component,props:t})},updateTitle(e,s){this.myState.vizes[e].title=s},async showReadme(){this.myState.readme="";const e="readme.md";if(this.myState.files.map(s=>s.toLocaleLowerCase()).indexOf(e)>-1){if(!this.myState.svnRoot)return;const s=await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+e);this.myState.readme=this.mdRenderer.render(s)}},buildShowEverythingView(){for(const e of this.globalState.visualizationTypes.values()){const s=J(this.myState.files,e.filePatterns,{nocase:!0});for(const t of s)this.myState.vizes.push({component:e.kebabName,config:t,title:".."})}},async buildCuratedSummaryView(){if(!this.myState.svnRoot)return;const e=Ye.parse(await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+this.summaryYamlFilename));for(const s of e.plugins){const t=this.globalState.visualizationTypes.get(s);if(!!t)if(e[t.kebabName])for(const a of e[t.kebabName]){const i=await this.findMatchingFiles(a);for(const n of i)this.myState.vizes.push({component:t.kebabName,config:n,title:n})}else{const a=J(this.myState.files,t.filePatterns);for(const i of a)this.myState.vizes.push({component:t.kebabName,config:i,title:".."})}}},async findMatchingFiles(e){if(this.myState.files.indexOf(e)>-1)return[e];const s=J(this.myState.files,e);if(s.length)return s;if(!this.myState.svnRoot)return[];try{const t=e.split("/"),a=this.myState.subfolder+"/"+t[0];console.log(a);const i=await this.myState.svnRoot.getDirectory(a);return J(i.files,t[1]).map(d=>t[0]+"/"+d)}catch{}return[]},async fetchFolderContents(){if(!this.myState.svnRoot)return[];this.myState.isLoading=!0,this.myState.errorStatus="",this.myState.files=[];try{const e=await this.myState.svnRoot.getDirectory(this.myState.subfolder),s=e.dirs.filter(n=>!n.startsWith(".")).sort(),t=e.files.filter(n=>!n.startsWith(".")).sort(),a=Object.assign({},this.allConfigFiles.vizes);for(const n of t)a[n]=n;const i=Object.values(a);this.myState.errorStatus="",this.myState.folders=s,this.myState.files=i}catch(e){const s=e;console.log("BAD PAGE"),console.log({eeee:s}),this.myState.folders=[],this.myState.files=[],this.myState.errorStatus="<h3>",s.status&&(this.myState.errorStatus+=`${s.status} `),s.statusText&&(this.myState.errorStatus+=`${s.statusText}`),this.myState.errorStatus==="<h3>"&&(this.myState.errorStatus+="Error"),this.myState.errorStatus+="</h3>",s.url&&(this.myState.errorStatus+=`<p>${s.url}</p>`),s.message&&(this.myState.errorStatus+=`<p>${s.message}</p>`),this.myState.errorStatus==="<h3>Error</h3>"&&(this.myState.errorStatus=""+s),this.myState.svnProject&&(this.myState.errorStatus+=`<p><i>${this.myState.svnProject.baseURL}${this.myState.subfolder}</i></p>`),this.myState.svnProject&&this.myState.svnProject.needPassword&&s.status===401&&w.commit("requestLogin",this.myState.svnProject.slug)}finally{this.myState.isLoading=!1}},openOutputFolder(e){if(this.myState.isLoading||!this.myState.svnProject)return;const s=e===".."?this.myState.subfolder.substring(0,this.myState.subfolder.lastIndexOf("/")):this.myState.subfolder+"/"+e,t={root:this.myState.svnProject.slug,xsubfolder:s};!s&&!this.myState.subfolder?this.$emit("navigate",{component:"SplashPage",props:{}}):this.$emit("navigate",{component:"TabbedDashboardView",props:t})},getTabColor(e){return{backgroundColor:fa[e]||"#8778BB"}},updateRoute(){const e=this.getFileSystem(this.root);this.myState.svnProject=e,this.myState.subfolder=this.xsubfolder||"",this.myState.readme="",this.myState.svnProject&&(this.myState.svnRoot=new Xe(this.myState.svnProject),this.generateBreadcrumbs(),this.fetchFolderContents())}},watch:{"globalState.colorScheme"(){this.fetchFolderContents()},xsubfolder(){this.updateRoute()},allConfigFiles(){this.updateRoute()},"globalState.authAttempts"(){console.log("AUTH CHANGED - Reload"),this.updateRoute()},async"myState.files"(){this.myState.vizes=[],this.myState.files.length!==0&&(this.showReadme(),this.myState.summary=this.myState.files.indexOf(this.summaryYamlFilename)!==-1,this.myState.summary?await this.buildCuratedSummaryView():this.buildShowEverythingView(),await this.$nextTick(),ls(".medium-zoom",{background:"#444450"}))}},mounted(){this.updateRoute()}}),va=function(){var e,s,t=this,a=t.$createElement,i=t._self._c||a;return i("div",{staticClass:"folder-browser"},[t.myState.errorStatus?i("div",{staticClass:"stripe details"},[i("div",{staticClass:"vessel"},[i("div",{staticClass:"badnews",domProps:{innerHTML:t._s(t.myState.errorStatus)}})])]):i("div",{staticClass:"stripe details"},[i("div",{staticClass:"vessel"},[i("div",{staticClass:"curated-sections"},[i("b",{staticClass:"up-link"},[i("a",{on:{click:function(n){return t.$emit("up")}}},[t._v("^ UP")])]),i("div",{staticClass:"readme-header markdown"},[t.myState.readme?i("div",{staticClass:"curate-content markdown",domProps:{innerHTML:t._s(t.myState.readme)}}):t._e()]),t.myState.folders.length?i("h3",{staticClass:"curate-heading"},[t._v(" "+t._s(t.$t("Folders")))]):t._e(),t.myState.folders.length?i("div",{staticClass:"curate-content"},[i("div",{staticClass:"folder-table"},t._l(t.myState.folders,function(n){return i("div",{key:n.name,staticClass:"folder",class:{fade:t.myState.isLoading},on:{click:function(d){return t.openOutputFolder(n)}}},[i("p",[i("i",{staticClass:"fa fa-folder-open"}),t._v("\xA0"+t._s(t.cleanName(n)))])])}),0)]):t._e(),Object.keys(t.vizMaps).length?i("div",{staticClass:"section-maps"},[i("h3",{staticClass:"curate-heading"},[t._v(t._s(t.$t("Maps")))]),i("div",{staticClass:"curate-content"},[i("div",{staticClass:"viz-table"},t._l(Object.entries(t.vizMaps),function(n){var d=n[0],u=n[1];return i("div",{key:d,staticClass:"viz-grid-item",on:{click:function(g){return t.clickedVisualization(d)}}},[i("div",{staticClass:"viz-frame"},[i("p",{staticClass:"v-title"},[i("b",[t._v(t._s(u.title))])]),i("p",{staticClass:"v-filename"},[t._v(t._s(u.config))]),i("p",{staticClass:"v-plugin",style:t.getTabColor(u.component)},[t._v(t._s(u.component||"dashboard"))]),i(u.component,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],tag:"component",staticClass:"viz-frame-component",style:{"pointer-events":"none"},attrs:{root:t.myState.svnProject.slug,subfolder:t.myState.subfolder,yamlConfig:u.config,thumbnail:!0,fileApi:t.myState.svnRoot},on:{title:function(g){return t.updateTitle(d,g)}}})],1)])}),0)])]):t._e(),Object.keys(t.vizImages).length?i("div",{staticClass:"section-images"},[i("h3",{staticClass:"curate-heading"},[t._v(t._s(t.$t("Images")))]),i("div",{staticClass:"curate-content"},[i("div",{staticClass:"viz-image-table"},t._l(Object.entries(t.vizImages),function(n){var d=n[0],u=n[1];return i("div",{key:d,staticClass:"viz-image-grid-item",on:{click:function(g){return t.clickedVisualization(d)}}},[i("div",{staticClass:"viz-image-frame"},[i(u.component,{tag:"component",staticClass:"viz-image-frame-component",style:{"pointer-events":"auto"},attrs:{root:t.myState.svnProject.slug,subfolder:t.myState.subfolder,yamlConfig:u.config,thumbnail:!0,fileApi:t.myState.svnRoot},on:{title:function(g){return t.updateTitle(d,g)}}}),i("p",[t._v(t._s(u.title))])],1)])}),0)])]):t._e(),(e=t.myState)!==null&&e!==void 0&&(s=e.svnProject)!==null&&s!==void 0&&s.baseURL?i("div",{staticClass:"files-section"},[t.myState.files.length?i("h3",{staticClass:"curate-heading"},[t._v(t._s(t.$t("Files")))]):t._e(),t.myState.files.length?i("div",{staticClass:"curate-content"},[i("div",{staticClass:"file-table"},t._l(t.myState.files,function(n){return i("div",{key:n,staticClass:"file",class:{fade:t.myState.isLoading}},[i("a",{attrs:{href:`${t.myState.svnProject.baseURL}/${t.myState.subfolder}/${n}`}},[t._v(t._s(t.cleanName(n)))])])}),0)]):t._e()]):t._e()])])])])},ga=[];const Gt={};var ya=G(pa,va,ga,!1,_a,"4eb2bcb9",null,null);function _a(e){for(let s in Gt)this[s]=Gt[s]}var ds=function(){return ya.exports}();const ba=[".nodashboards","nodashboards","nodashboards.txt"],Vt=new Ke({html:!0,linkify:!0,typographer:!0});var Sa=X({name:"TabbedDashboardView",components:{DashBoard:ws,FolderBrowser:ds},props:{root:{type:String,required:!0},xsubfolder:{type:String,required:!0}},data:()=>({dashboards:[],dashboardDataManager:null,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},isZoomed:!1,styleElement:null,loadErrorMessage:"",activeTab:"",pageHeader:"",folderReadme:"",header:"",footer:"",customCSS:"",dashboardTabWithDelay:"",showFooter:!1}),computed:{fileApi(){return new Xe(this.fileSystem,w)},fileSystem(){const e=this.$store.state.svnProjects.filter(s=>s.slug===this.root);if(e.length===0)throw console.log("no such project"),Error;return e[0]},wiide(){return this.$store.state.isFullWidth},dashWidthCalculator(){return this.$store.state.dashboardWidth&&this.$store.state.isFullWidth?{maxWidth:this.$store.state.dashboardWidth}:{}}},watch:{root(){this.updateRoute()},xsubfolder(){this.updateRoute()}},methods:{clearStyles(){this.styleElement&&(document.getElementsByTagName("head")[0].removeChild(this.styleElement),this.styleElement=null)},getPageHeader(){return this.xsubfolder?this.xsubfolder.substring(1+this.xsubfolder.lastIndexOf("/")):this.fileSystem.name||this.root},onNavigate(e){this.$emit("navigate",e)},async getFolderReadme(){try{this.folderReadme="";const{files:e}=await this.fileApi.getDirectory(this.xsubfolder),s=e.filter(i=>i.toLocaleLowerCase()==="readme.md");if(!s.length)return;const t=await this.fileApi.getFileText(`${this.xsubfolder}/${s[0]}`),a=Vt.render(t);this.folderReadme=a}catch{this.folderReadme=""}},async findConfigsAndDashboards(){if(this.loadErrorMessage="",!this.fileApi)return[];await this.fileApi.getChromePermission(this.fileSystem.handle),this.getFolderReadme();try{this.allConfigFiles=await this.fileApi.findAllYamlConfigs(this.xsubfolder);const{files:e}=await this.fileApi.getDirectory(this.xsubfolder);let s=!0;if(ba.forEach(t=>{e.indexOf(t)>-1&&(s=!1)}),s)for(const t of Object.values(this.allConfigFiles.dashboards))pt.set(this.dashboards,t,{header:{tab:"..."}}),await this.initDashboard(t)||delete this.dashboards[t];if(pt.set(this.dashboards,"FILE__BROWSER",{header:{tab:"Files"}}),this.$route.query.tab)try{const t=parseInt(""+this.$route.query.tab)-1,a=Object.keys(this.dashboards)[t];this.activeTab=a||Object.keys(this.dashboards)[0]}catch{this.activeTab=Object.keys(this.dashboards)[0]}else this.activeTab=Object.keys(this.dashboards)[0];this.dashboardTabWithDelay=this.activeTab,await this.setupProjectConfig()}catch(e){console.warn({eeee:e}),this.fileSystem.handle?this.loadErrorMessage=`Click to grant access to folder "${this.fileSystem.handle.name}"`:this.loadErrorMessage=this.fileSystem.baseURL+": Could not load"}},async setupProjectConfig(){if(!!Object.keys(this.allConfigFiles.configs).length)for(const e of Object.values(this.allConfigFiles.configs))try{const s=await this.fileApi.getFileText(e),t=Ye.parse(s),a=e.startsWith("http")?"":e.substring(0,e.indexOf("simwrapper-config.y"));t.hideLeftBar===!0&&this.$store.commit("setShowLeftBar",!1),t.hideLeftBar===!1&&this.$store.commit("setShowLeftBar",!0),this.$store.commit("setFullWidth",!!t.fullWidth),this.$store.commit("setDashboardWidth",""),t.width!==void 0&&(this.$store.commit("setDashboardWidth",""+t.width),this.$store.commit("setFullWidth",!0));try{t.css&&(this.customCSS=await this.fileApi.getFileText(`${a}${t.css}`),this.styleElement=document.createElement("style"),this.styleElement.appendChild(document.createTextNode(this.customCSS)),document.getElementsByTagName("head")[0].appendChild(this.styleElement))}catch{}this.header=await this.buildPanel("header",t,a),this.footer=await this.buildPanel("footer",t,a)}catch(s){console.error(""+s)}},handleRemoveDashboard(){},async buildPanel(e,s,t){let a="";if(this.$store.state.locale==="de"?a=s[e+"_de"]||s[e]||s[e+"_en"]||"":a=s[e+"_en"]||s[e]||s[e+"_de"]||"",!a)return"";a.indexOf(`
`)==-1&&a.endsWith(".md")&&(a=await this.fileApi.getFileText(`${t}${a}`));const i=Vt.render(a);return ea.sanitize(i,{USE_PROFILES:{html:!0}})},async initDashboard(e){var s;try{const t=await this.fileApi.getFileText(e),a=Ye.parse(t);if((s=a.header)!=null&&s.triggerPattern){const{files:n,dirs:d}=await this.fileApi.getDirectory(this.xsubfolder),u=[...n,...d];if(J.match(u,a.header.triggerPattern).length===0)return!1}const i=e.substring(0,e.lastIndexOf("."));return a.header||(a.header={title:e,tab:i}),a.header.tab||(a.header.tab=a.header.title||i),this.dashboards[e]=a,console.log("DASHBOARD:",e),!0}catch(t){return this.$store.commit("setStatus",{type:Cs.ERROR,msg:""+t}),!1}},updateRoute(){this.clearStyles(),this.dashboardDataManager&&this.dashboardDataManager.clearCache(),this.dashboardDataManager=new Es(this.root,this.xsubfolder),this.header="",this.footer="",this.dashboards=[],this.pageHeader=this.getPageHeader(),this.findConfigsAndDashboards()},async switchTab(e,s){e!==this.activeTab&&(this.activeTab="",this.dashboardTabWithDelay="",this.showFooter=!1,await this.$nextTick(),this.activeTab=e,setTimeout(()=>{this.dashboardTabWithDelay=e,s?this.$router.replace({query:{tab:`${s+1}`}}):this.$router.replace({query:{}})},125))},handleZoom(e){this.isZoomed=!!e,this.$emit("zoom",this.isZoomed)},handleLayoutComplete(){this.showFooter=!0},getFileSystem(e){const s=this.$store.state.svnProjects.filter(t=>t.slug===e);return s.length===0?(console.warn("no such project"),this.loadErrorMessage=`Can't locate "${e}": please check running services and browser version.`,null):s[0]},goUpOneFolder(){let e=this.xsubfolder;this.xsubfolder.endsWith("/")&&(e=this.xsubfolder.slice(0,length-1)),e=e.substring(0,e.lastIndexOf("/"));const s={root:this.fileSystem.slug,xsubfolder:e};!e&&!this.xsubfolder?this.onNavigate({component:"SplashPage",props:{}}):this.onNavigate({component:"TabbedDashboardView",props:s})},async authorizeAfterError(){try{const e=this.fileSystem.handle;e&&await e.requestPermission({mode:"read"})==="granted"&&this.updateRoute()}catch{}},setTitle(){const e=this.xsubfolder.startsWith("/")?this.xsubfolder.slice(1):this.xsubfolder,s=`${this.fileSystem.name}: ${e}`;this.$emit("title",s)}},mounted(){this.updateRoute(),this.setTitle()},beforeDestroy(){this.dashboardDataManager&&this.dashboardDataManager.clearCache(),this.clearStyles()}}),Ca=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"tabbed-folder-view"},[t("div",{staticClass:"centered-vessel",class:{wiide:e.wiide}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.isZoomed,expression:"!isZoomed"}],staticClass:"tabholder",style:e.dashWidthCalculator},[t("div",{staticClass:"tabholdercontainer"},[e.header?t("div",{staticClass:"project-header",domProps:{innerHTML:e._s(e.header)}}):e._e(),t("div",{staticClass:"tabs is-centered"},[t("ul",{staticStyle:{"margin-right":"1rem"}},e._l(Object.keys(e.dashboards),function(a,i){return t("li",{key:a,class:{"is-active":a===e.activeTab,"is-not-active":a!==e.activeTab},style:{opacity:a===e.activeTab?1:.5}},[t("b",[e.dashboards[a].header?t("a",{on:{click:function(n){return e.switchTab(a,i)}}},[e._v(e._s(e.dashboards[a].header.tab))]):e._e()])])}),0)])])]),e.dashboardTabWithDelay&&e.dashboardTabWithDelay!=="FILE__BROWSER"&&e.dashboards[e.dashboardTabWithDelay]&&e.dashboards[e.dashboardTabWithDelay].header.tab!=="..."?t("dash-board",{attrs:{root:e.root,xsubfolder:e.xsubfolder,config:e.dashboards[e.dashboardTabWithDelay],datamanager:e.dashboardDataManager,zoomed:e.isZoomed,allConfigFiles:e.allConfigFiles},on:{zoom:e.handleZoom,layoutComplete:e.handleLayoutComplete}}):e._e(),e.dashboardTabWithDelay&&e.dashboardTabWithDelay==="FILE__BROWSER"?t("folder-browser",{attrs:{root:e.root,xsubfolder:e.xsubfolder,allConfigFiles:e.allConfigFiles},on:{navigate:e.onNavigate,up:function(a){return e.goUpOneFolder()}}}):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.showFooter&&!e.isZoomed,expression:"showFooter && !isZoomed"}],staticClass:"tabholder",class:{wiide:e.wiide},style:e.dashWidthCalculator},[t("div",{staticClass:"tabholdercontainer",class:{wiide:e.wiide}},[e.footer?t("div",{staticClass:"project-footer",class:{wiide:e.wiide},domProps:{innerHTML:e._s(e.footer)}}):e._e()])])],1)])},wa=[];const qt={};var Ta=G(Sa,Ca,wa,!1,Ea,"28e9d3ef",null,null);function Ea(e){for(let s in qt)this[s]=qt[s]}var Aa=function(){return Ta.exports}(),Da=X({name:"FileSystemComponents",data:()=>({sources:[]}),mounted(){this.sources=w.state.svnProjects.filter(e=>!e.hidden&&!e.slug.startsWith("fs"))},methods:{openProjectPage(e){const s=Object.assign({},e);s.component="TabbedDashboardView",s.props={root:e.slug,xsubfolder:""},this.$emit("navigate",s)},openProjectTab(e){window.open(e,"_blank")}}}),La=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"svn-projects"},e._l(e.sources,function(a){return t("div",{key:a.url,staticClass:"project",on:{click:[function(i){return e.openProjectPage(a)},function(i){return i.metaKey?e.openProjectTab(a):null},function(i){return i.ctrlKey?e.openProjectTab(a):null}],mouseup:function(i){return"button"in i&&i.button!==1?null:e.openProjectTab(a)}}},[t("div",{staticClass:"desc"},[t("h3",[e._v(e._s(a.name))]),t("p",[e._v(e._s(a.description))])])])}),0)},ka=[];const Yt={};var xa=G(Da,La,ka,!1,Ra,"617cdc17",null,null);function Ra(e){for(let s in Yt)this[s]=Yt[s]}var us=function(){return xa.exports}(),Oa=function(){var e=this,s=e.$createElement;return e._self._c,e._m(0)},Fa=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"markdown-body"},[t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://simwrapper.github.io/docs"}},[e._v("Documentation and users guide")]),e._v(" including examples and getting started")])]),t("li",[t("p",[t("a",{attrs:{href:"https://github.com/simwrapper/simwrapper"}},[e._v("Source code")]),e._v(" available on Github")])])])])}];const $a={},za={data(){return{frontmatter:$a}}},Zt={};var Pa=G(za,Oa,Fa,!1,Na,null,null,null);function Na(e){for(let s in Zt)this[s]=Zt[s]}var Ma=function(){return Pa.exports}();const Ia={messages:{en:{"more-info":"Documentation:",tagLine:"the simulation browser and data visualizer from TU&nbsp;Berlin.",privacy:`SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.

SimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted.`},de:{"more-info":"F\xFCr weitere Informationen:",tagLine:"Der Modellergebnis-Browser der TU Berlin."}}},Xt="/",Ha=[{url:"https://vsp.berlin/en/",image:"vsp-logo-300dpi.png",name:"VSP TU-Berlin"},{url:"https://matsim.org/",image:"matsim-logo-blue.png",name:"MATSim"},{url:"https://tu.berlin",image:"tu-logo.png",name:"TU Berlin"},{url:"https://bmbf.de",image:"bmbf-logo.png",name:"German Federal BMBF"},{url:"https://www.sfcta.org/",image:"sfcta.png",name:"SFCTA"},{url:"https://metrocouncil.org/",image:"metcouncil.png",name:"Met Council"},{url:"http://www.sandag.org/",image:"sandag.jpg",name:"SANDAG"},{url:"https://mtc.ca.gov/",image:"mtc.png",name:"MTC"},{url:"https://www.psrc.org/",image:"psrc.png",name:"Puget Sound Regional Council"},{url:"https://www.mwcog.org/",image:"mwcog.png",name:"MWCOG"},{url:"https://www.oregon.gov/ODOT",image:"oregondot.png",name:"Oregon DOT"},{url:"https://atlantaregional.org/",image:"arc.png",name:"ARC"},{url:"https://www.transportation.ohio.gov/",image:"ohiodot.png",name:"Ohio DOT"},{url:"http://semcog.org/",image:"semcog.jpg",name:"SEMCOG"}];var ja=X({name:"SplashPage",i18n:Ia,components:{FileSystemProjects:us,InfoBottom:Ma},data:()=>({state:w.state,allRoots:[]}),computed:{allLogos(){return Ha.map(e=>({url:e.url,image:`${Xt}images/logos/${e.image}`}))},isChrome(){return!!window.showDirectoryPicker},localFileHandles(){return this.$store.state.localFileHandles.concat().sort((e,s)=>parseInt(e.key.substring(2))<parseInt(s.key.substring(2))?-1:1)}},methods:{onNavigate(e){this.$emit("navigate",e)},updateShortcuts(){const e=this.state.svnProjects.filter(s=>!s.hidden&&!s.slug.startsWith("fs"));this.allRoots=e},configureSources(){this.$emit("activate",{name:"Settings",class:"SettingsPanel"})},clickedOnFolder(e){const{folder:s,root:t,i:a}=e;let i=`${t}`;s&&(i+=`/${s}`),this.$router.push(i)},async clickedBrowseChromeLocalFolder(e){try{const s=await e.handle.requestPermission({mode:"read"});if(console.log(e.handle,s),s!=="granted")return;is.find(i=>i.slug==e.key)||qe(e.handle,e.key);const a={root:e.key};this.clickedOnFolder(a)}catch(s){console.error(""+s)}},async showChromeDirectory(){try{const s=await window.showDirectoryPicker(),t=qe(s,null);this.$router.push(`${Xt}${t}/`)}catch{}},async clickedDelete(e){const t=this.$store.state.localFileHandles.filter(a=>a.key!==e.key);await rs("fs",t),this.$store.commit("setLocalFileSystem",t)}},mounted(){if(!this.state.breadcrumbs.length){const e=[{label:"SimWrapper",url:"/"}];w.commit("setBreadCrumbs",e)}this.updateShortcuts()}}),Wa="/assets/SW_logo_yellow.abf06ffb.png",Ua="/assets/SW_logo_purple.175fca9f.png",Ba=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"splash-page"},[t("div",{staticClass:"scrolly"},[t("div",{staticClass:"thing-area"},[t("div",{staticClass:"top-area"},[t("div",{staticClass:"simwrapper-logo"},[e.state.isDarkMode?t("img",{attrs:{src:Wa}}):t("img",{attrs:{src:Ua}})])]),t("div",{staticClass:"middle-area"},[e.isChrome?t("div",{staticClass:"is-chrome"},[t("h3",[e._v("Local Folders")]),e.localFileHandles.length?e._e():t("p",[e._v("Chrome & Edge can browse folders directly:")]),t("div",{staticClass:"roots"},e._l(e.localFileHandles,function(a){return t("div",{key:a.key,staticClass:"project-root local",on:{click:function(i){return e.clickedBrowseChromeLocalFolder(a)}}},[t("h5",{staticClass:"remove-local",staticStyle:{flex:"1"}},[e._v(e._s(a.handle.name)),t("i",{staticClass:"fa fa-times",on:{click:function(i){return i.stopPropagation(),e.clickedDelete(a)}}})]),t("p",[e._v("Local folder")])])}),0),t("p",{staticClass:"config-sources"},[t("a",{on:{click:e.showChromeDirectory}},[e._v("Add local folder...")])])]):e._e(),t("h3",{staticStyle:{"margin-top":"1rem"}},[e._v("Browse Data Sources")]),t("div",{staticClass:"roots"},e._l(e.allRoots,function(a){return t("div",{key:a.slug,staticClass:"project-root",on:{click:function(i){return e.clickedOnFolder({root:a.slug})}}},[t("h5",[e._v(e._s(a.name))]),t("p",[e._v(e._s(a.description))])])}),0),t("p",{staticClass:"config-sources"},[t("a",{on:{click:e.configureSources}},[e._v("Edit data sources...")])]),t("p",{staticClass:"funding"},[e._v("Funded by TU Berlin, the German Bundesministerium f\xFCr Bildung und Forschung, and the ActivitySim Consortium member agencies.")]),e._m(0),e._m(1)])]),t("div",{staticClass:"links-and-logos"},[t("div",{staticClass:"logos"},e._l(e.allLogos,function(a){return t("a",{attrs:{href:a.url,title:a.name,target:"_blank"}},[t("img",{staticClass:"img-logo",attrs:{src:a.image}})])}),0)])])])},Ga=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"legal"},[t("p",[e._v("SimWrapper is open source and available on\xA0"),t("a",{attrs:{href:"https://github.com/simwrapper/simwrapper"}},[e._v("GitHub.")])])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"legal"},[t("p",[t("a",{attrs:{href:"https://vsp.berlin/en/",target:"_blank"}},[e._v("VSP\xA0TU\xA0Berlin")]),t("a",{attrs:{href:"https://vsp.berlin/impressum/",target:"_blank"}},[e._v("Impressum")]),t("a",{attrs:{href:"https://www.vsp.tu-berlin.de/menue/service/privacy/parameter/en/",target:"_blank"}},[e._v("Privacy")])])])}];const Kt={};var Va=G(ja,Ba,Ga,!1,qa,"3be2f6ec",null,null);function qa(e){for(let s in Kt)this[s]=Kt[s]}var Ya=function(){return Va.exports}(),Za="/assets/files.4e6d24ab.svg",Xa="/assets/issues.45ff9b99.svg",Ka="/assets/settings.6e19bc2b.svg",Ja="/assets/readme.bff70382.svg";const Qa="https://simwrapper.github.io/docs";var ei=X({name:"LeftIconPanel",props:{activeSection:{type:String,required:!0}},data:()=>({state:w.state,topSections:[{name:"Files",class:"BrowserPanel",icon:Za},{name:"Issues",class:"ErrorPanel",icon:Xa,colorize:!0}],bottomSections:[{name:"Docs",link:Qa,icon:Ja},{name:"Settings",class:"SettingsPanel",icon:Ka}]}),computed:{issueColor(){return this.state.statusErrors.length?"invert(60%) sepia(100%) hue-rotate(310deg) saturate(8.5)":this.state.statusWarnings.length?"invert(75%) sepia(100%) hue-rotate(15deg) saturate(5.5)":"invert(100%)"}},methods:{select(e){this.$emit("activate",e)},buttonStyle(e){const s=this.state.statusErrors.length||this.state.statusWarnings.length?.8:.4;return this.activeSection!==e.name?{opacity:e.colorize?s:.4}:{opacity:1,borderLeft:"3px solid white"}}}}),ti=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"left-nav-panel"},[t("div",{staticClass:"top"},e._l(e.topSections,function(a){return t("button",{key:a.name,staticClass:"item",style:e.buttonStyle(a),on:{click:function(i){return e.select(a)}}},[t("img",{staticClass:"svg-icon",style:{filter:a.colorize?e.issueColor:"invert(100%)"},attrs:{src:a.icon,draggable:!1}}),t("p",[e._v(e._s(a.name))])])}),0),t("div",{staticClass:"bottom"},e._l(e.bottomSections,function(a){return t("button",{key:a.name,staticClass:"item",style:e.buttonStyle(a),on:{click:function(i){return e.select(a)}}},[t("img",{staticClass:"svg-icon",style:{filter:a.colorize?e.issueColor:"invert(100%)"},attrs:{src:a.icon,draggable:!1}}),t("p",[e._v(e._s(a.name))])])}),0)])},si=[];const Jt={};var ai=G(ei,ti,si,!1,ii,"2289cfaf",null,null);function ii(e){for(let s in Jt)this[s]=Jt[s]}var ri=function(){return ai.exports}();const ni={messages:{en:{sync:"Sync folders",theme:"Light/Dark",lang:"EN/DE",split:"Split view"},de:{sync:"Sync",theme:"Hell/Dunkel",lang:"DE/EN",split:"Aufteilen"}}};var oi=X({name:"ErrorPanel",i18n:ni,data:()=>({state:w.state,showDescription:!1,descriptionIndexListWarning:[],descriptionIndexListError:[],isError:!1}),watch:{"$route.path"(){this.clearAllButtons()}},computed:{headerTextColor(){let e={};return this.state.statusWarnings.length&&(e={color:"#fe8"}),this.state.statusErrors.length&&(e={color:"#f66"}),e}},methods:{cleanError(e){return e?e.startsWith("Error: ")?e.slice(7):e:""},clearAllButtons(){this.$store.commit("clearAllErrors"),this.$emit("activate",{name:"Files",class:"BrowserPanel",onlyIfVisible:!0})},toggleShowDescription(e,s){if(this.isError=s,s)if(this.descriptionIndexListError.includes(e)){var t=this.descriptionIndexListError.indexOf(e);this.descriptionIndexListError.splice(t,1)}else this.descriptionIndexListError.push(e);else if(this.descriptionIndexListWarning.includes(e)){var t=this.descriptionIndexListWarning.indexOf(e);this.descriptionIndexListWarning.splice(t,1)}else this.descriptionIndexListWarning.push(e)}}}),li=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"panel"},[t("div",{staticClass:"top-panel"},[t("h4",{style:e.headerTextColor},[e._v("Issues")]),t("div",{staticClass:"warnings"},[!e.state.statusErrors.length&&!e.state.statusWarnings.length?t("div",{staticClass:"no-error"},[t("p",{staticClass:"check"},[e._v("\u2611\uFE0F")]),t("p",[e._v("No issues for this page.")])]):t("div",{staticClass:"message-area"},[e.state.statusErrors.length?t("h3",[e._v("Errors: "+e._s(e.state.statusErrors.length))]):e._e(),e._l(e.state.statusErrors,function(a,i){return t("div",{staticClass:"single-message"},[t("p",{domProps:{innerHTML:e._s(e.cleanError(a.msg))},on:{click:function(n){return e.toggleShowDescription(i,!0)}}}),e.descriptionIndexListError.includes(i)?t("div",{staticClass:"description"},[t("p",{domProps:{innerHTML:e._s(a.desc)}})]):e._e()])}),e.state.statusWarnings.length?t("h3",[e._v("Warnings: "+e._s(e.state.statusWarnings.length))]):e._e(),e._l(e.state.statusWarnings,function(a,i){return t("div",{staticClass:"single-message"},[t("p",{domProps:{innerHTML:e._s(a.msg)},on:{click:function(n){return e.toggleShowDescription(i,!1)}}}),e.descriptionIndexListWarning.includes(i)?t("div",{staticClass:"description"},[t("p",{domProps:{innerHTML:e._s(a.desc)}})]):e._e()])})],2)])]),t("div",{staticClass:"bottom-panel"},[e.state.statusErrors.length||e.state.statusWarnings.length?t("b-button",{staticClass:"clear-button",attrs:{expanded:""},on:{click:function(a){return e.clearAllButtons()}}},[e._v("Clear all messages")]):e._e()],1)])},ci=[];const Qt={};var di=G(oi,li,ci,!1,ui,"37fd5193",null,null);function ui(e){for(let s in Qt)this[s]=Qt[s]}var mi=function(){return di.exports}();const hi=`
Add a local shortcut for any URL-based resource.
SimWrapper requires several server settings, including:

- Open access (no login)
- File and directory listings
-  CORS "Access-Control-Allow-Origin"
`;var fi=X({name:"AddDataSource",props:{},data:()=>({labelField:"",urlField:"",noteField:"",notes:"",mdParser:new Ke}),mounted(){this.notes=this.mdParser.render(hi)},watch:{labelField(){this.fixField()}},computed:{isValidURL(){return!(!this.labelField||!this.urlField||!this.urlField.startsWith("http"))}},methods:{addURL(){this.fixField(),console.log("Adding",this.labelField,this.urlField);const e="projectShortcuts";try{let s=localStorage.getItem(e)||"{}",t=JSON.parse(s);t[this.labelField]={name:`${this.labelField}`,slug:`${this.labelField}`,description:this.noteField,baseURL:this.urlField},console.log("NEW ROOTS",t),localStorage.setItem(e,JSON.stringify(t)),w.commit("setURLShortcuts",t)}catch(s){console.error(""+s)}},fixField(){this.labelField=this.labelField.toLowerCase().replaceAll(/[^a-z\-0-9@]*/g,"")}}}),pi=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"add-data"},[t("div",{staticClass:"add"},[t("div",{staticClass:"markdown",domProps:{innerHTML:e._s(e.notes)}}),t("div",{staticClass:"flex-row"},[e._m(0),t("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"e.g. server1",maxlength:"32"},model:{value:e.labelField,callback:function(a){e.labelField=a},expression:"labelField"}})],1),t("div",{staticClass:"flex-row"},[e._m(1),t("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"http://localhost:8001",maxlength:"512"},model:{value:e.urlField,callback:function(a){e.urlField=a},expression:"urlField"}})],1),t("div",{staticClass:"flex-row"},[e._m(2),t("b-input",{staticClass:"flex5",attrs:{size:"is-small",placeholder:"optional",maxlength:"255"},model:{value:e.noteField,callback:function(a){e.noteField=a},expression:"noteField"}})],1),t("div",{staticClass:"flex-row"},[t("p",{staticClass:"flex1"},[e._v("\xA0")]),t("b-button",{staticClass:"is-primary",attrs:{size:"is-small",disabled:!e.isValidURL,type:e.isValidURL?"":"is-outlined"},on:{click:e.addURL}},[e._v("Add Data URL")])],1)])])},vi=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("p",{staticClass:"flex1"},[t("b",[e._v("Label")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("p",{staticClass:"flex1"},[t("b",[e._v("URL")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("p",{staticClass:"flex1"},[t("b",[e._v("Note")])])}];const es={};var gi=G(fi,pi,vi,!1,yi,"3055b930",null,null);function yi(e){for(let s in es)this[s]=es[s]}var ms=function(){return gi.exports}();const _i="/",bi=[".nodashboards","nodashboards","nodashboards.txt"],Si={messages:{en:{Maps:"Maps & Dashboards",Images:"Images",Analysis:"Analysis",Files:"Files",Folders:"Folders",Topsheet:"Table",privacy:`SimWrapper is a client-side app, which means there is no upstream server collecting or storing data.

SimWrapper does not collect, handle or process any data about you while you use the site. SimWrapper does not contain any tracking devices or analytics software. No user cookies are stored or transmitted.`},de:{Maps:"Karten",Images:"Bilder",Analysis:"Ergebnisse",Files:"Dateien",Folders:"Ordner",Topsheet:"Tabelle"}}},Ci={"":"#118860","aggregate-od":"#E98B52","vehicle-anim":"#330033","x-y-t":"#583270",carriers:"#c97A2C",events:"#4400ff",hexagons:"#900564",map:"#c94264",network:"#894654",sankey:"#D8A672",summary:"#2EA95B",transit:"#3B6FE4"},wi=Object.assign({AddDataSource:ms,FileSystemProjects:us,TopsheetsFinder:cs},_t);var Ti=X({name:"BrowserPanel",i18n:Si,components:wi,data:()=>({globalState:w.state,subfolder:"/",root:"",summaryYamlFilename:"viz-summary.yml",highlightedViz:-2,needDoubleClickHint:!1,allConfigFiles:{dashboards:{},topsheets:{},vizes:{},configs:{}},allRoots:[],mdRenderer:new Ke({html:!0,linkify:!0,typographer:!0}),myState:{errorStatus:"",folders:[],files:[],isLoading:!1,readme:"",svnProject:null,svnRoot:void 0,subfolder:"",vizes:[],summary:!1},clicks:0,clickTimer:{}}),mounted(){this.setupHints(),this.updateShortcuts(),this.getRootAndRoute(this.$route.params.pathMatch)},watch:{"globalState.svnProjects"(){this.updateShortcuts()},"globalState.colorScheme"(){this.fetchFolderContents()},subfolder(){this.updateRoute()},"globalState.authAttempts"(){this.authenticationChanged()},"myState.files"(){this.filesChanged()}},computed:{hasDashboards(){return!!Object.keys(this.allConfigFiles.dashboards).length},vizImages(){const e={};for(let s=0;s<this.myState.vizes.length;s++)this.myState.vizes[s].component==="image-view"&&(e[s]=this.myState.vizes[s]);return e},vizMaps(){const e=["image-view","dashboard"],s=new Map;this.hasDashboards&&s.set(-1,{component:"",title:"Dashboard Panel"});for(let t=0;t<this.myState.vizes.length;t++)e.includes(this.myState.vizes[t].component)||s.set(t,this.myState.vizes[t]);return s},isChrome(){return!!window.showDirectoryPicker},localFileHandles(){return this.$store.state.localFileHandles.concat().sort((e,s)=>parseInt(e.key.substring(2))<parseInt(s.key.substring(2))?-1:1)}},methods:{updateRoute(){if(!this.root)return;const e=this.getFileSystem(this.root);this.myState.svnProject=e,this.myState.subfolder=this.subfolder||"",this.myState.readme="",this.highlightedViz=-2,this.myState.svnProject&&(this.myState.svnRoot=new Xe(this.myState.svnProject,w),this.generateBreadcrumbs(),this.fetchFolderContents())},authenticationChanged(){console.log("AUTH CHANGED - Reload"),this.updateRoute()},async filesChanged(){this.myState.vizes=[],this.myState.files.length!==0&&(this.showReadme(),this.myState.summary=this.myState.files.indexOf(this.summaryYamlFilename)!==-1,this.myState.summary?await this.buildCuratedSummaryView():this.buildShowEverythingView(),await this.$nextTick(),ls(".medium-zoom",{background:"#444450"}))},updateShortcuts(){const e=this.globalState.svnProjects.filter(s=>!s.hidden&&!s.slug.startsWith("fs"));this.allRoots=e},cleanName(e){return decodeURIComponent(e)},getFileSystem(e){const s=w.state.svnProjects.filter(t=>t.slug===e);if(s.length===0)throw console.log("no such project"),Error;return s[0]},generateBreadcrumbs(){if(!this.myState.svnProject)return[];const e=[{label:"SimWrapper",url:"/"},{label:this.myState.svnProject.name,url:"/"+this.myState.svnProject.slug}],s=this.myState.subfolder.split("/");let t="/";for(const a of s)!a||(t+=a+"/",e.push({label:a,url:"/"+this.myState.svnProject.slug+t}));return w.commit("setBreadCrumbs",e),e},setupHints(){let e=localStorage.getItem("needsClickHint");e?e=JSON.parse(e):e=0,e>5e3?this.needDoubleClickHint=!1:(e++,localStorage.setItem("needsClickHint",JSON.stringify(e)))},clickedBreadcrumb(e){this.getRootAndRoute(e.url.slice(1))},getRootAndRoute(e){if(!e)return;if(e==="/"){this.root="";return}if(e.startsWith("split/")){console.log("SPLIT"),e.substring(6);return}let s=e,t="";const a=e.indexOf("/");a>-1&&(s=e.substring(0,a),t=e.substring(a+1)),this.root=s,this.subfolder=t},activateVisualization(e){const s=this.myState.vizes[e]||{component:"TabbedDashboardView",title:"Dashboard"};if(s.component==="image-view"||!this.myState.svnProject)return;this.highlightedViz=-2;const t=this.myState.subfolder.replaceAll("//","/"),a={root:this.myState.svnProject.slug,xsubfolder:t,subfolder:t,yamlConfig:s.config,thumbnail:!1};this.$emit("navigate",{component:s.component,props:a})},updateTitle(e,s){this.myState.vizes[e].title=s},configureSources(){this.$emit("activate",{name:"Settings",class:"SettingsPanel"})},getTabColor(e){return{backgroundColor:Ci[e]||"#8778BB"}},async showReadme(){this.myState.readme="";const e="readme.md";if(this.myState.files.map(s=>s.toLocaleLowerCase()).indexOf(e)>-1){if(!this.myState.svnRoot)return;const s=await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+e);this.myState.readme=this.mdRenderer.render(s)}},buildShowEverythingView(){for(const e of this.globalState.visualizationTypes.values()){const s=J(this.myState.files,e.filePatterns);for(const t of s)this.myState.vizes.push({component:e.kebabName,config:t,title:".."})}},async buildCuratedSummaryView(){if(!this.myState.svnRoot)return;const e=Ye.parse(await this.myState.svnRoot.getFileText(this.myState.subfolder+"/"+this.summaryYamlFilename));for(const s of e.plugins){const t=this.globalState.visualizationTypes.get(s);if(!!t)if(e[t.kebabName])for(const a of e[t.kebabName]){const i=await this.findMatchingFiles(a);for(const n of i)this.myState.vizes.push({component:t.kebabName,config:n,title:n})}else{const a=J(this.myState.files,t.filePatterns);for(const i of a)this.myState.vizes.push({component:t.kebabName,config:i,title:".."})}}},async findMatchingFiles(e){if(this.myState.files.indexOf(e)>-1)return[e];const s=J(this.myState.files,e);if(s.length)return s;if(!this.myState.svnRoot)return[];try{const t=e.split("/"),a=this.myState.subfolder+"/"+t[0];console.log(a);const i=await this.myState.svnRoot.getDirectory(a);return J(i.files,t[1]).map(d=>t[0]+"/"+d)}catch{}return[]},async fetchFolderContents(){if(!this.myState.svnRoot)return[];this.myState.isLoading=!0,this.myState.errorStatus="",this.myState.files=[];try{this.allConfigFiles=await this.findAllConfigsAndDashboards();const e=await this.myState.svnRoot.getDirectory(this.myState.subfolder),s=e.dirs.filter(n=>!n.startsWith(".")).sort(),t=e.files.filter(n=>!n.startsWith(".")).sort(),a=Object.assign({},this.allConfigFiles.vizes);for(const n of t)a[n]=n;const i=Object.values(a);this.myState.errorStatus="",this.myState.folders=["UP"].concat(s),this.myState.files=i}catch{const s=this.myState.subfolder.lastIndexOf("/");if(s>-1){this.subfolder=this.myState.subfolder.slice(0,s);return}else{this.subfolder="";return}}finally{this.myState.isLoading=!1}},clickedVisualization(e){if(this.myState.isLoading)return;const s=450;this.highlightedViz=e,this.clicks++,this.clicks===1?this.clickTimer=setTimeout(()=>{this.needDoubleClickHint=!0,this.clicks=0},s):(clearTimeout(this.clickTimer),this.needDoubleClickHint=!1,this.activateVisualization(e),this.clicks=0)},clickedOnFolder(e){this.needDoubleClickHint=!1;const{folder:s,root:t,i:a}=e;if(t){this.root=t,this.subfolder="",this.updateRoute();return}if(!this.myState.isLoading&&!!this.myState.svnProject){if(a==0&&s==="UP"){if(this.subfolder==="/"||this.subfolder==="")this.root="";else{const i=this.subfolder.lastIndexOf("/");this.subfolder=i>-1?this.subfolder.slice(0,i):"/"}return}this.subfolder=`${this.subfolder}/${s}`}},handleSingleClickFolder(e){const{folder:s,root:t,i:a}=e;if(t){this.root=t,this.subfolder="",this.updateRoute();return}if(this.myState.isLoading||!this.myState.svnProject||a==0&&s==="UP")return;const i=s===".."?this.myState.subfolder.substring(0,this.myState.subfolder.lastIndexOf("/")):this.myState.subfolder+"/"+s,n={root:this.myState.svnProject.slug,xsubfolder:i};!i&&!this.myState.subfolder?this.$emit("navigate",{component:"SplashPage",props:{}}):this.$emit("navigate",{component:"TabbedDashboardView",props:n})},dragEnd(){this.$emit("isDragging",!1)},dragStart(e,s){var i;this.$emit("isDragging",!0);const t=Object.assign({},s,{root:this.root,subfolder:this.myState.subfolder,xsubfolder:this.myState.subfolder});t.yamlConfig=t.config,delete t.config;const a=JSON.stringify(t);(i=e.dataTransfer)==null||i.setData("bundle",a)},clickedLogo(){this.$router.push("/")},async findAllConfigsAndDashboards(){if(!this.myState.svnRoot)return{dashboards:{},configs:{},vizes:{},topsheets:{}};try{const{files:e}=await this.myState.svnRoot.getDirectory(this.subfolder);let s=!0;bi.forEach(a=>{e.indexOf(a)>-1&&(s=!1)});const t=await this.myState.svnRoot.findAllYamlConfigs(this.subfolder);return s||(t.dashboards={}),t}catch{return{dashboards:{},configs:{},vizes:{},topsheets:{}}}},async clickedBrowseChromeLocalFolder(e){try{const s=await e.handle.requestPermission({mode:"read"});if(console.log(e.handle,s),s!=="granted")return;is.find(i=>i.slug==e.key)||qe(e.handle,e.key);const a={root:e.key};this.clickedOnFolder(a)}catch(s){console.error(""+s)}},async showChromeDirectory(){try{const s=await window.showDirectoryPicker(),t=qe(s,null);this.$router.push(`${_i}${t}/`)}catch{}},async clickedDelete(e){const t=this.$store.state.localFileHandles.filter(a=>a.key!==e.key);await rs("fs",t),this.$store.commit("setLocalFileSystem",t)}}}),Ei=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"panel"},[t("div",{staticClass:"top-panel"},[t("h4",[e._v("Files")]),e.root?t("div",{staticClass:"trail"},[t("div",{staticClass:"x-home"},[t("p",{on:{click:function(a){return e.clickedBreadcrumb({url:"//"})}}},[t("i",{staticClass:"fa fa-home"})])]),e.root?t("div",{staticClass:"x-breadcrumbs"},e._l(e.globalState.breadcrumbs.slice(1),function(a,i){return t("p",{key:a.url,on:{click:function(n){return e.clickedBreadcrumb(a)}}},[e._v("\xA0/\xA0"+e._s(a.label))])}),0):e._e()]):e._e()]),t("div",{staticClass:"middle-panel"},[e.root?t("div",{staticClass:"curated-sections"},[t("h3",{staticClass:"curate-heading"},[e._v(e._s(e.globalState.breadcrumbs[e.globalState.breadcrumbs.length-1].label))]),e.myState.folders.length?t("div",{staticClass:"curate-content"},[t("div",{staticClass:"folder-table"},e._l(e.myState.folders,function(a,i){return t("div",{key:a,staticClass:"folder",class:{fade:e.myState.isLoading,upfolder:i==0},on:{click:function(n){return e.clickedOnFolder({folder:a,i})}}},[t("i",{staticClass:"fa",class:i==0?"fa-arrow-up":"fa-folder-open"}),t("p",[e._v(e._s(e.cleanName(a)))])])}),0),e.myState.folders.length==1?t("p",{staticStyle:{"font-size":"0.9rem",opacity:"0.7",margin:"0.5rem 0","text-align":"right"}},[e._v("No subfolders.")]):e._e()]):e._e(),e.vizMaps.size?t("div",{staticClass:"section-maps"},[t("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Maps")))]),t("div",{staticClass:"curate-content"},[t("div",{staticClass:"viz-table"},e._l(e.vizMaps.entries(),function(a){var i=a[0],n=a[1];return t("div",{key:i,staticClass:"viz-grid-item",on:{click:function(d){return e.clickedVisualization(i)}}},[t("div",{staticClass:"viz-frame",class:{highlighted:i===e.highlightedViz},attrs:{draggable:""},on:{dragstart:function(d){return e.dragStart(d,n)},dragend:e.dragEnd}},[t("p",{staticClass:"v-title"},[t("b",[e._v(e._s(n.title))])]),t("p",{staticClass:"v-filename"},[e._v(e._s(n.config))]),t("p",{staticClass:"v-plugin",style:e.getTabColor(n.component)},[e._v(e._s(n.component||"dashboard"))]),t(n.component,{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],tag:"component",staticClass:"viz-frame-component",style:{"pointer-events":"none"},attrs:{root:e.myState.svnProject.slug,subfolder:e.myState.subfolder,yamlConfig:n.config,thumbnail:!0,fileApi:e.myState.svnRoot},on:{title:function(d){return e.updateTitle(i,d)}}})],1)])}),0),t("div",{staticClass:"hint-clicks",style:{opacity:e.needDoubleClickHint?1:0}},[e._m(1)])])]):e._e(),Object.keys(e.vizImages).length?t("div",{staticClass:"section-images"},[t("h3",{staticClass:"curate-heading"},[e._v(e._s(e.$t("Images")))]),t("div",{staticClass:"curate-content"},[t("div",{staticClass:"viz-image-table"},e._l(Object.entries(e.vizImages),function(a){var i=a[0],n=a[1];return t("div",{key:i,staticClass:"viz-image-grid-item",on:{click:function(d){return e.clickedVisualization(i)}}},[t("div",{staticClass:"viz-image-frame"},[t(n.component,{tag:"component",staticClass:"viz-image-frame-component",style:{"pointer-events":"auto"},attrs:{root:e.myState.svnProject.slug,subfolder:e.myState.subfolder,yamlConfig:n.config,thumbnail:!0,fileApi:e.myState.svnRoot},on:{title:function(d){return e.updateTitle(i,d)}}}),t("p",[e._v(e._s(n.title))])],1)])}),0)])]):e._e()]):t("div",{staticClass:"curated-sections"},[e._m(0),e.isChrome?t("div",{staticClass:"is-chrome"},[t("h3",[e._v("Local Folders")]),e.localFileHandles.length?e._e():t("p",[e._v("Chrome & Edge can browse folders directly:")]),e._l(e.localFileHandles,function(a){return t("div",{key:a.key,staticClass:"project-root local",on:{click:function(i){return e.clickedBrowseChromeLocalFolder(a)}}},[t("h5",{staticClass:"remove-local",staticStyle:{flex:"1"}},[e._v(e._s(a.handle.name)),t("i",{staticClass:"fa fa-times",on:{click:function(i){return i.stopPropagation(),e.clickedDelete(a)}}})]),t("p",[e._v("Local folder")])])}),t("p",{staticClass:"config-sources"},[t("a",{on:{click:e.showChromeDirectory}},[e._v("Add local folder...")])])],2):e._e(),t("h3",{staticStyle:{"margin-top":"1rem"}},[e._v("Data Sources")]),e._l(e.allRoots,function(a){return t("div",{key:a.slug,staticClass:"project-root",on:{click:function(i){return e.clickedOnFolder({root:a.slug})}}},[t("h5",[e._v(e._s(a.name))]),t("p",[e._v(e._s(a.description))])])}),t("p",{staticClass:"config-sources"},[t("a",{on:{click:e.configureSources}},[e._v("Edit data sources...")])])],2)])])},Ai=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"hint-clicks",staticStyle:{"margin-bottom":"1rem",opacity:"1"}},[t("p",[e._v("You can browse to another folder from here. Drag panels into the main window area to open them side-by-side.")])])},function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("p",[t("b",[e._v("Drag")]),e._v("\xA0or\xA0"),t("b",[e._v("double-click")]),e._v("\xA0a tile"),t("br"),e._v("to open it in the main panel")])}];const ts={};var Di=G(Ti,Ei,Ai,!1,Li,"351541a6",null,null);function Li(e){for(let s in ts)this[s]=ts[s]}var ki=function(){return Di.exports}();const xi={messages:{en:{translate:"Note: German translations are incomplete, but steadily improving",theme:"Theme",light:"Light",dark:"Dark",language:"Language",dataSources:"Data Sources",addDataSources:"Add Data Source"},de:{translate:"Die \xDCbersetzungen sind unvollst\xE4ndig, werden aber immer besser...",theme:"Thema",light:"Hell",dark:"Dunkel",language:"Sprache",dataSources:"Datenquellen"}}};var Ri=X({name:"SettingsPanel",components:{AddDataSource:ms},i18n:xi,data:()=>({state:w.state,theme:"",shortcuts:[]}),mounted(){this.theme=this.state.isDarkMode?"dark":"light",this.setupShortcuts()},watch:{"state.svnProjects"(){this.setupShortcuts()},"state.isDarkMode"(){console.log("ooop!",this.state.isDarkMode),this.theme=this.state.isDarkMode?"dark":"light"}},computed:{isLight(){return this.theme=="light"?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isDark(){return this.theme=="dark"?{backgroundColor:"#7957d5",color:"white",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isEN(){return this.state.locale=="en"?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}},isDE(){return this.state.locale=="de"?{backgroundColor:"#ffdd57",color:"#222",borderColor:"#aaa"}:{backgroundColor:"unset",color:"#888",borderColor:"#aaa"}}},methods:{setupShortcuts(){try{const e=localStorage.getItem("projectShortcuts");if(e){const s=JSON.parse(e);this.shortcuts=Object.values(s)}}catch(e){console.error("ERROR MERGING URL SHORTCUTS:",""+e)}},deleteShortcut(e){try{const s=localStorage.getItem("projectShortcuts");if(s){const t=JSON.parse(s);delete t[e],localStorage.setItem("projectShortcuts",JSON.stringify(t)),w.commit("removeURLShortcut",e),this.shortcuts=Object.values(t)}}catch(s){console.error("ERROR MERGING URL SHORTCUTS:",""+s)}},setTheme(e){this.theme=e,console.log(this.theme),w.commit("setTheme",e)},setLanguage(e){this.$store.commit("setLocale",e),this.$root.$i18n.locale=e}}}),Oi=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"panel"},[e._m(0),t("div",{staticClass:"middle-panel"},[t("div",{staticClass:"option"},[t("h5",[e._v(e._s(e.$t("theme")))]),t("b-button",{staticClass:"button is-white",style:e.isLight,attrs:{outlined:""},on:{click:function(a){return e.setTheme("light")}}},[e._v(e._s(e.$t("light")))]),t("b-button",{staticClass:"button is-gray",style:e.isDark,attrs:{outlined:""},on:{click:function(a){return e.setTheme("dark")}}},[e._v(e._s(e.$t("dark")))])],1),t("div",{staticClass:"option"},[t("h5",[e._v(e._s(e.$t("language")))]),t("b-button",{staticClass:"button is-white",style:e.isEN,attrs:{outlined:""},on:{click:function(a){return e.setLanguage("en")}}},[e._v("EN")]),t("b-button",{staticClass:"button is-gray",style:e.isDE,attrs:{outlined:""},on:{click:function(a){return e.setLanguage("de")}}},[e._v("DE")])],1),t("div",{staticClass:"option"},[t("h5",[e._v(e._s(e.$t("dataSources")))]),e._l(e.shortcuts,function(a){return t("div",{key:a.slug,staticClass:"source flex-row"},[t("div",{staticClass:"desc flex1"},[t("p",[t("b",[e._v(e._s(a.slug))])]),t("p",[e._v(e._s(a.description))])]),t("div",{staticClass:"delete",on:{click:function(i){return e.deleteShortcut(a.slug)}}})])})],2),t("div",{staticClass:"option"},[t("h5",[e._v(e._s(e.$t("addDataSources")))]),t("add-data-source")],1)])])},Fi=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"top-panel"},[t("h4",[e._v("Settings")])])}];const ss={};var $i=G(Ri,Oi,Fi,!1,zi,"634561f2",null,null);function zi(e){for(let s in ss)this[s]=ss[s]}var Pi=function(){return $i.exports}();const Ni={messages:{en:{close:"Close panel",back:"Go back"},de:{close:"Schlie\xDFen",back:"Zur\xFCck"}}},Oe="/",ft=300;var Mi=X({name:"LayoutManager",i18n:Ni,components:Object.assign({LeftIconPanel:ri,BrowserPanel:ki,FolderBrowser:ds,ErrorPanel:mi,SettingsPanel:Pi,SplashPage:Ya,TabbedDashboardView:Aa},_t),data:()=>({panels:[],leftSections:["BrowserPanel","ErrorPanel","SettingsPanel"],panelsWithScrollbars:["TabbedDashboardView","FolderBrowser","calc-table"],zoomed:!1,isEmbedded:!1,fullScreenPanel:{x:-1,y:-1},activeLeftSection:{name:"Files",class:"BrowserPanel"},leftSectionWidth:ft,isDraggingDivider:0,dragStartWidth:0,quadrant:null,dragX:-1,dragY:-1,isDragHappening:!1,isShowingActiveSection:!1,authHandles:[]}),computed:{isMultipanel(){return this.panels.length>1?!0:this.panels[0].length>1},showLeftBar(){return this.$store.state.isShowingLeftBar},activeSectionStyle(){return this.activeLeftSection?{width:`${this.leftSectionWidth}px`}:{display:"none"}}},watch:{"$store.state.statusErrors"(){this.$store.state.statusErrors.length&&(this.activeLeftSection={name:"Issues",class:"ErrorPanel"})},$route(e,s){e.path===Oe?this.panels=[[{component:"SplashPage",key:Math.random(),props:{}}]]:(this.buildLayoutFromURL(),w.commit("resize"))}},methods:{setActiveLeftSection(e){if(!(e.section.onlyIfVisible&&!this.isShowingActiveSection)){if(this.isShowingActiveSection&&e.section.name===this.activeLeftSection.name){e.toggle&&(this.isShowingActiveSection=!1);return}if(e.section.link){window.open(e.section.link,"_blank");return}this.isShowingActiveSection=!0,this.activeLeftSection=e.section,localStorage.setItem("activeLeftSection",JSON.stringify(e.section)),this.leftSectionWidth<48&&(this.leftSectionWidth=ft)}},buildLayoutFromURL(){let e=this.$route.params.pathMatch;if(e.startsWith("/")&&(e=e.slice(1)),!e||e==="/"){this.panels=[[{component:"SplashPage",key:Math.random(),props:{}}]];return}if(e.startsWith("split/")){const j=e.substring(6);try{const U=atob(j),Q=JSON.parse(U);this.panels=Q}catch(U){console.error("PARSING SPLIT"+U),this.$router.replace("/")}return}let s=e,t="";const a=e.indexOf("/");a>-1&&(s=e.substring(0,a),t=e.substring(a+1));const i=e.substring(1+e.lastIndexOf("/")),n=i.toLocaleLowerCase();for(const j of w.state.visualizationTypes.values())if(J.isMatch(n,j.filePatterns)){if(this.panels.length===1&&this.panels[0].length===1)this.panels=[[this.panels[0][0]]];else{let U=Math.random();this.panels=[[{key:U,component:j.kebabName,title:"",description:"",props:{root:s,subfolder:t.substring(0,t.lastIndexOf("/")),yamlConfig:i,thumbnail:!1}}]]}return}let d=Math.random();this.panels.length===1&&this.panels[0].length===1&&(d=this.panels[0][0].key);const u=this.$store.state.svnProjects.filter(j=>j.slug===s);if(!u.length)throw Error("no such project");const g=u[0],k=t.startsWith("/")?t.slice(1):t,x=`${g.name}: ${k}`;this.panels=[[{key:d,title:x,component:"TabbedDashboardView",props:{root:s,xsubfolder:t}}]]},handleDragStartStop(e){this.isDragHappening=e},buildDragHighlightStyle(e,s){if(e==-1){const i=this.quadrant=="rowTop"?"1":"0",n=this.isDragHappening?"auto":"none";return{top:0,opacity:i,pointerEvents:n,backgroundColor:"#ffcc4480"}}if(e==-2){const i=this.quadrant=="rowBottom"?"1":"0",n=this.isDragHappening?"auto":"none";return{bottom:0,opacity:i,pointerEvents:n,backgroundColor:"#ffcc4480"}}if(e!==this.dragX||s!==this.dragY||!this.quadrant)return{};const t=this.quadrant.quadrant=="center"?"#079f6f80":"#4444dd90",a={opacity:1,backgroundColor:t};return Object.entries(this.quadrant).forEach(i=>a[i[0]]=`${i[1]}px`),a},stillDragging(e){const{event:s,x:t,y:a,row:i}=e;if(i){this.quadrant=i;return}this.dragX=t,this.dragY=a;const n=this.$refs[`dragContainer${t}-${a}`],u=this.$refs.tileTable.offsetLeft,g=n[0],k=(s.clientX-g.offsetLeft-u)/g.offsetWidth;(s.clientY-g.offsetTop)/g.offsetHeight;let x=8;if(k<.3)this.quadrant={quadrant:"left",width:g.offsetWidth/2-x*2,height:g.offsetHeight-x*2,marginLeft:x,marginTop:x};else if(k>.7)this.quadrant={quadrant:"right",width:g.offsetWidth/2-x*2,height:g.offsetHeight-x*2,marginLeft:g.offsetWidth/2+x,marginTop:x};else{x*=5;const j=(g.offsetWidth-x*2)*.95,U=(g.offsetHeight-x*2)*.95;this.quadrant={quadrant:"center",width:j,height:U,marginLeft:(g.offsetWidth-j)/2,marginTop:(g.offsetHeight-U)/2}}},dragEnd(){this.quadrant=null,this.dragX=-1,this.dragY=-1},onDrop(e){var n;if(!this.quadrant)return;const{event:s,x:t,y:a,row:i}=e;try{const d=(n=s.dataTransfer)==null?void 0:n.getData("bundle"),u=JSON.parse(d),k={component:u.component||"TabbedDashboardView",props:u};this.onSplit({x:t,y:a,row:i,quadrant:this.quadrant.quadrant,viz:k})}catch(d){console.warn(""+d)}this.dragEnd()},async onSplit(e){const{x:s,y:t,row:a,quadrant:i,viz:n}=e,d={component:n.component,props:n.props,title:"",description:"",key:Math.random()};if(a)switch(a){case"rowTop":this.panels.unshift([d]);break;case"rowBottom":this.panels.push([d]);break;default:console.warn("HUH?",a);break}else switch(i){case"center":this.panels[t][s]=d;break;case"left":this.panels[t].splice(s,0,d);break;case"right":this.panels[t].splice(s+1,0,d);break;default:console.warn("TOP AND BOTTOM to be added later");return}this.updateURL(),w.commit("resize")},onNavigate(e,s,t){e.component==="SplashPage"?this.panels[t][s]={component:"SplashPage",props:{},key:Math.random()}:this.panels[t][s]=Object.assign({key:Math.random()},e),this.updateURL(),this.buildLayoutFromURL()},onClose(e,s){this.panels[s][e].component=null,this.panels[s].splice(e,1),this.panels[s].length||(this.panels.length>1?this.panels.splice(s,1):this.panels[0].push({component:"SplashPage",key:Math.random(),props:{}})),this.updateURL(),w.commit("resize")},onBack(e,s){this.panels[s][e].component="TabbedDashboardView",this.panels[s][e].props.xsubfolder=this.panels[s][e].props.subfolder,delete this.panels[s][e].props.yamlConfig,this.updateURL()},getShowHeader(e){return e.component==="SplashPage"?!1:this.showLeftBar?!0:!(this.panels.length==1&&this.panels[0].length==1)},updateURL(){if(this.panels.length===1&&this.panels[0].length===1){const e=this.panels[0][0].props,s=e.root||"",t=e.xsubfolder||e.subfolder||"",a=e.yamlConfig||"";if(a.indexOf("/")>-1){const i=a.substring(a.lastIndexOf("/"));this.$router.replace(`${Oe}${s}/${t}/${i}`)}else if(a)this.$router.push(`${Oe}${s}/${t}/${a}`);else{let i=`${Oe}${s}/${t}`;e.config&&(i+=`/${e.config}`),this.$router.push(i)}}else{const e=btoa(JSON.stringify(this.panels));this.$router.push(`${Oe}split/${e}`)}},cleanProps(e){const{title:s,...t}=e;return t},dividerDragStart(e){this.isDraggingDivider=e.clientX,this.dragStartWidth=this.leftSectionWidth},dividerDragEnd(e){this.isDraggingDivider=0},dividerDragging(e){if(!this.isDraggingDivider)return;const s=e.clientX-this.isDraggingDivider;this.leftSectionWidth=Math.max(0,this.dragStartWidth+s),localStorage.setItem("leftPanelWidth",`${this.leftSectionWidth}`)},setCardTitles(e,s){typeof s=="string"?(pt.set(e,"title",s),e.description=""):(e.title=s.title,e.description=s.description||"")},async handleToggleInfoClicked(e){console.log("CARD INFO?",e)},async toggleZoom(e,s,t){console.log("ZOOM",e),this.fullScreenPanel.x>-1?this.fullScreenPanel={x:-1,y:-1}:this.fullScreenPanel={x:s,y:t}},updateDimensions(e){},getTileStyle(e){return{overflow:this.panelsWithScrollbars.includes(e.component)?"auto":"hidden"}},getContainerStyle(e,s,t){let a={padding:this.isMultipanel?"5px 5px":"0"};return this.fullScreenPanel.x==-1||(this.fullScreenPanel.x!==s?a.display="none":a={position:"absolute",top:0,bottom:0,left:0,right:0,margin:"5px 5px"}),a}},mounted(){"embed"in this.$route.query&&(this.isEmbedded=!0);const e=localStorage.getItem("leftPanelWidth");this.leftSectionWidth=e==null?ft:parseInt(e),this.leftSectionWidth<0&&(this.leftSectionWidth=2);const s=localStorage.getItem("activeLeftSection");if(s)try{this.activeLeftSection=JSON.parse(s)}catch{this.activeLeftSection={name:"Files",class:"BrowserPanel"}}else this.activeLeftSection={name:"Files",class:"BrowserPanel"};this.buildLayoutFromURL()}}),Ii=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{style:{userSelect:e.isDraggingDivider?"none":"unset"},attrs:{id:"split-screen"},on:{mousemove:e.dividerDragging,mouseup:e.dividerDragEnd}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.showLeftBar,expression:"showLeftBar"}],staticClass:"left-panel"},[t("left-icon-panel",{attrs:{activeSection:e.activeLeftSection.name},on:{activate:function(a){return e.setActiveLeftSection({section:a,toggle:!0})}}}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.isShowingActiveSection,expression:"isShowingActiveSection"}],staticClass:"left-panel-active-section",style:e.activeSectionStyle},e._l(e.leftSections,function(a){return t(a,{directives:[{name:"show",rawName:"v-show",value:a==e.activeLeftSection.class,expression:"section==activeLeftSection.class"}],key:a,tag:"component",on:{navigate:function(i){return e.onNavigate(i,0,0)},activate:function(i){return e.setActiveLeftSection({section:i,toggle:!1})},isDragging:e.handleDragStartStop}})}),1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.activeLeftSection,expression:"activeLeftSection"}],staticClass:"left-panel-divider",on:{mousedown:e.dividerDragStart,mouseup:e.dividerDragEnd,mousemove:function(a){return a.stopPropagation(),e.dividerDragging.apply(null,arguments)}}})],1),t("div",{ref:"tileTable",staticClass:"table-of-tiles"},[e.authHandles.length?t("div",{staticClass:"authorization-strip"},e._l(e.authHandles,function(a){return t("div",{staticClass:"auth-row"},[t("p",{staticClass:"flex1"},[e._v(e._s(""+a))]),t("b-button",[e._v("hello")])],1)}),0):e._e(),t("div",{staticClass:"row-drop-target",style:e.buildDragHighlightStyle(-1,-1),on:{drop:function(a){return e.onDrop({event:a,row:"rowTop"})},dragover:[function(a){return e.stillDragging({event:a,row:"rowTop"})},function(a){a.preventDefault()}],dragenter:function(a){a.preventDefault()},dragleave:e.dragEnd}}),e._l(e.panels,function(a,i){return t("div",{directives:[{name:"show",rawName:"v-show",value:e.fullScreenPanel.y==-1||e.fullScreenPanel.y==i,expression:"fullScreenPanel.y == -1 || fullScreenPanel.y == y"}],key:i,staticClass:"tile-row"},e._l(a,function(n,d){return t("div",{key:n.key,ref:`dragContainer${d}-${i}`,refInFor:!0,staticClass:"drag-container",style:e.getContainerStyle(n,d,i),on:{drop:function(u){return e.onDrop({event:u,x:d,y:i})},dragover:[function(u){u.preventDefault()},function(u){return e.stillDragging({event:u,x:d,y:i})}],dragenter:function(u){u.preventDefault()},dragleave:e.dragEnd}},[e.getShowHeader(n)?t("div",{staticClass:"tile-header flex-row"},[t("div",{staticClass:"tile-labels"},[t("h3",{style:{textAlign:e.isMultipanel?"left":"center"}},[e._v(e._s(n.title))]),n.description?t("p",[e._v(e._s(n.description))]):e._e()]),t("div",{staticClass:"tile-buttons"},[n.info?t("div",{staticClass:"nav-button is-small is-white",on:{click:function(u){return e.handleToggleInfoClicked(n)}}},[t("i",{staticClass:"fa fa-info-circle"})]):e._e(),t("div",{directives:[{name:"show",rawName:"v-show",value:e.panels.length>1||e.panels[0].length>1,expression:"panels.length > 1 || panels[0].length > 1"}],staticClass:"nav-button is-small is-white",attrs:{title:e.fullScreenPanel.x>-1?"Restore":"Enlarge"},on:{click:function(u){return e.toggleZoom(n,d,i)}}},[t("i",{staticClass:"fa fa-expand"})]),t("div",{staticClass:"nav-button is-small is-white",attrs:{title:"Close"},on:{click:function(u){return e.onClose(d,i)}}},[t("i",{staticClass:"fa fa-times-circle"})])])]):e._e(),t(n.component,e._b({tag:"component",staticClass:"map-tile",style:e.getTileStyle(n),on:{navigate:function(u){return e.onNavigate(u,d,i)},title:function(u){return e.setCardTitles(n,u)},activate:function(u){return e.setActiveLeftSection({section:u,toggle:!0})}}},"component",e.cleanProps(n.props),!1)),e.isDragHappening?t("div",{staticClass:"drag-highlight",style:e.buildDragHighlightStyle(d,i)}):e._e()],1)}),0)}),e.isDragHappening?t("div",{staticClass:"row-drop-target",style:e.buildDragHighlightStyle(-2,-2),on:{drop:function(a){return e.onDrop({event:a,row:"rowBottom"})},dragover:[function(a){return e.stillDragging({event:a,row:"rowBottom"})},function(a){a.preventDefault()}],dragenter:function(a){a.preventDefault()},dragleave:e.dragEnd}}):e._e()],2)])},Hi=[];const as={};var ji=G(Mi,Ii,Hi,!1,Wi,"33272ba0",null,null);function Wi(e){for(let s in as)this[s]=as[s]}var er=function(){return ji.exports}();export{er as default};
//# sourceMappingURL=LayoutManager.f37388f4.js.map
