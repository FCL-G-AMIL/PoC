{"version":3,"file":"XyHexagons.0dac629d.js","sources":["../../node_modules/@deck.gl/layers/dist/esm/column-layer/column-geometry.js","../../node_modules/@deck.gl/layers/dist/esm/column-layer/column-layer-vertex.glsl.js","../../node_modules/@deck.gl/layers/dist/esm/column-layer/column-layer-fragment.glsl.js","../../node_modules/@deck.gl/layers/dist/esm/column-layer/column-layer.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/utils/aggregation-operation-utils.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/utils/color-utils.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/utils/prop-utils.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/aggregation-layer.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/utils/scale-utils.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/utils/bin-sorter.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/utils/cpu-aggregator.js","../../node_modules/d3-hexbin/src/hexbin.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/hexagon-layer/hexagon-aggregator.js","../../node_modules/@deck.gl/aggregation-layers/dist/esm/hexagon-layer/hexagon-layer.js","../../src/plugins/xy-hexagons/XyHexLayer.tsx","../../src/plugins/xy-hexagons/XyHexagons.vue","../../src/plugins/xy-hexagons/XyHexagons.vue?vue&type=template&lang.js"],"sourcesContent":["import { log } from '@deck.gl/core';\nimport { Geometry, uid } from '@luma.gl/core';\nimport { modifyPolygonWindingDirection, WINDING } from '@math.gl/polygon';\nexport default class ColumnGeometry extends Geometry {\n  constructor(props) {\n    const {\n      id = uid('column-geometry')\n    } = props;\n    const {\n      indices,\n      attributes\n    } = tesselateColumn(props);\n    super({ ...props,\n      id,\n      indices,\n      attributes\n    });\n  }\n\n}\n\nfunction tesselateColumn(props) {\n  const {\n    radius,\n    height = 1,\n    nradial = 10\n  } = props;\n  let {\n    vertices\n  } = props;\n\n  if (vertices) {\n    log.assert(vertices.length >= nradial);\n    vertices = vertices.flatMap(v => [v[0], v[1]]);\n    modifyPolygonWindingDirection(vertices, WINDING.COUNTER_CLOCKWISE);\n  }\n\n  const isExtruded = height > 0;\n  const vertsAroundEdge = nradial + 1;\n  const numVertices = isExtruded ? vertsAroundEdge * 3 + 1 : nradial;\n  const stepAngle = Math.PI * 2 / nradial;\n  const indices = new Uint16Array(isExtruded ? nradial * 3 * 2 : 0);\n  const positions = new Float32Array(numVertices * 3);\n  const normals = new Float32Array(numVertices * 3);\n  let i = 0;\n\n  if (isExtruded) {\n    for (let j = 0; j < vertsAroundEdge; j++) {\n      const a = j * stepAngle;\n      const vertexIndex = j % nradial;\n      const sin = Math.sin(a);\n      const cos = Math.cos(a);\n\n      for (let k = 0; k < 2; k++) {\n        positions[i + 0] = vertices ? vertices[vertexIndex * 2] : cos * radius;\n        positions[i + 1] = vertices ? vertices[vertexIndex * 2 + 1] : sin * radius;\n        positions[i + 2] = (1 / 2 - k) * height;\n        normals[i + 0] = vertices ? vertices[vertexIndex * 2] : cos;\n        normals[i + 1] = vertices ? vertices[vertexIndex * 2 + 1] : sin;\n        i += 3;\n      }\n    }\n\n    positions[i + 0] = positions[i - 3];\n    positions[i + 1] = positions[i - 2];\n    positions[i + 2] = positions[i - 1];\n    i += 3;\n  }\n\n  for (let j = isExtruded ? 0 : 1; j < vertsAroundEdge; j++) {\n    const v = Math.floor(j / 2) * Math.sign(0.5 - j % 2);\n    const a = v * stepAngle;\n    const vertexIndex = (v + nradial) % nradial;\n    const sin = Math.sin(a);\n    const cos = Math.cos(a);\n    positions[i + 0] = vertices ? vertices[vertexIndex * 2] : cos * radius;\n    positions[i + 1] = vertices ? vertices[vertexIndex * 2 + 1] : sin * radius;\n    positions[i + 2] = height / 2;\n    normals[i + 2] = 1;\n    i += 3;\n  }\n\n  if (isExtruded) {\n    let index = 0;\n\n    for (let j = 0; j < nradial; j++) {\n      indices[index++] = j * 2 + 0;\n      indices[index++] = j * 2 + 2;\n      indices[index++] = j * 2 + 0;\n      indices[index++] = j * 2 + 1;\n      indices[index++] = j * 2 + 1;\n      indices[index++] = j * 2 + 3;\n    }\n  }\n\n  return {\n    indices,\n    attributes: {\n      POSITION: {\n        size: 3,\n        value: positions\n      },\n      NORMAL: {\n        size: 3,\n        value: normals\n      }\n    }\n  };\n}\n//# sourceMappingURL=column-geometry.js.map","export default \"#version 300 es\\n\\n#define SHADER_NAME column-layer-vertex-shader\\n\\nin vec3 positions;\\nin vec3 normals;\\n\\nin vec3 instancePositions;\\nin float instanceElevations;\\nin vec3 instancePositions64Low;\\nin vec4 instanceFillColors;\\nin vec4 instanceLineColors;\\nin float instanceStrokeWidths;\\n\\nin vec3 instancePickingColors;\\nuniform float opacity;\\nuniform float radius;\\nuniform float angle;\\nuniform vec2 offset;\\nuniform bool extruded;\\nuniform bool stroked;\\nuniform bool isStroke;\\nuniform float coverage;\\nuniform float elevationScale;\\nuniform float edgeDistance;\\nuniform float widthScale;\\nuniform float widthMinPixels;\\nuniform float widthMaxPixels;\\nuniform int radiusUnits;\\nuniform int widthUnits;\\nout vec4 vColor;\\n#ifdef FLAT_SHADING\\nout vec4 position_commonspace;\\n#endif\\n\\nvoid main(void) {\\n  geometry.worldPosition = instancePositions;\\n\\n  vec4 color = isStroke ? instanceLineColors : instanceFillColors;\\n  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\\n  float elevation = 0.0;\\n  float strokeOffsetRatio = 1.0;\\n\\n  if (extruded) {\\n    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;\\n  } else if (stroked) {\\n    float widthPixels = clamp(\\n      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),\\n      widthMinPixels, widthMaxPixels) / 2.0;\\n    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);\\n    if (isStroke) {\\n      strokeOffsetRatio -= sign(positions.z) * halfOffset;\\n    } else {\\n      strokeOffsetRatio -= halfOffset;\\n    }\\n  }\\n  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);\\n  float dotRadius = radius * coverage * shouldRender;\\n\\n  geometry.pickingColor = instancePickingColors;\\n  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);\\n  vec3 centroidPosition64Low = instancePositions64Low;\\n  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;\\n  if (radiusUnits == UNIT_METERS) {\\n    offset = project_size(offset);\\n  }\\n  vec3 pos = vec3(offset, 0.);\\n  DECKGL_FILTER_SIZE(pos, geometry);\\n\\n  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);\\n  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));\\n  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);\\n  if (extruded && !isStroke) {\\n#ifdef FLAT_SHADING\\n    position_commonspace = geometry.position;\\n    vColor = vec4(color.rgb, color.a * opacity);\\n#else\\n    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);\\n    vColor = vec4(lightColor, color.a * opacity);\\n#endif\\n  } else {\\n    vColor = vec4(color.rgb, color.a * opacity);\\n  }\\n  DECKGL_FILTER_COLOR(vColor, geometry);\\n}\\n\";\n//# sourceMappingURL=column-layer-vertex.glsl.js.map","export default \"#version 300 es\\n#define SHADER_NAME column-layer-fragment-shader\\n\\nprecision highp float;\\n\\nuniform vec3 project_uCameraPosition;\\nuniform bool extruded;\\nuniform bool isStroke;\\n\\nout vec4 fragColor;\\n\\nin vec4 vColor;\\n#ifdef FLAT_SHADING\\nin vec4 position_commonspace;\\n#endif\\n\\nvoid main(void) {\\n  fragColor = vColor;\\n#ifdef FLAT_SHADING\\n  if (extruded && !isStroke && !picking_uActive) {\\n    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));\\n    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);\\n  }\\n#endif\\n  DECKGL_FILTER_COLOR(fragColor, geometry);\\n}\\n\";\n//# sourceMappingURL=column-layer-fragment.glsl.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { Layer, project32, gouraudLighting, phongLighting, picking, UNIT } from '@deck.gl/core';\nimport { Model, isWebGL2, hasFeature, FEATURES } from '@luma.gl/core';\nimport ColumnGeometry from './column-geometry';\nimport vs from './column-layer-vertex.glsl';\nimport fs from './column-layer-fragment.glsl';\nconst DEFAULT_COLOR = [0, 0, 0, 255];\nconst defaultProps = {\n  diskResolution: {\n    type: 'number',\n    min: 4,\n    value: 20\n  },\n  vertices: null,\n  radius: {\n    type: 'number',\n    min: 0,\n    value: 1000\n  },\n  angle: {\n    type: 'number',\n    value: 0\n  },\n  offset: {\n    type: 'array',\n    value: [0, 0]\n  },\n  coverage: {\n    type: 'number',\n    min: 0,\n    max: 1,\n    value: 1\n  },\n  elevationScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  radiusUnits: 'meters',\n  lineWidthUnits: 'meters',\n  lineWidthScale: 1,\n  lineWidthMinPixels: 0,\n  lineWidthMaxPixels: Number.MAX_SAFE_INTEGER,\n  extruded: true,\n  wireframe: false,\n  filled: true,\n  stroked: false,\n  getPosition: {\n    type: 'accessor',\n    value: x => x.position\n  },\n  getFillColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getLineColor: {\n    type: 'accessor',\n    value: DEFAULT_COLOR\n  },\n  getLineWidth: {\n    type: 'accessor',\n    value: 1\n  },\n  getElevation: {\n    type: 'accessor',\n    value: 1000\n  },\n  material: true,\n  getColor: {\n    deprecatedFor: ['getFillColor', 'getLineColor']\n  }\n};\nexport default class ColumnLayer extends Layer {\n  getShaders() {\n    const {\n      gl\n    } = this.context;\n    const transpileToGLSL100 = !isWebGL2(gl);\n    const defines = {};\n    const useDerivatives = this.props.flatShading && hasFeature(gl, FEATURES.GLSL_DERIVATIVES);\n\n    if (useDerivatives) {\n      defines.FLAT_SHADING = 1;\n    }\n\n    return super.getShaders({\n      vs,\n      fs,\n      defines,\n      transpileToGLSL100,\n      modules: [project32, useDerivatives ? phongLighting : gouraudLighting, picking]\n    });\n  }\n\n  initializeState() {\n    const attributeManager = this.getAttributeManager();\n    attributeManager.addInstanced({\n      instancePositions: {\n        size: 3,\n        type: 5130,\n        fp64: this.use64bitPositions(),\n        transition: true,\n        accessor: 'getPosition'\n      },\n      instanceElevations: {\n        size: 1,\n        transition: true,\n        accessor: 'getElevation'\n      },\n      instanceFillColors: {\n        size: this.props.colorFormat.length,\n        type: 5121,\n        normalized: true,\n        transition: true,\n        accessor: 'getFillColor',\n        defaultValue: DEFAULT_COLOR\n      },\n      instanceLineColors: {\n        size: this.props.colorFormat.length,\n        type: 5121,\n        normalized: true,\n        transition: true,\n        accessor: 'getLineColor',\n        defaultValue: DEFAULT_COLOR\n      },\n      instanceStrokeWidths: {\n        size: 1,\n        accessor: 'getLineWidth',\n        transition: true\n      }\n    });\n  }\n\n  updateState(params) {\n    super.updateState(params);\n    const {\n      props,\n      oldProps,\n      changeFlags\n    } = params;\n    const regenerateModels = changeFlags.extensionsChanged || props.flatShading !== oldProps.flatShading;\n\n    if (regenerateModels) {\n      var _this$state$model;\n\n      const {\n        gl\n      } = this.context;\n      (_this$state$model = this.state.model) === null || _this$state$model === void 0 ? void 0 : _this$state$model.delete();\n      this.state.model = this._getModel(gl);\n      this.getAttributeManager().invalidateAll();\n    }\n\n    if (regenerateModels || props.diskResolution !== oldProps.diskResolution || props.vertices !== oldProps.vertices || (props.extruded || props.stroked) !== (oldProps.extruded || oldProps.stroked)) {\n      this._updateGeometry(props);\n    }\n  }\n\n  getGeometry(diskResolution, vertices, hasThinkness) {\n    const geometry = new ColumnGeometry({\n      radius: 1,\n      height: hasThinkness ? 2 : 0,\n      vertices,\n      nradial: diskResolution\n    });\n    let meanVertexDistance = 0;\n\n    if (vertices) {\n      for (let i = 0; i < diskResolution; i++) {\n        const p = vertices[i];\n        const d = Math.sqrt(p[0] * p[0] + p[1] * p[1]);\n        meanVertexDistance += d / diskResolution;\n      }\n    } else {\n      meanVertexDistance = 1;\n    }\n\n    this.setState({\n      edgeDistance: Math.cos(Math.PI / diskResolution) * meanVertexDistance\n    });\n    return geometry;\n  }\n\n  _getModel(gl) {\n    return new Model(gl, { ...this.getShaders(),\n      id: this.props.id,\n      isInstanced: true\n    });\n  }\n\n  _updateGeometry({\n    diskResolution,\n    vertices,\n    extruded,\n    stroked\n  }) {\n    const geometry = this.getGeometry(diskResolution, vertices, extruded || stroked);\n    this.setState({\n      fillVertexCount: geometry.attributes.POSITION.value.length / 3,\n      wireframeVertexCount: geometry.indices.value.length\n    });\n    this.state.model.setProps({\n      geometry\n    });\n  }\n\n  draw({\n    uniforms\n  }) {\n    const {\n      lineWidthUnits,\n      lineWidthScale,\n      lineWidthMinPixels,\n      lineWidthMaxPixels,\n      radiusUnits,\n      elevationScale,\n      extruded,\n      filled,\n      stroked,\n      wireframe,\n      offset,\n      coverage,\n      radius,\n      angle\n    } = this.props;\n    const {\n      model,\n      fillVertexCount,\n      wireframeVertexCount,\n      edgeDistance\n    } = this.state;\n    model.setUniforms(uniforms).setUniforms({\n      radius,\n      angle: angle / 180 * Math.PI,\n      offset,\n      extruded,\n      stroked,\n      coverage,\n      elevationScale,\n      edgeDistance,\n      radiusUnits: UNIT[radiusUnits],\n      widthUnits: UNIT[lineWidthUnits],\n      widthScale: lineWidthScale,\n      widthMinPixels: lineWidthMinPixels,\n      widthMaxPixels: lineWidthMaxPixels\n    });\n\n    if (extruded && wireframe) {\n      model.setProps({\n        isIndexed: true\n      });\n      model.setVertexCount(wireframeVertexCount).setDrawMode(1).setUniforms({\n        isStroke: true\n      }).draw();\n    }\n\n    if (filled) {\n      model.setProps({\n        isIndexed: false\n      });\n      model.setVertexCount(fillVertexCount).setDrawMode(5).setUniforms({\n        isStroke: false\n      }).draw();\n    }\n\n    if (!extruded && stroked) {\n      model.setProps({\n        isIndexed: false\n      });\n      model.setVertexCount(fillVertexCount * 2 / 3).setDrawMode(5).setUniforms({\n        isStroke: true\n      }).draw();\n    }\n  }\n\n}\n\n_defineProperty(ColumnLayer, \"layerName\", 'ColumnLayer');\n\n_defineProperty(ColumnLayer, \"defaultProps\", defaultProps);\n//# sourceMappingURL=column-layer.js.map","export const AGGREGATION_OPERATION = {\n  SUM: 1,\n  MEAN: 2,\n  MIN: 3,\n  MAX: 4\n};\n\nfunction sumReducer(accu, cur) {\n  return accu + cur;\n}\n\nfunction maxReducer(accu, cur) {\n  return cur > accu ? cur : accu;\n}\n\nfunction minReducer(accu, cur) {\n  return cur < accu ? cur : accu;\n}\n\nexport function getMean(pts, accessor) {\n  if (Number.isFinite(accessor)) {\n    return pts.length ? accessor : null;\n  }\n\n  const filtered = pts.map(accessor).filter(Number.isFinite);\n  return filtered.length ? filtered.reduce(sumReducer, 0) / filtered.length : null;\n}\nexport function getSum(pts, accessor) {\n  if (Number.isFinite(accessor)) {\n    return pts.length ? pts.length * accessor : null;\n  }\n\n  const filtered = pts.map(accessor).filter(Number.isFinite);\n  return filtered.length ? filtered.reduce(sumReducer, 0) : null;\n}\nexport function getMax(pts, accessor) {\n  if (Number.isFinite(accessor)) {\n    return pts.length ? accessor : null;\n  }\n\n  const filtered = pts.map(accessor).filter(Number.isFinite);\n  return filtered.length ? filtered.reduce(maxReducer, -Infinity) : null;\n}\nexport function getMin(pts, accessor) {\n  if (Number.isFinite(accessor)) {\n    return pts.length ? accessor : null;\n  }\n\n  const filtered = pts.map(accessor).filter(Number.isFinite);\n  return filtered.length ? filtered.reduce(minReducer, Infinity) : null;\n}\nexport function getValueFunc(aggregation, accessor, context) {\n  const op = AGGREGATION_OPERATION[aggregation] || AGGREGATION_OPERATION.SUM;\n  accessor = wrapAccessor(accessor, context);\n\n  switch (op) {\n    case AGGREGATION_OPERATION.MIN:\n      return pts => getMin(pts, accessor);\n\n    case AGGREGATION_OPERATION.SUM:\n      return pts => getSum(pts, accessor);\n\n    case AGGREGATION_OPERATION.MEAN:\n      return pts => getMean(pts, accessor);\n\n    case AGGREGATION_OPERATION.MAX:\n      return pts => getMax(pts, accessor);\n\n    default:\n      return null;\n  }\n}\n\nfunction wrapAccessor(accessor, context = {}) {\n  if (Number.isFinite(accessor)) {\n    return accessor;\n  }\n\n  return pt => {\n    context.index = pt.index;\n    return accessor(pt.source, context);\n  };\n}\n\nexport function wrapGetValueFunc(getValue, context = {}) {\n  return pts => {\n    context.indices = pts.map(pt => pt.index);\n    return getValue(pts.map(pt => pt.source), context);\n  };\n}\n//# sourceMappingURL=aggregation-operation-utils.js.map","export const defaultColorRange = [[255, 255, 178], [254, 217, 118], [254, 178, 76], [253, 141, 60], [240, 59, 32], [189, 0, 38]];\nexport function colorRangeToFlatArray(colorRange, normalize = false, ArrayType = Float32Array) {\n  let flatArray;\n\n  if (Number.isFinite(colorRange[0])) {\n    flatArray = new ArrayType(colorRange);\n  } else {\n    flatArray = new ArrayType(colorRange.length * 4);\n    let index = 0;\n\n    for (let i = 0; i < colorRange.length; i++) {\n      const color = colorRange[i];\n      flatArray[index++] = color[0];\n      flatArray[index++] = color[1];\n      flatArray[index++] = color[2];\n      flatArray[index++] = Number.isFinite(color[3]) ? color[3] : 255;\n    }\n  }\n\n  if (normalize) {\n    for (let i = 0; i < flatArray.length; i++) {\n      flatArray[i] /= 255;\n    }\n  }\n\n  return flatArray;\n}\n//# sourceMappingURL=color-utils.js.map","export function filterProps(props, filterKeys) {\n  const filteredProps = {};\n\n  for (const key in props) {\n    if (!filterKeys.includes(key)) {\n      filteredProps[key] = props[key];\n    }\n  }\n\n  return filteredProps;\n}\n//# sourceMappingURL=prop-utils.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { CompositeLayer, AttributeManager, _compareProps as compareProps } from '@deck.gl/core';\nimport { cssToDeviceRatio } from '@luma.gl/core';\nimport { filterProps } from './utils/prop-utils';\nexport default class AggregationLayer extends CompositeLayer {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", void 0);\n  }\n\n  initializeAggregationLayer(dimensions) {\n    super.initializeState(this.context);\n    this.setState({\n      ignoreProps: filterProps(this.constructor._propTypes, dimensions.data.props),\n      dimensions\n    });\n  }\n\n  updateState(opts) {\n    super.updateState(opts);\n    const {\n      changeFlags\n    } = opts;\n\n    if (changeFlags.extensionsChanged) {\n      const shaders = this.getShaders({});\n\n      if (shaders && shaders.defines) {\n        shaders.defines.NON_INSTANCED_MODEL = 1;\n      }\n\n      this.updateShaders(shaders);\n    }\n\n    this._updateAttributes();\n  }\n\n  updateAttributes(changedAttributes) {\n    this.setState({\n      changedAttributes\n    });\n  }\n\n  getAttributes() {\n    return this.getAttributeManager().getShaderAttributes();\n  }\n\n  getModuleSettings() {\n    const {\n      viewport,\n      mousePosition,\n      gl\n    } = this.context;\n    const moduleSettings = Object.assign(Object.create(this.props), {\n      viewport,\n      mousePosition,\n      pickingActive: 0,\n      devicePixelRatio: cssToDeviceRatio(gl)\n    });\n    return moduleSettings;\n  }\n\n  updateShaders(shaders) {}\n\n  isAggregationDirty(updateOpts, params = {}) {\n    const {\n      props,\n      oldProps,\n      changeFlags\n    } = updateOpts;\n    const {\n      compareAll = false,\n      dimension\n    } = params;\n    const {\n      ignoreProps\n    } = this.state;\n    const {\n      props: dataProps,\n      accessors = []\n    } = dimension;\n    const {\n      updateTriggersChanged\n    } = changeFlags;\n\n    if (changeFlags.dataChanged) {\n      return true;\n    }\n\n    if (updateTriggersChanged) {\n      if (updateTriggersChanged.all) {\n        return true;\n      }\n\n      for (const accessor of accessors) {\n        if (updateTriggersChanged[accessor]) {\n          return true;\n        }\n      }\n    }\n\n    if (compareAll) {\n      if (changeFlags.extensionsChanged) {\n        return true;\n      }\n\n      return compareProps({\n        oldProps,\n        newProps: props,\n        ignoreProps,\n        propTypes: this.constructor._propTypes\n      });\n    }\n\n    for (const name of dataProps) {\n      if (props[name] !== oldProps[name]) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  isAttributeChanged(name) {\n    const {\n      changedAttributes\n    } = this.state;\n\n    if (!name) {\n      return !isObjectEmpty(changedAttributes);\n    }\n\n    return changedAttributes && changedAttributes[name] !== undefined;\n  }\n\n  _getAttributeManager() {\n    return new AttributeManager(this.context.gl, {\n      id: this.props.id,\n      stats: this.context.stats\n    });\n  }\n\n}\n\n_defineProperty(AggregationLayer, \"layerName\", 'AggregationLayer');\n\nfunction isObjectEmpty(obj) {\n  let isEmpty = true;\n\n  for (const key in obj) {\n    isEmpty = false;\n    break;\n  }\n\n  return isEmpty;\n}\n//# sourceMappingURL=aggregation-layer.js.map","import { log } from '@deck.gl/core';\nexport function getScale(domain, range, scaleFunction) {\n  const scale = scaleFunction;\n\n  scale.domain = () => domain;\n\n  scale.range = () => range;\n\n  return scale;\n}\nexport function getQuantizeScale(domain, range) {\n  const scaleFunction = value => quantizeScale(domain, range, value);\n\n  return getScale(domain, range, scaleFunction);\n}\nexport function getLinearScale(domain, range) {\n  const scaleFunction = value => linearScale(domain, range, value);\n\n  return getScale(domain, range, scaleFunction);\n}\nexport function getQuantileScale(domain, range) {\n  const sortedDomain = domain.sort(ascending);\n  let i = 0;\n  const n = Math.max(1, range.length);\n  const thresholds = new Array(n - 1);\n\n  while (++i < n) {\n    thresholds[i - 1] = threshold(sortedDomain, i / n);\n  }\n\n  const scaleFunction = value => thresholdsScale(thresholds, range, value);\n\n  scaleFunction.thresholds = () => thresholds;\n\n  return getScale(domain, range, scaleFunction);\n}\n\nfunction ascending(a, b) {\n  return a - b;\n}\n\nfunction threshold(domain, fraction) {\n  const domainLength = domain.length;\n\n  if (fraction <= 0 || domainLength < 2) {\n    return domain[0];\n  }\n\n  if (fraction >= 1) {\n    return domain[domainLength - 1];\n  }\n\n  const domainFraction = (domainLength - 1) * fraction;\n  const lowIndex = Math.floor(domainFraction);\n  const low = domain[lowIndex];\n  const high = domain[lowIndex + 1];\n  return low + (high - low) * (domainFraction - lowIndex);\n}\n\nfunction bisectRight(a, x) {\n  let lo = 0;\n  let hi = a.length;\n\n  while (lo < hi) {\n    const mid = lo + hi >>> 1;\n\n    if (ascending(a[mid], x) > 0) {\n      hi = mid;\n    } else {\n      lo = mid + 1;\n    }\n  }\n\n  return lo;\n}\n\nfunction thresholdsScale(thresholds, range, value) {\n  return range[bisectRight(thresholds, value)];\n}\n\nfunction ordinalScale(domain, domainMap, range, value) {\n  const key = \"\".concat(value);\n  let d = domainMap.get(key);\n\n  if (d === undefined) {\n    d = domain.push(value);\n    domainMap.set(key, d);\n  }\n\n  return range[(d - 1) % range.length];\n}\n\nexport function getOrdinalScale(domain, range) {\n  const domainMap = new Map();\n  const uniqueDomain = [];\n\n  for (const d of domain) {\n    const key = \"\".concat(d);\n\n    if (!domainMap.has(key)) {\n      domainMap.set(key, uniqueDomain.push(d));\n    }\n  }\n\n  const scaleFunction = value => ordinalScale(uniqueDomain, domainMap, range, value);\n\n  return getScale(domain, range, scaleFunction);\n}\nexport function quantizeScale(domain, range, value) {\n  const domainRange = domain[1] - domain[0];\n\n  if (domainRange <= 0) {\n    log.warn('quantizeScale: invalid domain, returning range[0]')();\n    return range[0];\n  }\n\n  const step = domainRange / range.length;\n  const idx = Math.floor((value - domain[0]) / step);\n  const clampIdx = Math.max(Math.min(idx, range.length - 1), 0);\n  return range[clampIdx];\n}\nexport function linearScale(domain, range, value) {\n  return (value - domain[0]) / (domain[1] - domain[0]) * (range[1] - range[0]) + range[0];\n}\n\nfunction notNullOrUndefined(d) {\n  return d !== undefined && d !== null;\n}\n\nexport function unique(values) {\n  const results = [];\n  values.forEach(v => {\n    if (!results.includes(v) && notNullOrUndefined(v)) {\n      results.push(v);\n    }\n  });\n  return results;\n}\n\nfunction getTruthyValues(data, valueAccessor) {\n  const values = typeof valueAccessor === 'function' ? data.map(valueAccessor) : data;\n  return values.filter(notNullOrUndefined);\n}\n\nexport function getLinearDomain(data, valueAccessor) {\n  const sorted = getTruthyValues(data, valueAccessor).sort();\n  return sorted.length ? [sorted[0], sorted[sorted.length - 1]] : [0, 0];\n}\nexport function getQuantileDomain(data, valueAccessor) {\n  return getTruthyValues(data, valueAccessor);\n}\nexport function getOrdinalDomain(data, valueAccessor) {\n  return unique(getTruthyValues(data, valueAccessor));\n}\nexport function getScaleDomain(scaleType, data, valueAccessor) {\n  switch (scaleType) {\n    case 'quantize':\n    case 'linear':\n      return getLinearDomain(data, valueAccessor);\n\n    case 'quantile':\n      return getQuantileDomain(data, valueAccessor);\n\n    case 'ordinal':\n      return getOrdinalDomain(data, valueAccessor);\n\n    default:\n      return getLinearDomain(data, valueAccessor);\n  }\n}\nexport function clamp(value, min, max) {\n  return Math.max(min, Math.min(max, value));\n}\nexport function getScaleFunctionByScaleType(scaleType) {\n  switch (scaleType) {\n    case 'quantize':\n      return getQuantizeScale;\n\n    case 'linear':\n      return getLinearScale;\n\n    case 'quantile':\n      return getQuantileScale;\n\n    case 'ordinal':\n      return getOrdinalScale;\n\n    default:\n      return getQuantizeScale;\n  }\n}\n//# sourceMappingURL=scale-utils.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\n\nconst defaultGetValue = points => points.length;\n\nimport { clamp, getQuantileDomain, getOrdinalDomain } from './scale-utils';\nconst MAX_32_BIT_FLOAT = 3.402823466e38;\n\nconst defaultGetPoints = bin => bin.points;\n\nconst defaultGetIndex = bin => bin.index;\n\nconst ascending = (a, b) => a < b ? -1 : a > b ? 1 : a >= b ? 0 : NaN;\n\nconst defaultProps = {\n  getValue: defaultGetValue,\n  getPoints: defaultGetPoints,\n  getIndex: defaultGetIndex,\n  filterData: null\n};\nexport default class BinSorter {\n  constructor(bins = [], props = defaultProps) {\n    _defineProperty(this, \"maxCount\", void 0);\n\n    _defineProperty(this, \"maxValue\", void 0);\n\n    _defineProperty(this, \"minValue\", void 0);\n\n    _defineProperty(this, \"totalCount\", void 0);\n\n    _defineProperty(this, \"aggregatedBins\", void 0);\n\n    _defineProperty(this, \"sortedBins\", void 0);\n\n    _defineProperty(this, \"binMap\", void 0);\n\n    this.aggregatedBins = this.getAggregatedBins(bins, props);\n\n    this._updateMinMaxValues();\n\n    this.binMap = this.getBinMap();\n  }\n\n  getAggregatedBins(bins, props) {\n    const {\n      getValue = defaultGetValue,\n      getPoints = defaultGetPoints,\n      getIndex = defaultGetIndex,\n      filterData\n    } = props;\n    const hasFilter = typeof filterData === 'function';\n    const binCount = bins.length;\n    const aggregatedBins = [];\n    let index = 0;\n\n    for (let binIndex = 0; binIndex < binCount; binIndex++) {\n      const bin = bins[binIndex];\n      const points = getPoints(bin);\n      const i = getIndex(bin);\n      const filteredPoints = hasFilter ? points.filter(filterData) : points;\n      bin.filteredPoints = hasFilter ? filteredPoints : null;\n      const value = filteredPoints.length ? getValue(filteredPoints) : null;\n\n      if (value !== null && value !== undefined) {\n        aggregatedBins[index] = {\n          i: Number.isFinite(i) ? i : binIndex,\n          value,\n          counts: filteredPoints.length\n        };\n        index++;\n      }\n    }\n\n    return aggregatedBins;\n  }\n\n  _percentileToIndex(percentileRange) {\n    const len = this.sortedBins.length;\n\n    if (len < 2) {\n      return [0, 0];\n    }\n\n    const [lower, upper] = percentileRange.map(n => clamp(n, 0, 100));\n    const lowerIdx = Math.ceil(lower / 100 * (len - 1));\n    const upperIdx = Math.floor(upper / 100 * (len - 1));\n    return [lowerIdx, upperIdx];\n  }\n\n  getBinMap() {\n    const binMap = {};\n\n    for (const bin of this.aggregatedBins) {\n      binMap[bin.i] = bin;\n    }\n\n    return binMap;\n  }\n\n  _updateMinMaxValues() {\n    let maxCount = 0;\n    let maxValue = 0;\n    let minValue = MAX_32_BIT_FLOAT;\n    let totalCount = 0;\n\n    for (const x of this.aggregatedBins) {\n      maxCount = maxCount > x.counts ? maxCount : x.counts;\n      maxValue = maxValue > x.value ? maxValue : x.value;\n      minValue = minValue < x.value ? minValue : x.value;\n      totalCount += x.counts;\n    }\n\n    this.maxCount = maxCount;\n    this.maxValue = maxValue;\n    this.minValue = minValue;\n    this.totalCount = totalCount;\n  }\n\n  getValueRange(percentileRange) {\n    if (!this.sortedBins) {\n      this.sortedBins = this.aggregatedBins.sort((a, b) => ascending(a.value, b.value));\n    }\n\n    if (!this.sortedBins.length) {\n      return [];\n    }\n\n    let lowerIdx = 0;\n    let upperIdx = this.sortedBins.length - 1;\n\n    if (Array.isArray(percentileRange)) {\n      const idxRange = this._percentileToIndex(percentileRange);\n\n      lowerIdx = idxRange[0];\n      upperIdx = idxRange[1];\n    }\n\n    return [this.sortedBins[lowerIdx].value, this.sortedBins[upperIdx].value];\n  }\n\n  getValueDomainByScale(scale, [lower = 0, upper = 100] = []) {\n    if (!this.sortedBins) {\n      this.sortedBins = this.aggregatedBins.sort((a, b) => ascending(a.value, b.value));\n    }\n\n    if (!this.sortedBins.length) {\n      return [];\n    }\n\n    const indexEdge = this._percentileToIndex([lower, upper]);\n\n    return this._getScaleDomain(scale, indexEdge);\n  }\n\n  _getScaleDomain(scaleType, [lowerIdx, upperIdx]) {\n    const bins = this.sortedBins;\n\n    switch (scaleType) {\n      case 'quantize':\n      case 'linear':\n        return [bins[lowerIdx].value, bins[upperIdx].value];\n\n      case 'quantile':\n        return getQuantileDomain(bins.slice(lowerIdx, upperIdx + 1), d => d.value);\n\n      case 'ordinal':\n        return getOrdinalDomain(bins, d => d.value);\n\n      default:\n        return [bins[lowerIdx].value, bins[upperIdx].value];\n    }\n  }\n\n}\n//# sourceMappingURL=bin-sorter.js.map","import BinSorter from './bin-sorter';\nimport { getScaleFunctionByScaleType } from './scale-utils';\nimport { getValueFunc, wrapGetValueFunc } from './aggregation-operation-utils';\n\nfunction nop() {}\n\nconst dimensionSteps = ['getBins', 'getDomain', 'getScaleFunc'];\nconst defaultDimensions = [{\n  key: 'fillColor',\n  accessor: 'getFillColor',\n  pickingInfo: 'colorValue',\n  getBins: {\n    triggers: {\n      value: {\n        prop: 'getColorValue',\n        updateTrigger: 'getColorValue'\n      },\n      weight: {\n        prop: 'getColorWeight',\n        updateTrigger: 'getColorWeight'\n      },\n      aggregation: {\n        prop: 'colorAggregation'\n      },\n      filterData: {\n        prop: '_filterData',\n        updateTrigger: '_filterData'\n      }\n    }\n  },\n  getDomain: {\n    triggers: {\n      lowerPercentile: {\n        prop: 'lowerPercentile'\n      },\n      upperPercentile: {\n        prop: 'upperPercentile'\n      },\n      scaleType: {\n        prop: 'colorScaleType'\n      }\n    }\n  },\n  getScaleFunc: {\n    triggers: {\n      domain: {\n        prop: 'colorDomain'\n      },\n      range: {\n        prop: 'colorRange'\n      }\n    },\n    onSet: {\n      props: 'onSetColorDomain'\n    }\n  },\n  nullValue: [0, 0, 0, 0]\n}, {\n  key: 'elevation',\n  accessor: 'getElevation',\n  pickingInfo: 'elevationValue',\n  getBins: {\n    triggers: {\n      value: {\n        prop: 'getElevationValue',\n        updateTrigger: 'getElevationValue'\n      },\n      weight: {\n        prop: 'getElevationWeight',\n        updateTrigger: 'getElevationWeight'\n      },\n      aggregation: {\n        prop: 'elevationAggregation'\n      },\n      filterData: {\n        prop: '_filterData',\n        updateTrigger: '_filterData'\n      }\n    }\n  },\n  getDomain: {\n    triggers: {\n      lowerPercentile: {\n        prop: 'elevationLowerPercentile'\n      },\n      upperPercentile: {\n        prop: 'elevationUpperPercentile'\n      },\n      scaleType: {\n        prop: 'elevationScaleType'\n      }\n    }\n  },\n  getScaleFunc: {\n    triggers: {\n      domain: {\n        prop: 'elevationDomain'\n      },\n      range: {\n        prop: 'elevationRange'\n      }\n    },\n    onSet: {\n      props: 'onSetElevationDomain'\n    }\n  },\n  nullValue: -1\n}];\n\nconst defaultGetCellSize = props => props.cellSize;\n\nexport default class CPUAggregator {\n  constructor(opts) {\n    this.state = {\n      layerData: {},\n      dimensions: {}\n    };\n    this.changeFlags = {};\n    this.dimensionUpdaters = {};\n    this._getCellSize = opts.getCellSize || defaultGetCellSize;\n    this._getAggregator = opts.getAggregator;\n\n    this._addDimension(opts.dimensions || defaultDimensions);\n  }\n\n  static defaultDimensions() {\n    return defaultDimensions;\n  }\n\n  updateState(opts, aggregationParams) {\n    const {\n      oldProps,\n      props,\n      changeFlags\n    } = opts;\n    this.updateGetValueFuncs(oldProps, props, changeFlags);\n    const reprojectNeeded = this.needsReProjectPoints(oldProps, props, changeFlags);\n    let aggregationDirty = false;\n\n    if (changeFlags.dataChanged || reprojectNeeded) {\n      this.getAggregatedData(props, aggregationParams);\n      aggregationDirty = true;\n    } else {\n      const dimensionChanges = this.getDimensionChanges(oldProps, props, changeFlags) || [];\n      dimensionChanges.forEach(f => typeof f === 'function' && f());\n      aggregationDirty = true;\n    }\n\n    this.setState({\n      aggregationDirty\n    });\n    return this.state;\n  }\n\n  setState(updateObject) {\n    this.state = { ...this.state,\n      ...updateObject\n    };\n  }\n\n  setDimensionState(key, updateObject) {\n    this.setState({\n      dimensions: { ...this.state.dimensions,\n        [key]: { ...this.state.dimensions[key],\n          ...updateObject\n        }\n      }\n    });\n  }\n\n  normalizeResult(result = {}) {\n    if (result.hexagons) {\n      return {\n        data: result.hexagons,\n        ...result\n      };\n    } else if (result.layerData) {\n      return {\n        data: result.layerData,\n        ...result\n      };\n    }\n\n    return result;\n  }\n\n  getAggregatedData(props, aggregationParams) {\n    const aggregator = this._getAggregator(props);\n\n    const result = aggregator(props, aggregationParams);\n    this.setState({\n      layerData: this.normalizeResult(result)\n    });\n    this.changeFlags = {\n      layerData: true\n    };\n    this.getSortedBins(props);\n  }\n\n  updateGetValueFuncs(oldProps, props, changeFlags) {\n    for (const key in this.dimensionUpdaters) {\n      const {\n        value,\n        weight,\n        aggregation\n      } = this.dimensionUpdaters[key].getBins.triggers;\n      let getValue = props[value.prop];\n      const getValueChanged = this.needUpdateDimensionStep(this.dimensionUpdaters[key].getBins, oldProps, props, changeFlags);\n\n      if (getValueChanged) {\n        if (getValue) {\n          getValue = wrapGetValueFunc(getValue, {\n            data: props.data\n          });\n        } else {\n          getValue = getValueFunc(props[aggregation.prop], props[weight.prop], {\n            data: props.data\n          });\n        }\n      }\n\n      if (getValue) {\n        this.setDimensionState(key, {\n          getValue\n        });\n      }\n    }\n  }\n\n  needsReProjectPoints(oldProps, props, changeFlags) {\n    return this._getCellSize(oldProps) !== this._getCellSize(props) || this._getAggregator(oldProps) !== this._getAggregator(props) || changeFlags.updateTriggersChanged && (changeFlags.updateTriggersChanged.all || changeFlags.updateTriggersChanged.getPosition);\n  }\n\n  addDimension(dimensions) {\n    this._addDimension(dimensions);\n  }\n\n  _addDimension(dimensions = []) {\n    dimensions.forEach(dimension => {\n      const {\n        key\n      } = dimension;\n      this.dimensionUpdaters[key] = this.getDimensionUpdaters(dimension);\n      this.state.dimensions[key] = {\n        getValue: null,\n        domain: null,\n        sortedBins: null,\n        scaleFunc: nop\n      };\n    });\n  }\n\n  getDimensionUpdaters({\n    key,\n    accessor,\n    pickingInfo,\n    getBins,\n    getDomain,\n    getScaleFunc,\n    nullValue\n  }) {\n    return {\n      key,\n      accessor,\n      pickingInfo,\n      getBins: {\n        updater: this.getDimensionSortedBins,\n        ...getBins\n      },\n      getDomain: {\n        updater: this.getDimensionValueDomain,\n        ...getDomain\n      },\n      getScaleFunc: {\n        updater: this.getDimensionScale,\n        ...getScaleFunc\n      },\n      attributeAccessor: this.getSubLayerDimensionAttribute(key, nullValue)\n    };\n  }\n\n  needUpdateDimensionStep(dimensionStep, oldProps, props, changeFlags) {\n    return Object.values(dimensionStep.triggers).some(item => {\n      if (item.updateTrigger) {\n        return changeFlags.dataChanged || changeFlags.updateTriggersChanged && (changeFlags.updateTriggersChanged.all || changeFlags.updateTriggersChanged[item.updateTrigger]);\n      }\n\n      return oldProps[item.prop] !== props[item.prop];\n    });\n  }\n\n  getDimensionChanges(oldProps, props, changeFlags) {\n    const updaters = [];\n\n    for (const key in this.dimensionUpdaters) {\n      const needUpdate = dimensionSteps.find(step => this.needUpdateDimensionStep(this.dimensionUpdaters[key][step], oldProps, props, changeFlags));\n\n      if (needUpdate) {\n        updaters.push(this.dimensionUpdaters[key][needUpdate].updater.bind(this, props, this.dimensionUpdaters[key]));\n      }\n    }\n\n    return updaters.length ? updaters : null;\n  }\n\n  getUpdateTriggers(props) {\n    const _updateTriggers = props.updateTriggers || {};\n\n    const updateTriggers = {};\n\n    for (const key in this.dimensionUpdaters) {\n      const {\n        accessor\n      } = this.dimensionUpdaters[key];\n      updateTriggers[accessor] = {};\n      dimensionSteps.forEach(step => {\n        Object.values(this.dimensionUpdaters[key][step].triggers).forEach(({\n          prop,\n          updateTrigger\n        }) => {\n          if (updateTrigger) {\n            const fromProp = _updateTriggers[updateTrigger];\n\n            if (typeof fromProp === 'object' && !Array.isArray(fromProp)) {\n              Object.assign(updateTriggers[accessor], fromProp);\n            } else if (fromProp !== undefined) {\n              updateTriggers[accessor][prop] = fromProp;\n            }\n          } else {\n            updateTriggers[accessor][prop] = props[prop];\n          }\n        });\n      });\n    }\n\n    return updateTriggers;\n  }\n\n  getSortedBins(props) {\n    for (const key in this.dimensionUpdaters) {\n      this.getDimensionSortedBins(props, this.dimensionUpdaters[key]);\n    }\n  }\n\n  getDimensionSortedBins(props, dimensionUpdater) {\n    const {\n      key\n    } = dimensionUpdater;\n    const {\n      getValue\n    } = this.state.dimensions[key];\n    const sortedBins = new BinSorter(this.state.layerData.data || [], {\n      getValue,\n      filterData: props._filterData\n    });\n    this.setDimensionState(key, {\n      sortedBins\n    });\n    this.getDimensionValueDomain(props, dimensionUpdater);\n  }\n\n  getDimensionValueDomain(props, dimensionUpdater) {\n    const {\n      getDomain,\n      key\n    } = dimensionUpdater;\n    const {\n      triggers: {\n        lowerPercentile,\n        upperPercentile,\n        scaleType\n      }\n    } = getDomain;\n    const valueDomain = this.state.dimensions[key].sortedBins.getValueDomainByScale(props[scaleType.prop], [props[lowerPercentile.prop], props[upperPercentile.prop]]);\n    this.setDimensionState(key, {\n      valueDomain\n    });\n    this.getDimensionScale(props, dimensionUpdater);\n  }\n\n  getDimensionScale(props, dimensionUpdater) {\n    const {\n      key,\n      getScaleFunc,\n      getDomain\n    } = dimensionUpdater;\n    const {\n      domain,\n      range\n    } = getScaleFunc.triggers;\n    const {\n      scaleType\n    } = getDomain.triggers;\n    const {\n      onSet\n    } = getScaleFunc;\n    const dimensionRange = props[range.prop];\n    const dimensionDomain = props[domain.prop] || this.state.dimensions[key].valueDomain;\n    const getScaleFunction = getScaleFunctionByScaleType(scaleType && props[scaleType.prop]);\n    const scaleFunc = getScaleFunction(dimensionDomain, dimensionRange);\n\n    if (typeof onSet === 'object' && typeof props[onSet.props] === 'function') {\n      props[onSet.props](scaleFunc.domain());\n    }\n\n    this.setDimensionState(key, {\n      scaleFunc\n    });\n  }\n\n  getSubLayerDimensionAttribute(key, nullValue) {\n    return cell => {\n      const {\n        sortedBins,\n        scaleFunc\n      } = this.state.dimensions[key];\n      const bin = sortedBins.binMap[cell.index];\n\n      if (bin && bin.counts === 0) {\n        return nullValue;\n      }\n\n      const cv = bin && bin.value;\n      const domain = scaleFunc.domain();\n      const isValueInDomain = cv >= domain[0] && cv <= domain[domain.length - 1];\n      return isValueInDomain ? scaleFunc(cv) : nullValue;\n    };\n  }\n\n  getSubLayerAccessors(props) {\n    const accessors = {};\n\n    for (const key in this.dimensionUpdaters) {\n      const {\n        accessor\n      } = this.dimensionUpdaters[key];\n      accessors[accessor] = this.getSubLayerDimensionAttribute(props, key);\n    }\n\n    return accessors;\n  }\n\n  getPickingInfo({\n    info\n  }) {\n    const isPicked = info.picked && info.index > -1;\n    let object = null;\n\n    if (isPicked) {\n      const cell = this.state.layerData.data[info.index];\n      const binInfo = {};\n\n      for (const key in this.dimensionUpdaters) {\n        const {\n          pickingInfo\n        } = this.dimensionUpdaters[key];\n        const {\n          sortedBins\n        } = this.state.dimensions[key];\n        const value = sortedBins.binMap[cell.index] && sortedBins.binMap[cell.index].value;\n        binInfo[pickingInfo] = value;\n      }\n\n      object = Object.assign(binInfo, cell, {\n        points: cell.filteredPoints || cell.points\n      });\n    }\n\n    info.picked = Boolean(object);\n    info.object = object;\n    return info;\n  }\n\n  getAccessor(dimensionKey) {\n    if (!this.dimensionUpdaters.hasOwnProperty(dimensionKey)) {\n      return nop;\n    }\n\n    return this.dimensionUpdaters[dimensionKey].attributeAccessor;\n  }\n\n}\n//# sourceMappingURL=cpu-aggregator.js.map","var thirdPi = Math.PI / 3,\n    angles = [0, thirdPi, 2 * thirdPi, 3 * thirdPi, 4 * thirdPi, 5 * thirdPi];\n\nfunction pointX(d) {\n  return d[0];\n}\n\nfunction pointY(d) {\n  return d[1];\n}\n\nexport default function() {\n  var x0 = 0,\n      y0 = 0,\n      x1 = 1,\n      y1 = 1,\n      x = pointX,\n      y = pointY,\n      r,\n      dx,\n      dy;\n\n  function hexbin(points) {\n    var binsById = {}, bins = [], i, n = points.length;\n\n    for (i = 0; i < n; ++i) {\n      if (isNaN(px = +x.call(null, point = points[i], i, points))\n          || isNaN(py = +y.call(null, point, i, points))) continue;\n\n      var point,\n          px,\n          py,\n          pj = Math.round(py = py / dy),\n          pi = Math.round(px = px / dx - (pj & 1) / 2),\n          py1 = py - pj;\n\n      if (Math.abs(py1) * 3 > 1) {\n        var px1 = px - pi,\n            pi2 = pi + (px < pi ? -1 : 1) / 2,\n            pj2 = pj + (py < pj ? -1 : 1),\n            px2 = px - pi2,\n            py2 = py - pj2;\n        if (px1 * px1 + py1 * py1 > px2 * px2 + py2 * py2) pi = pi2 + (pj & 1 ? 1 : -1) / 2, pj = pj2;\n      }\n\n      var id = pi + \"-\" + pj, bin = binsById[id];\n      if (bin) bin.push(point);\n      else {\n        bins.push(bin = binsById[id] = [point]);\n        bin.x = (pi + (pj & 1) / 2) * dx;\n        bin.y = pj * dy;\n      }\n    }\n\n    return bins;\n  }\n\n  function hexagon(radius) {\n    var x0 = 0, y0 = 0;\n    return angles.map(function(angle) {\n      var x1 = Math.sin(angle) * radius,\n          y1 = -Math.cos(angle) * radius,\n          dx = x1 - x0,\n          dy = y1 - y0;\n      x0 = x1, y0 = y1;\n      return [dx, dy];\n    });\n  }\n\n  hexbin.hexagon = function(radius) {\n    return \"m\" + hexagon(radius == null ? r : +radius).join(\"l\") + \"z\";\n  };\n\n  hexbin.centers = function() {\n    var centers = [],\n        j = Math.round(y0 / dy),\n        i = Math.round(x0 / dx);\n    for (var y = j * dy; y < y1 + r; y += dy, ++j) {\n      for (var x = i * dx + (j & 1) * dx / 2; x < x1 + dx / 2; x += dx) {\n        centers.push([x, y]);\n      }\n    }\n    return centers;\n  };\n\n  hexbin.mesh = function() {\n    var fragment = hexagon(r).slice(0, 4).join(\"l\");\n    return hexbin.centers().map(function(p) { return \"M\" + p + \"m\" + fragment; }).join(\"\");\n  };\n\n  hexbin.x = function(_) {\n    return arguments.length ? (x = _, hexbin) : x;\n  };\n\n  hexbin.y = function(_) {\n    return arguments.length ? (y = _, hexbin) : y;\n  };\n\n  hexbin.radius = function(_) {\n    return arguments.length ? (r = +_, dx = r * 2 * Math.sin(thirdPi), dy = r * 1.5, hexbin) : r;\n  };\n\n  hexbin.size = function(_) {\n    return arguments.length ? (x0 = y0 = 0, x1 = +_[0], y1 = +_[1], hexbin) : [x1 - x0, y1 - y0];\n  };\n\n  hexbin.extent = function(_) {\n    return arguments.length ? (x0 = +_[0][0], y0 = +_[0][1], x1 = +_[1][0], y1 = +_[1][1], hexbin) : [[x0, y0], [x1, y1]];\n  };\n\n  return hexbin.radius(1);\n}\n","import { hexbin } from 'd3-hexbin';\nimport { createIterable, log } from '@deck.gl/core';\nexport function pointToHexbin(props, aggregationParams) {\n  const {\n    data,\n    radius\n  } = props;\n  const {\n    viewport,\n    attributes\n  } = aggregationParams;\n  const centerLngLat = data.length ? getPointsCenter(data, aggregationParams) : null;\n  const radiusCommon = getRadiusInCommon(radius, viewport, centerLngLat);\n  const screenPoints = [];\n  const {\n    iterable,\n    objectInfo\n  } = createIterable(data);\n  const positions = attributes.positions.value;\n  const {\n    size\n  } = attributes.positions.getAccessor();\n\n  for (const object of iterable) {\n    objectInfo.index++;\n    const posIndex = objectInfo.index * size;\n    const position = [positions[posIndex], positions[posIndex + 1]];\n    const arrayIsFinite = Number.isFinite(position[0]) && Number.isFinite(position[1]);\n\n    if (arrayIsFinite) {\n      screenPoints.push({\n        screenCoord: viewport.projectFlat(position),\n        source: object,\n        index: objectInfo.index\n      });\n    } else {\n      log.warn('HexagonLayer: invalid position')();\n    }\n  }\n\n  const newHexbin = hexbin().radius(radiusCommon).x(d => d.screenCoord[0]).y(d => d.screenCoord[1]);\n  const hexagonBins = newHexbin(screenPoints);\n  return {\n    hexagons: hexagonBins.map((hex, index) => ({\n      position: viewport.unprojectFlat([hex.x, hex.y]),\n      points: hex,\n      index\n    })),\n    radiusCommon\n  };\n}\nexport function getPointsCenter(data, aggregationParams) {\n  const {\n    attributes\n  } = aggregationParams;\n  const positions = attributes.positions.value;\n  const {\n    size\n  } = attributes.positions.getAccessor();\n  let minX = Infinity;\n  let minY = Infinity;\n  let maxX = -Infinity;\n  let maxY = -Infinity;\n  let i;\n\n  for (i = 0; i < size * data.length; i += size) {\n    const x = positions[i];\n    const y = positions[i + 1];\n    const arrayIsFinite = Number.isFinite(x) && Number.isFinite(y);\n\n    if (arrayIsFinite) {\n      minX = Math.min(x, minX);\n      maxX = Math.max(x, maxX);\n      minY = Math.min(y, minY);\n      maxY = Math.max(y, maxY);\n    }\n  }\n\n  return [minX, minY, maxX, maxY].every(Number.isFinite) ? [(minX + maxX) / 2, (minY + maxY) / 2] : null;\n}\nexport function getRadiusInCommon(radius, viewport, center) {\n  const {\n    unitsPerMeter\n  } = viewport.getDistanceScales(center);\n  return radius * unitsPerMeter[0];\n}\n//# sourceMappingURL=hexagon-aggregator.js.map","import _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport { log } from '@deck.gl/core';\nimport { ColumnLayer } from '@deck.gl/layers';\nimport { defaultColorRange } from '../utils/color-utils';\nimport { pointToHexbin } from './hexagon-aggregator';\nimport CPUAggregator from '../utils/cpu-aggregator';\nimport AggregationLayer from '../aggregation-layer';\n\nfunction nop() {}\n\nconst defaultProps = {\n  colorDomain: null,\n  colorRange: defaultColorRange,\n  getColorValue: {\n    type: 'accessor',\n    value: null\n  },\n  getColorWeight: {\n    type: 'accessor',\n    value: 1\n  },\n  colorAggregation: 'SUM',\n  lowerPercentile: {\n    type: 'number',\n    value: 0,\n    min: 0,\n    max: 100\n  },\n  upperPercentile: {\n    type: 'number',\n    value: 100,\n    min: 0,\n    max: 100\n  },\n  colorScaleType: 'quantize',\n  onSetColorDomain: nop,\n  elevationDomain: null,\n  elevationRange: [0, 1000],\n  getElevationValue: {\n    type: 'accessor',\n    value: null\n  },\n  getElevationWeight: {\n    type: 'accessor',\n    value: 1\n  },\n  elevationAggregation: 'SUM',\n  elevationLowerPercentile: {\n    type: 'number',\n    value: 0,\n    min: 0,\n    max: 100\n  },\n  elevationUpperPercentile: {\n    type: 'number',\n    value: 100,\n    min: 0,\n    max: 100\n  },\n  elevationScale: {\n    type: 'number',\n    min: 0,\n    value: 1\n  },\n  elevationScaleType: 'linear',\n  onSetElevationDomain: nop,\n  radius: {\n    type: 'number',\n    value: 1000,\n    min: 1\n  },\n  coverage: {\n    type: 'number',\n    min: 0,\n    max: 1,\n    value: 1\n  },\n  extruded: false,\n  hexagonAggregator: pointToHexbin,\n  getPosition: {\n    type: 'accessor',\n    value: x => x.position\n  },\n  material: true,\n  _filterData: {\n    type: 'function',\n    value: null,\n    optional: true\n  }\n};\nexport default class HexagonLayer extends AggregationLayer {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", void 0);\n  }\n\n  initializeState() {\n    const cpuAggregator = new CPUAggregator({\n      getAggregator: props => props.hexagonAggregator,\n      getCellSize: props => props.radius\n    });\n    this.state = {\n      cpuAggregator,\n      aggregatorState: cpuAggregator.state,\n      vertices: null\n    };\n    const attributeManager = this.getAttributeManager();\n    attributeManager.add({\n      positions: {\n        size: 3,\n        type: 5130,\n        accessor: 'getPosition'\n      }\n    });\n  }\n\n  updateState(opts) {\n    super.updateState(opts);\n\n    if (opts.changeFlags.propsOrDataChanged) {\n      const aggregatorState = this.state.cpuAggregator.updateState(opts, {\n        viewport: this.context.viewport,\n        attributes: this.getAttributes()\n      });\n\n      if (this.state.aggregatorState.layerData !== aggregatorState.layerData) {\n        const {\n          hexagonVertices\n        } = aggregatorState.layerData || {};\n        this.setState({\n          vertices: hexagonVertices && this.convertLatLngToMeterOffset(hexagonVertices)\n        });\n      }\n\n      this.setState({\n        aggregatorState\n      });\n    }\n  }\n\n  convertLatLngToMeterOffset(hexagonVertices) {\n    const {\n      viewport\n    } = this.context;\n\n    if (Array.isArray(hexagonVertices) && hexagonVertices.length === 6) {\n      const vertex0 = hexagonVertices[0];\n      const vertex3 = hexagonVertices[3];\n      const centroid = [(vertex0[0] + vertex3[0]) / 2, (vertex0[1] + vertex3[1]) / 2];\n      const centroidFlat = viewport.projectFlat(centroid);\n      const {\n        metersPerUnit\n      } = viewport.getDistanceScales(centroid);\n      const vertices = hexagonVertices.map(vt => {\n        const vtFlat = viewport.projectFlat(vt);\n        return [(vtFlat[0] - centroidFlat[0]) * metersPerUnit[0], (vtFlat[1] - centroidFlat[1]) * metersPerUnit[1]];\n      });\n      return vertices;\n    }\n\n    log.error('HexagonLayer: hexagonVertices needs to be an array of 6 points')();\n    return null;\n  }\n\n  getPickingInfo({\n    info\n  }) {\n    return this.state.cpuAggregator.getPickingInfo({\n      info\n    });\n  }\n\n  _onGetSublayerColor(cell) {\n    return this.state.cpuAggregator.getAccessor('fillColor')(cell);\n  }\n\n  _onGetSublayerElevation(cell) {\n    return this.state.cpuAggregator.getAccessor('elevation')(cell);\n  }\n\n  _getSublayerUpdateTriggers() {\n    return this.state.cpuAggregator.getUpdateTriggers(this.props);\n  }\n\n  renderLayers() {\n    const {\n      elevationScale,\n      extruded,\n      coverage,\n      material,\n      transitions\n    } = this.props;\n    const {\n      aggregatorState,\n      vertices\n    } = this.state;\n    const SubLayerClass = this.getSubLayerClass('hexagon-cell', ColumnLayer);\n\n    const updateTriggers = this._getSublayerUpdateTriggers();\n\n    const geometry = vertices ? {\n      vertices,\n      radius: 1\n    } : {\n      radius: aggregatorState.layerData.radiusCommon || 1,\n      radiusUnits: 'common',\n      angle: 90\n    };\n    return new SubLayerClass({ ...geometry,\n      diskResolution: 6,\n      elevationScale,\n      extruded,\n      coverage,\n      material,\n      getFillColor: this._onGetSublayerColor.bind(this),\n      getElevation: this._onGetSublayerElevation.bind(this),\n      transitions: transitions && {\n        getFillColor: transitions.getColorValue || transitions.getColorWeight,\n        getElevation: transitions.getElevationValue || transitions.getElevationWeight\n      }\n    }, this.getSubLayerProps({\n      id: 'hexagon-cell',\n      updateTriggers\n    }), {\n      data: aggregatorState.layerData.data\n    });\n  }\n\n}\n\n_defineProperty(HexagonLayer, \"layerName\", 'HexagonLayer');\n\n_defineProperty(HexagonLayer, \"defaultProps\", defaultProps);\n//# sourceMappingURL=hexagon-layer.js.map","import React, { useState, useMemo, useEffect } from 'react'\r\nimport DeckGL from '@deck.gl/react'\r\nimport { StaticMap, InteractiveMap } from 'react-map-gl'\r\nimport { ArcLayer } from '@deck.gl/layers'\r\nimport { HexagonLayer } from '@deck.gl/aggregation-layers'\r\nimport colormap from 'colormap'\r\n\r\nimport globalStore from '@/store'\r\nimport { MAPBOX_TOKEN, REACT_VIEW_HANDLES } from '@/Globals'\r\n\r\nconst material = {\r\n  ambient: 0.64,\r\n  diffuse: 0.6,\r\n  shininess: 32,\r\n  specularColor: [51, 51, 51],\r\n}\r\n\r\nconst INITIAL_VIEW = {\r\n  zoom: 10,\r\n  longitude: 13.45,\r\n  latitude: 52.5,\r\n  pitch: 0,\r\n  bearing: 0,\r\n}\r\n\r\n// LAYER --------------------------------------------------------\r\nexport default function Layer({\r\n  viewId = 0,\r\n  colorRamp = 'chlorophyll',\r\n  coverage = 0.65,\r\n  dark = false,\r\n  data = { raw: new Float32Array(0), length: 0 },\r\n  extrude = true,\r\n  highlights = [],\r\n  mapIsIndependent = false,\r\n  maxHeight = 200,\r\n  metric = 'Count',\r\n  radius = 100,\r\n  selectedHexStats = { rows: 0, numHexagons: 0, selectedHexagonIds: [] },\r\n  upperPercentile = 100,\r\n  onClick = {} as any,\r\n}) {\r\n  // manage SimWrapper centralized viewState - for linked maps\r\n  const [viewState, setViewState] = useState(INITIAL_VIEW)\r\n\r\n  REACT_VIEW_HANDLES[viewId] = (view: any) => {\r\n    if (view) {\r\n      setViewState(view)\r\n    } else {\r\n      setViewState(globalStore.state.viewState)\r\n    }\r\n  }\r\n\r\n  function handleViewState(view: any) {\r\n    if (!view.latitude) return\r\n\r\n    if (!view.center) view.center = [0, 0]\r\n    view.center[0] = view.longitude\r\n    view.center[1] = view.latitude\r\n    setViewState(view)\r\n\r\n    if (!mapIsIndependent) globalStore.commit('setMapCamera', view)\r\n  }\r\n\r\n  const colors = colormap({\r\n    colormap: colorRamp,\r\n    nshades: 10,\r\n    format: 'rba',\r\n    alpha: 1,\r\n  }).map((c: number[]) => [c[0], c[1], c[2]])\r\n\r\n  function getTooltip({ object }: any) {\r\n    if (!object || !object.position || !object.position.length) {\r\n      return null\r\n    }\r\n\r\n    const lat = object.position[1]\r\n    const lng = object.position[0]\r\n    const count = object.points.length\r\n\r\n    return {\r\n      html: `\\\r\n        <b>${highlights.length ? 'Count' : metric}: ${count} </b><br/>\r\n        ${Number.isFinite(lat) ? lat.toFixed(4) : ''} / ${\r\n        Number.isFinite(lng) ? lng.toFixed(4) : ''\r\n      }\r\n      `,\r\n      style: dark\r\n        ? { color: '#ccc', backgroundColor: '#2a3c4f' }\r\n        : { color: '#223', backgroundColor: 'white' },\r\n    }\r\n  }\r\n\r\n  function handleClick(target: any, event: any) {\r\n    onClick(target, event)\r\n  }\r\n\r\n  // is data filtered or not?\r\n  let rows = null\r\n  if (highlights.length) {\r\n    rows = highlights.map(row => row[1])\r\n  } else if (!data.length) {\r\n    rows = null\r\n  } else {\r\n    rows = {\r\n      length: data.length,\r\n      attributes: {\r\n        getPosition: { value: data.raw, size: 2 },\r\n      },\r\n    }\r\n  }\r\n\r\n  const layers = [\r\n    new ArcLayer({\r\n      id: 'arc-layer',\r\n      data: highlights,\r\n      getSourcePosition: (d: any) => d[0],\r\n      getTargetPosition: (d: any) => d[1],\r\n      pickable: false,\r\n      opacity: 0.4,\r\n      getHeight: 0,\r\n      getWidth: 1,\r\n      getSourceColor: dark ? [144, 96, 128] : [192, 192, 240],\r\n      getTargetColor: dark ? [144, 96, 128] : [192, 192, 240],\r\n    }),\r\n    new HexagonLayer({\r\n      id: 'hexlayer',\r\n      data: rows,\r\n      getPosition: highlights.length ? (d: any) => d : null,\r\n      colorRange: dark ? colors.slice(1) : colors.reverse().slice(1),\r\n      coverage,\r\n      autoHighlight: true,\r\n      elevationRange: [0, maxHeight],\r\n      elevationScale: data && data.length ? 50 : 0,\r\n      extruded: extrude,\r\n      selectedHexStats,\r\n      // hexagonAggregator: pointToHexbin,\r\n      pickable: true,\r\n      opacity: 0.7, // dark && highlights.length ? 0.6 : 0.8,\r\n      radius,\r\n      upperPercentile,\r\n      material,\r\n      transitions: {\r\n        elevationScale: { type: 'interpolation', duration: 1000 },\r\n        opacity: { type: 'interpolation', duration: 200 },\r\n      },\r\n    }),\r\n  ]\r\n\r\n  return (\r\n    <DeckGL\r\n      layers={layers}\r\n      controller={true}\r\n      useDevicePixels={false}\r\n      viewState={viewState}\r\n      getTooltip={getTooltip}\r\n      onClick={handleClick}\r\n      onViewStateChange={(e: any) => handleViewState(e.viewState)}\r\n    >\r\n      {\r\n        /*\r\n        // @ts-ignore */\r\n        <StaticMap\r\n          mapStyle={globalStore.getters.mapStyle}\r\n          preventStyleDiffing={true}\r\n          mapboxApiAccessToken={MAPBOX_TOKEN}\r\n        />\r\n      }\r\n    </DeckGL>\r\n  )\r\n}\r\n","<template lang=\"pug\">\r\n.xy-hexagons(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\" :id=\"`id-${id}`\")\r\n\r\n  xy-hex-deck-map.hex-layer(\r\n    v-if=\"!thumbnail && isLoaded\"\r\n    v-bind=\"mapProps\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\")\r\n  drawing-tool.drawing-tool(v-if=\"!thumbnail\")\r\n\r\n  .left-side(v-if=\"isLoaded && !thumbnail && vizDetails.title\")\r\n    collapsible-panel(direction=\"left\" :locked=\"true\")\r\n      .panel-items(v-if=\"hexStats\" style=\"color: #c0f;\")\r\n        p.big(style=\"margin-top: 2rem;\") {{ $t('selection') }}:\r\n        h3(style=\"margin-top: -1rem;\") {{ $t('areas') }}: {{ hexStats.numHexagons }}, {{ $t('count') }}: {{ hexStats.rows }}\r\n        button.button(style=\"color: #c0f; border-color: #c0f\" @click=\"handleShowSelectionButton\") {{ $t('showDetails') }}\r\n\r\n  .control-panel(v-if=\"isLoaded && !thumbnail && !myState.statusMessage\")\r\n        //- :class=\"{'is-dashboard': config !== undefined }\"\r\n\r\n        .panel-item(v-for=\"group in Object.keys(aggregations)\" :key=\"group\")\r\n          p.speed-label {{ group }}\r\n          button.button.is-small.aggregation-button(\r\n            v-for=\"element,i in aggregations[group]\"\r\n            :key=\"i\"\r\n            :style=\"{'margin-bottom': '0.25rem', 'color': activeAggregation===`${group}~${i}` ? 'white' : buttonColors[i], 'border': `1px solid ${buttonColors[i]}`, 'border-right': `0.4rem solid ${buttonColors[i]}`,'border-radius': '4px', 'background-color': activeAggregation===`${group}~${i}` ? buttonColors[i] : $store.state.isDarkMode ? '#333':'white'}\"\r\n            @click=\"handleOrigDest(group,i)\") {{ element.title }}\r\n\r\n        .panel-item.right\r\n          p.speed-label {{ $t('maxHeight') }}: {{ vizDetails.maxHeight }}\r\n          vue-slider.speed-slider(v-model=\"vizDetails.maxHeight\"\r\n            :min=\"0\" :max=\"250\" :interval=\"5\"\r\n            :duration=\"0\" :dotSize=\"12\"\r\n            tooltip=\"none\"\r\n          )\r\n\r\n          p.speed-label Hex Radius: {{ vizDetails.radius }}\r\n          vue-slider.speed-slider(v-model=\"vizDetails.radius\"\r\n            :min=\"50\" :max=\"1000\" :interval=\"5\"\r\n            :duration=\"0\" :dotSize=\"12\"\r\n            tooltip=\"none\"\r\n          )\r\n\r\n  .message(v-if=\"!thumbnail && myState.statusMessage\")\r\n    p.status-message {{ myState.statusMessage }}\r\n\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nconst i18n = {\r\n  messages: {\r\n    en: {\r\n      loading: 'Loading data...',\r\n      sorting: 'Sorting into bins...',\r\n      aggregate: 'Summary',\r\n      maxHeight: '3D Height',\r\n      showDetails: 'Show Details',\r\n      selection: 'Selection',\r\n      areas: 'Areas',\r\n      count: 'Count',\r\n    },\r\n    de: {\r\n      loading: 'Dateien laden...',\r\n      sorting: 'Sortieren...',\r\n      aggregate: 'Daten',\r\n      maxHeight: '3-D Hhe',\r\n      showDetails: 'Details anzeigen',\r\n      selection: 'Ausgewhlt',\r\n      areas: 'Orte',\r\n      count: 'Anzahl',\r\n    },\r\n  },\r\n}\r\nimport { defineComponent } from 'vue'\r\nimport type { PropType } from 'vue'\r\n\r\nimport VueSlider from 'vue-slider-component'\r\nimport { ToggleButton } from 'vue-js-toggle-button'\r\nimport YAML from 'yaml'\r\n\r\nimport util from '@/js/util'\r\nimport globalStore from '@/store'\r\nimport { REACT_VIEW_HANDLES } from '@/Globals'\r\n\r\nimport HTTPFileSystem from '@/js/HTTPFileSystem'\r\n\r\nimport CSVParserWorker from './CsvGzipParser.worker.ts?worker'\r\nimport CollapsiblePanel from '@/components/CollapsiblePanel.vue'\r\nimport DrawingTool from '@/components/DrawingTool/DrawingTool.vue'\r\nimport ZoomButtons from '@/components/ZoomButtons.vue'\r\nimport XyHexDeckMap from './XyHexLayer'\r\n\r\nimport {\r\n  ColorScheme,\r\n  FileSystem,\r\n  LegendItem,\r\n  LegendItemType,\r\n  FileSystemConfig,\r\n  VisualizationPlugin,\r\n  Status,\r\n} from '@/Globals'\r\n\r\ninterface Aggregations {\r\n  [heading: string]: {\r\n    title: string\r\n    x: string\r\n    y: string\r\n  }[]\r\n}\r\n\r\ninterface VizDetail {\r\n  title: string\r\n  description?: string\r\n  file: string\r\n  projection: any\r\n  thumbnail?: string\r\n  elements?: string\r\n  aggregations: Aggregations\r\n  radius: number\r\n  maxHeight: number\r\n  center: any\r\n  zoom: number\r\n  mapIsIndependent?: boolean\r\n}\r\n\r\nconst MyComponent = defineComponent({\r\n  name: 'XyHexagonsPlugin',\r\n  i18n,\r\n  components: {\r\n    CollapsiblePanel,\r\n    DrawingTool,\r\n    XyHexDeckMap,\r\n    VueSlider,\r\n    ToggleButton,\r\n    ZoomButtons,\r\n  },\r\n  props: {\r\n    root: { type: String, required: true },\r\n    subfolder: { type: String, required: true },\r\n    yamlConfig: String,\r\n    config: Object,\r\n    thumbnail: Boolean,\r\n  },\r\n  data: () => {\r\n    const colorRamps = ['bathymetry', 'par', 'chlorophyll', 'magma']\r\n    return {\r\n      id: `id-${Math.floor(1e12 * Math.random())}` as any,\r\n      standaloneYAMLconfig: {\r\n        title: '',\r\n        description: '',\r\n        file: '',\r\n        projection: '',\r\n        thumbnail: '',\r\n        aggregations: {},\r\n        radius: 250,\r\n        maxHeight: 0,\r\n        center: null as any,\r\n        zoom: 9,\r\n        mapIsIndependent: false,\r\n      },\r\n      YAMLrequirementsXY: { file: '', aggregations: {} },\r\n      colorRamps,\r\n      buttonColors: ['#5E8AAE', '#BF7230', '#269367', '#9C439C'],\r\n      aggregations: {} as Aggregations,\r\n      columnLookup: [] as number[],\r\n      gzipWorker: null as Worker | null,\r\n      colorRamp: colorRamps[0],\r\n      globalState: globalStore.state,\r\n      vizDetails: {\r\n        title: '',\r\n        description: '',\r\n        file: '',\r\n        projection: '',\r\n        thumbnail: '',\r\n        aggregations: {},\r\n        radius: 250,\r\n        maxHeight: 0,\r\n        center: null as any,\r\n        zoom: 9,\r\n      } as VizDetail,\r\n      myState: {\r\n        statusMessage: '',\r\n        subfolder: '',\r\n        yamlConfig: '',\r\n        thumbnail: false,\r\n      },\r\n      rowCache: {} as {\r\n        [id: string]: { raw: Float32Array; length: number; coordColumns: number[] }\r\n      },\r\n      requests: { raw: new Float32Array(0), length: 0 } as { raw: Float32Array; length: number },\r\n      highlightedTrips: [] as any[],\r\n      searchTerm: '',\r\n      searchEnabled: false,\r\n      isLoaded: false,\r\n      activeAggregation: '',\r\n      isHighlightingZone: false,\r\n      multiSelectedHexagons: {} as { [index: string]: any[] },\r\n      thumbnailUrl: \"url('assets/thumbnail.jpg') no-repeat;\",\r\n      hexStats: null as null | {\r\n        rows: number\r\n        numHexagons: number\r\n        selectedHexagonIds: any[]\r\n      },\r\n      resizer: null as ResizeObserver | null,\r\n    }\r\n  },\r\n  computed: {\r\n    fileApi(): HTTPFileSystem {\r\n      return new HTTPFileSystem(this.fileSystem, globalStore)\r\n    },\r\n    fileSystem(): FileSystemConfig {\r\n      const svnProject: FileSystemConfig[] = this.$store.state.svnProjects.filter(\r\n        (a: FileSystemConfig) => a.slug === this.root\r\n      )\r\n      if (svnProject.length === 0) {\r\n        console.log('no such project')\r\n        throw Error\r\n      }\r\n      return svnProject[0]\r\n    },\r\n\r\n    urlThumbnail(): any {\r\n      return this.thumbnailUrl\r\n    },\r\n\r\n    buttonLabel(): string {\r\n      const [group, offset] = this.activeAggregation.split('~') as any[]\r\n      return this.aggregations[group][offset].title\r\n    },\r\n    extrudeTowers(): boolean {\r\n      return this.vizDetails.maxHeight > 0\r\n    },\r\n\r\n    mapProps(): any {\r\n      return {\r\n        viewId: this.id,\r\n        colorRamp: this.colorRamp,\r\n        coverage: 0.65,\r\n        dark: this.$store.state.isDarkMode,\r\n        data: this.requests,\r\n        extrude: this.extrudeTowers,\r\n        highlights: this.highlightedTrips,\r\n        mapIsIndependent: this.vizDetails.mapIsIndependent,\r\n        maxHeight: this.vizDetails.maxHeight,\r\n        metric: this.buttonLabel,\r\n        radius: this.vizDetails.radius,\r\n        selectedHexStats: this.hexStats,\r\n        upperPercentile: 100,\r\n        onClick: this.handleClick,\r\n      }\r\n    },\r\n    textColor(): any {\r\n      const lightmode = {\r\n        text: '#3498db',\r\n        bg: '#eeeef480',\r\n      }\r\n\r\n      const darkmode = {\r\n        text: 'white',\r\n        bg: '#181518aa',\r\n      }\r\n\r\n      return this.$store.state.colorScheme === ColorScheme.DarkMode ? darkmode : lightmode\r\n    },\r\n  },\r\n  watch: {\r\n    extrudeTowers() {\r\n      if (this.extrudeTowers && this.globalState.viewState.pitch == 0) {\r\n        globalStore.commit(\r\n          'setMapCamera',\r\n          Object.assign({}, this.globalState.viewState, { pitch: 10 })\r\n        )\r\n      }\r\n    },\r\n    '$store.state.viewState'() {\r\n      if (this.vizDetails.mapIsIndependent) return\r\n      if (REACT_VIEW_HANDLES[this.id]) REACT_VIEW_HANDLES[this.id]()\r\n    },\r\n  },\r\n  methods: {\r\n    handleClick(target: any, event: any) {\r\n      console.log({ target, event })\r\n      if (!target.layer) this.handleEmptyClick()\r\n      else this.handleHexClick(target, event)\r\n    },\r\n\r\n    handleEmptyClick() {\r\n      this.flipViewToShowInvertedData({})\r\n    },\r\n\r\n    handleHexClick(pickedObject: any, event: any) {\r\n      if (!event.srcEvent.shiftKey) {\r\n        this.multiSelectedHexagons = {}\r\n        this.hexStats = null\r\n        this.flipViewToShowInvertedData(pickedObject)\r\n        return\r\n      }\r\n\r\n      // SHIFT!!\r\n      const index = pickedObject?.object?.index\r\n      if (index !== undefined) {\r\n        if (index in this.multiSelectedHexagons) {\r\n          delete this.multiSelectedHexagons[index]\r\n        } else {\r\n          this.multiSelectedHexagons[index] = pickedObject.object.points\r\n        }\r\n        this.hexStats = this.selectedHexagonStatistics()\r\n      }\r\n    },\r\n\r\n    flipViewToShowInvertedData(pickedObject: any) {\r\n      if (this.isHighlightingZone) {\r\n        // force highlight off if user clicked on a second hex\r\n        this.isHighlightingZone = false\r\n      } else if (!pickedObject.object) {\r\n        // force highlight off if user clicked away\r\n        this.isHighlightingZone = false\r\n      } else {\r\n        this.isHighlightingZone = true\r\n      }\r\n\r\n      const parts = this.activeAggregation.split('~') // an unlikely unicode\r\n\r\n      let suffix = 0\r\n      let revSuffix = 0\r\n\r\n      // set up the hexagons\r\n      if (!this.isHighlightingZone) {\r\n        // reset the view\r\n        this.hexStats = null\r\n        this.multiSelectedHexagons = {}\r\n        this.handleOrigDest(parts[0], parseInt(parts[1]))\r\n      } else {\r\n        // select the anti-view\r\n        suffix = parseInt(parts[1])\r\n        revSuffix = suffix % 2 ? suffix - 1 : suffix + 1\r\n\r\n        const origKey = `${parts[0]}${suffix}`\r\n        const origArray = this.rowCache[origKey]\r\n\r\n        const key = `${parts[0]}${revSuffix}`\r\n        const inverseArray = this.rowCache[key]\r\n\r\n        const arcFilteredRows: any = []\r\n\r\n        for (const row of pickedObject.object.points) {\r\n          const zoffset = row.index * 2\r\n          const coords = [inverseArray.raw[zoffset], inverseArray.raw[zoffset + 1]]\r\n\r\n          arcFilteredRows.push([\r\n            // from\r\n            [origArray.raw[zoffset], origArray.raw[zoffset + 1]],\r\n            // to\r\n            coords,\r\n          ])\r\n          this.highlightedTrips = arcFilteredRows\r\n        }\r\n\r\n        if (this.hexStats) this.hexStats.selectedHexagonIds = []\r\n        this.multiSelectedHexagons = {}\r\n\r\n        this.colorRamp = this.colorRamps[revSuffix]\r\n      }\r\n\r\n      // set up the connecting arc-lines\r\n      if (!this.isHighlightingZone) {\r\n        this.highlightedTrips = []\r\n      } else {\r\n        // this.highlightedTrips = arcFilteredRows\r\n      }\r\n    },\r\n\r\n    async handleOrigDest(groupName: string, number: number) {\r\n      const cacheKey = groupName + number\r\n\r\n      this.hexStats = null\r\n      this.multiSelectedHexagons = {}\r\n\r\n      // const xytitle = this.aggregations[groupName][number]\r\n      // const x = this.columnLookup.indexOf(xytitle.x)\r\n      // const y = this.columnLookup.indexOf(xytitle.y)\r\n\r\n      this.highlightedTrips = []\r\n      this.activeAggregation = `${groupName}~${number}`\r\n\r\n      // get element offsets in data array\r\n      // const col = this.aggregations[item]\r\n      // this.whichCoords = { x, y }\r\n\r\n      // this.requests = this.rawRequests.map(r => [r[x], r[y]]).filter(z => z[0] && z[1])\r\n      // this.requests = this.rawRequests\r\n      this.requests = this.rowCache[cacheKey]\r\n      this.colorRamp = this.colorRamps[number]\r\n    },\r\n\r\n    async solveProjection() {\r\n      if (this.thumbnail) return\r\n\r\n      console.log('WHAT PROJECTION:')\r\n\r\n      try {\r\n        const text = await this.fileApi.getFileText(\r\n          this.myState.subfolder + '/' + this.myState.yamlConfig\r\n        )\r\n        this.vizDetails = YAML.parse(text)\r\n      } catch (e) {\r\n        console.error(e)\r\n      }\r\n    },\r\n\r\n    async getVizDetails() {\r\n      if (this.config) {\r\n        this.validateYAML()\r\n        this.vizDetails = Object.assign({}, this.config) as VizDetail\r\n        this.setRadiusAndHeight()\r\n        return\r\n      }\r\n\r\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\r\n\r\n      if (hasYaml) {\r\n        await this.loadStandaloneYAMLConfig()\r\n      } else {\r\n        this.loadOutputTripsConfig()\r\n      }\r\n    },\r\n\r\n    loadOutputTripsConfig() {\r\n      let projection = 'EPSG:31468' // 'EPSG:25832', // 'EPSG:31468', // TODO: fix\r\n      if (!this.myState.thumbnail) {\r\n        projection = prompt('Enter projection: e.g. \"EPSG:31468\"') || 'EPSG:31468'\r\n        if (!!parseInt(projection, 10)) projection = 'EPSG:' + projection\r\n      }\r\n\r\n      this.vizDetails = {\r\n        title: 'Output Trips',\r\n        description: this.myState.yamlConfig,\r\n        file: this.myState.yamlConfig,\r\n        projection,\r\n        aggregations: {\r\n          'Trip Summary': [\r\n            { title: 'Origins', x: 'start_x', y: 'start_y' },\r\n            { title: 'Destinations', x: 'end_x', y: 'end_y' },\r\n          ],\r\n        },\r\n        radius: this.vizDetails.radius,\r\n        maxHeight: this.vizDetails.maxHeight,\r\n        center: this.vizDetails.center,\r\n        zoom: this.vizDetails.zoom,\r\n      }\r\n      this.$emit('title', this.vizDetails.title)\r\n      // this.solveProjection()\r\n      return\r\n    },\r\n\r\n    setRadiusAndHeight() {\r\n      if (!this.vizDetails.radius) this.vizDetails.radius = 250\r\n\r\n      if (!this.vizDetails.maxHeight) this.vizDetails.maxHeight = 0\r\n    },\r\n\r\n    async loadStandaloneYAMLConfig() {\r\n      try {\r\n        // might be a project config:\r\n        const filename =\r\n          this.myState.yamlConfig.indexOf('/') > -1\r\n            ? this.myState.yamlConfig\r\n            : this.myState.subfolder + '/' + this.myState.yamlConfig\r\n\r\n        const text = await this.fileApi.getFileText(filename)\r\n        this.standaloneYAMLconfig = Object.assign({}, YAML.parse(text))\r\n        this.validateYAML()\r\n        this.setVizDetails()\r\n      } catch (err) {\r\n        const e = err as any\r\n        console.log('failed')\r\n\r\n        this.$store.commit('setStatus', {\r\n          type: Status.ERROR,\r\n          msg: `File not found`,\r\n          desc: `Could not find: ${this.myState.subfolder}/${this.myState.yamlConfig}`,\r\n        })\r\n      }\r\n    },\r\n\r\n    validateYAML() {\r\n      console.log('in yaml validation 2')\r\n\r\n      const hasYaml = new RegExp('.*(yml|yaml)$').test(this.myState.yamlConfig)\r\n      let configuration = {} as any\r\n\r\n      if (hasYaml) {\r\n        console.log('has yaml')\r\n        configuration = this.standaloneYAMLconfig\r\n      } else {\r\n        console.log('no yaml')\r\n        configuration = this.config\r\n      }\r\n\r\n      for (const key in this.YAMLrequirementsXY) {\r\n        if (!(key in configuration)) {\r\n          this.$store.commit('setStatus', {\r\n            type: Status.ERROR,\r\n            msg: `${this.yamlConfig}: missing required key: ${key}`,\r\n            desc: 'Check this.YAMLrequirementsXY for required keys',\r\n          })\r\n        }\r\n      }\r\n\r\n      if (configuration.radius == 0) {\r\n        this.$store.commit('setStatus', {\r\n          type: Status.WARNING,\r\n          msg: `Radius set to zero`,\r\n          desc: 'Radius can not be zero, preset value used instead. ',\r\n        })\r\n      }\r\n\r\n      if (configuration.zoom < 5 || configuration.zoom > 20) {\r\n        this.$store.commit('setStatus', {\r\n          type: Status.WARNING,\r\n          msg: `Zoom is out of the recommended range `,\r\n          desc: 'Zoom levels should be between 5 and 20. ',\r\n        })\r\n      }\r\n    },\r\n\r\n    setVizDetails() {\r\n      this.vizDetails = Object.assign({}, this.vizDetails, this.standaloneYAMLconfig)\r\n\r\n      this.setRadiusAndHeight()\r\n\r\n      const t = this.vizDetails.title ? this.vizDetails.title : 'Hex Aggregation'\r\n      this.$emit('title', t)\r\n    },\r\n\r\n    async buildThumbnail() {\r\n      if (this.thumbnail && this.vizDetails.thumbnail) {\r\n        try {\r\n          const blob = await this.fileApi.getFileBlob(\r\n            this.myState.subfolder + '/' + this.vizDetails.thumbnail\r\n          )\r\n          const buffer = await blob.arrayBuffer()\r\n          const base64 = util.arrayBufferToBase64(buffer)\r\n          if (base64)\r\n            this.thumbnailUrl = `center / cover no-repeat url(data:image/png;base64,${base64})`\r\n        } catch (e) {\r\n          console.error(e)\r\n        }\r\n      }\r\n    },\r\n    handleShowSelectionButton() {\r\n      const arrays = Object.values(this.multiSelectedHexagons)\r\n      let points: any[] = []\r\n      arrays.map(a => (points = points.concat(a)))\r\n\r\n      const pickedObject = { object: { points } }\r\n      this.flipViewToShowInvertedData(pickedObject)\r\n    },\r\n\r\n    selectedHexagonStatistics(): {\r\n      rows: number\r\n      numHexagons: number\r\n      selectedHexagonIds: any[]\r\n    } | null {\r\n      const selectedHexes = Object.keys(this.multiSelectedHexagons).map(a => parseInt(a))\r\n      if (!selectedHexes.length) return null\r\n\r\n      const arrays = Object.values(this.multiSelectedHexagons)\r\n      const ll = arrays.reduce((a: number, v: any) => a + v.length, 0)\r\n\r\n      return { rows: ll, numHexagons: selectedHexes.length, selectedHexagonIds: selectedHexes }\r\n    },\r\n\r\n    async setMapCenter() {\r\n      const data = Object.values(this.rowCache)[0].raw\r\n\r\n      // If user gave us the center, use it\r\n      if (this.vizDetails.center) {\r\n        if (typeof this.vizDetails.center == 'string') {\r\n          this.vizDetails.center = this.vizDetails.center.split(',').map(Number)\r\n        }\r\n\r\n        const view = {\r\n          longitude: this.vizDetails.center[0],\r\n          latitude: this.vizDetails.center[1],\r\n          bearing: 0,\r\n          pitch: 0,\r\n          zoom: this.vizDetails.zoom || 10, // use 10 default if we don't have a zoom\r\n          jump: false, // move the map no matter what\r\n        }\r\n\r\n        // bounce our map\r\n        if (REACT_VIEW_HANDLES[this.id]) REACT_VIEW_HANDLES[this.id](view)\r\n\r\n        return\r\n      }\r\n\r\n      // user didn't give us the center, so calculate it\r\n      if (!data.length) return\r\n\r\n      let samples = 0\r\n      let longitude = 0\r\n      let latitude = 0\r\n\r\n      const numLinks = data.length / 2\r\n\r\n      const gap = 512\r\n      for (let i = 0; i < numLinks; i += gap) {\r\n        longitude += data[i * 2]\r\n        latitude += data[i * 2 + 1]\r\n        samples++\r\n      }\r\n\r\n      longitude = longitude / samples\r\n      latitude = latitude / samples\r\n\r\n      const currentView = this.$store.state.viewState\r\n\r\n      if (longitude && latitude) {\r\n        this.$store.commit('setMapCamera', {\r\n          longitude,\r\n          latitude,\r\n          bearing: currentView.bearing,\r\n          pitch: currentView.pitch,\r\n          zoom: this.vizDetails.zoom || currentView.zoom,\r\n          jump: false,\r\n        })\r\n      }\r\n    },\r\n\r\n    setupLogoMover() {\r\n      this.resizer = new ResizeObserver(this.moveLogo)\r\n      const deckmap = document.getElementById(`id-${this.id}`) as HTMLElement\r\n      this.resizer.observe(deckmap)\r\n    },\r\n\r\n    moveLogo() {\r\n      const deckmap = document.getElementById(`id-${this.id}`) as HTMLElement\r\n      const logo = deckmap?.querySelector('.mapboxgl-ctrl-bottom-left') as HTMLElement\r\n      if (logo) {\r\n        const right = deckmap.clientWidth > 640 ? '280px' : '36px'\r\n        logo.style.right = right\r\n      }\r\n    },\r\n\r\n    async parseCSVFile(filename: string) {\r\n      this.myState.statusMessage = 'Loading file...'\r\n\r\n      // get the raw unzipped arraybuffer\r\n      this.gzipWorker = new CSVParserWorker()\r\n\r\n      this.gzipWorker.onmessage = async (buffer: MessageEvent) => {\r\n        if (buffer.data.status) {\r\n          this.myState.statusMessage = buffer.data.status\r\n        } else if (buffer.data.error) {\r\n          this.myState.statusMessage = buffer.data.error\r\n          this.$store.commit('setStatus', {\r\n            type: Status.ERROR,\r\n            msg: `Loading Error`,\r\n            desc: 'Error loading: ${this.myState.subfolder}/${this.vizDetails.file}',\r\n          })\r\n        } else {\r\n          const { rowCache, columnLookup } = buffer.data\r\n          if (this.gzipWorker) this.gzipWorker.terminate()\r\n          this.dataIsLoaded({ rowCache, columnLookup })\r\n        }\r\n      }\r\n\r\n      this.gzipWorker.postMessage({\r\n        filepath: filename,\r\n        fileSystem: this.fileSystem,\r\n        aggregations: this.vizDetails.aggregations,\r\n        projection: this.vizDetails.projection,\r\n      })\r\n    },\r\n\r\n    dataIsLoaded({ rowCache, columnLookup }: any) {\r\n      this.columnLookup = columnLookup\r\n      this.rowCache = rowCache\r\n\r\n      const agg = this.activeAggregation.replaceAll('~', '')\r\n      this.requests = this.rowCache[agg]\r\n\r\n      this.setMapCenter()\r\n      this.moveLogo()\r\n      this.myState.statusMessage = ''\r\n    },\r\n\r\n    async loadFiles() {\r\n      let dataArray: any = []\r\n      if (!this.fileApi) return { dataArray }\r\n\r\n      try {\r\n        let filename = `${this.myState.subfolder}/${this.vizDetails.file}`\r\n        await this.parseCSVFile(filename)\r\n      } catch (e) {\r\n        console.error(e)\r\n        this.myState.statusMessage = '' + e\r\n        this.$store.commit('setStatus', {\r\n          type: Status.ERROR,\r\n          msg: `Loading/Parsing Error`,\r\n          desc: 'Error loading/parsing: ${this.myState.subfolder}/${this.vizDetails.file}',\r\n        })\r\n      }\r\n    },\r\n  },\r\n  async mounted() {\r\n    this.$store.commit('setFullScreen', !this.thumbnail)\r\n\r\n    this.myState.thumbnail = this.thumbnail\r\n    this.myState.yamlConfig = this.yamlConfig || ''\r\n    this.myState.subfolder = this.subfolder\r\n\r\n    await this.getVizDetails()\r\n\r\n    if (this.thumbnail) return\r\n\r\n    this.setupLogoMover()\r\n\r\n    this.myState.statusMessage = `${this.$i18n.t('loading')}`\r\n    this.aggregations = this.vizDetails.aggregations\r\n\r\n    // console.log('loading files')\r\n    await this.loadFiles()\r\n\r\n    // this.mapState.center = this.findCenter(this.rawRequests)\r\n\r\n    this.buildThumbnail()\r\n\r\n    this.isLoaded = true\r\n    this.handleOrigDest(Object.keys(this.aggregations)[0], 0) // show first data\r\n  },\r\n\r\n  beforeDestroy() {\r\n    // MUST erase the React view handle to prevent gigantic memory leak!\r\n    REACT_VIEW_HANDLES[this.id] = undefined\r\n    delete REACT_VIEW_HANDLES[this.id]\r\n\r\n    try {\r\n      if (this.gzipWorker) {\r\n        this.gzipWorker.terminate()\r\n      }\r\n    } catch (e) {\r\n      console.warn(e)\r\n    }\r\n\r\n    this.$store.commit('setFullScreen', false)\r\n  },\r\n})\r\n\r\nexport default MyComponent\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@import '@/styles.scss';\r\n\r\n.xy-hexagons {\r\n  position: absolute;\r\n  top: 0;\r\n  bottom: 0;\r\n  left: 0;\r\n  right: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  min-height: $thumbnailHeight;\r\n  background: url('assets/thumbnail.jpg') center / cover no-repeat;\r\n  z-index: -1;\r\n}\r\n\r\n.xy-hexagons.hide-thumbnail {\r\n  background: none;\r\n  z-index: 0;\r\n}\r\n\r\n.message {\r\n  z-index: 5;\r\n  position: absolute;\r\n  bottom: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  box-shadow: 0px 2px 10px #22222222;\r\n  display: flex;\r\n  flex-direction: row;\r\n  margin: auto auto 0 0;\r\n  background-color: var(--bgPanel);\r\n  padding: 0.5rem 1.5rem;\r\n\r\n  a {\r\n    color: white;\r\n    text-decoration: none;\r\n\r\n    &.router-link-exact-active {\r\n      color: white;\r\n    }\r\n  }\r\n\r\n  p {\r\n    font-size: 1.2rem;\r\n    line-height: 1.5rem;\r\n    font-weight: normal;\r\n    color: var(--textFancy);\r\n  }\r\n}\r\n\r\n.speed-block {\r\n  margin-top: 1rem;\r\n}\r\n\r\n.legend-block {\r\n  margin-top: 2rem;\r\n}\r\n\r\n.speed-slider {\r\n  min-width: 6rem;\r\n}\r\n\r\n.status-message {\r\n  font-size: 1.5rem;\r\n  line-height: 1.75rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.big {\r\n  padding: 0.5rem 0;\r\n  font-size: 1.5rem;\r\n  line-height: 1.7rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.left-side {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  display: flex;\r\n  flex-direction: column;\r\n  font-size: 0.8rem;\r\n  pointer-events: auto;\r\n  margin: 0 0 0 0;\r\n}\r\n\r\n.control-panel {\r\n  position: absolute;\r\n  bottom: 0;\r\n  display: flex;\r\n  flex-direction: row;\r\n  font-size: 0.8rem;\r\n  margin: 0 0 0.5rem 0.5rem;\r\n  pointer-events: auto;\r\n  background-color: var(--bgPanel);\r\n  padding: 0.5rem 0.5rem;\r\n  filter: drop-shadow(0px 2px 4px #22222233);\r\n}\r\n\r\n.is-dashboard {\r\n  position: static;\r\n  margin: 0 0;\r\n  padding: 0.25rem 0 0 0;\r\n  filter: unset;\r\n  background-color: unset;\r\n}\r\n\r\n.hex-layer {\r\n  pointer-events: auto;\r\n}\r\n\r\n.speed-label {\r\n  font-size: 0.8rem;\r\n  font-weight: bold;\r\n}\r\n\r\n.tooltip {\r\n  padding: 5rem 5rem;\r\n  background-color: #ccc;\r\n}\r\n\r\n.panel-items {\r\n  margin: 0.5rem 0.5rem;\r\n}\r\n\r\n.panel-item {\r\n  display: flex;\r\n  flex-direction: column;\r\n  margin-right: 1rem;\r\n}\r\n\r\n.right {\r\n  margin-left: auto;\r\n}\r\n\r\ninput {\r\n  border: none;\r\n  background-color: #235;\r\n  color: #ccc;\r\n}\r\n\r\n.row {\r\n  display: 'grid';\r\n  grid-template-columns: 'auto 1fr';\r\n}\r\n\r\n.drawing-tool {\r\n  position: absolute;\r\n  top: 0;\r\n  right: 0;\r\n  pointer-events: none;\r\n}\r\n\r\n@media only screen and (max-width: 640px) {\r\n  .message {\r\n    padding: 0.5rem 0.5rem;\r\n  }\r\n\r\n  .right-side {\r\n    font-size: 0.7rem;\r\n  }\r\n\r\n  .big {\r\n    padding: 0 0rem;\r\n    margin-top: 0.5rem;\r\n    font-size: 1.3rem;\r\n    line-height: 2rem;\r\n  }\r\n}\r\n</style>\r\n","\r\n.xy-hexagons(:class=\"{'hide-thumbnail': !thumbnail}\" oncontextmenu=\"return false\" :id=\"`id-${id}`\")\r\n\r\n  xy-hex-deck-map.hex-layer(\r\n    v-if=\"!thumbnail && isLoaded\"\r\n    v-bind=\"mapProps\"\r\n  )\r\n\r\n  zoom-buttons(v-if=\"!thumbnail\")\r\n  drawing-tool.drawing-tool(v-if=\"!thumbnail\")\r\n\r\n  .left-side(v-if=\"isLoaded && !thumbnail && vizDetails.title\")\r\n    collapsible-panel(direction=\"left\" :locked=\"true\")\r\n      .panel-items(v-if=\"hexStats\" style=\"color: #c0f;\")\r\n        p.big(style=\"margin-top: 2rem;\") {{ $t('selection') }}:\r\n        h3(style=\"margin-top: -1rem;\") {{ $t('areas') }}: {{ hexStats.numHexagons }}, {{ $t('count') }}: {{ hexStats.rows }}\r\n        button.button(style=\"color: #c0f; border-color: #c0f\" @click=\"handleShowSelectionButton\") {{ $t('showDetails') }}\r\n\r\n  .control-panel(v-if=\"isLoaded && !thumbnail && !myState.statusMessage\")\r\n        //- :class=\"{'is-dashboard': config !== undefined }\"\r\n\r\n        .panel-item(v-for=\"group in Object.keys(aggregations)\" :key=\"group\")\r\n          p.speed-label {{ group }}\r\n          button.button.is-small.aggregation-button(\r\n            v-for=\"element,i in aggregations[group]\"\r\n            :key=\"i\"\r\n            :style=\"{'margin-bottom': '0.25rem', 'color': activeAggregation===`${group}~${i}` ? 'white' : buttonColors[i], 'border': `1px solid ${buttonColors[i]}`, 'border-right': `0.4rem solid ${buttonColors[i]}`,'border-radius': '4px', 'background-color': activeAggregation===`${group}~${i}` ? buttonColors[i] : $store.state.isDarkMode ? '#333':'white'}\"\r\n            @click=\"handleOrigDest(group,i)\") {{ element.title }}\r\n\r\n        .panel-item.right\r\n          p.speed-label {{ $t('maxHeight') }}: {{ vizDetails.maxHeight }}\r\n          vue-slider.speed-slider(v-model=\"vizDetails.maxHeight\"\r\n            :min=\"0\" :max=\"250\" :interval=\"5\"\r\n            :duration=\"0\" :dotSize=\"12\"\r\n            tooltip=\"none\"\r\n          )\r\n\r\n          p.speed-label Hex Radius: {{ vizDetails.radius }}\r\n          vue-slider.speed-slider(v-model=\"vizDetails.radius\"\r\n            :min=\"50\" :max=\"1000\" :interval=\"5\"\r\n            :duration=\"0\" :dotSize=\"12\"\r\n            tooltip=\"none\"\r\n          )\r\n\r\n  .message(v-if=\"!thumbnail && myState.statusMessage\")\r\n    p.status-message {{ myState.statusMessage }}\r\n\r\n"],"names":["ColumnGeometry","Geometry","props","id","uid","indices","attributes","tesselateColumn","radius","height","nradial","vertices","log","v","modifyPolygonWindingDirection","WINDING","isExtruded","vertsAroundEdge","numVertices","stepAngle","positions","normals","i","j","a","vertexIndex","sin","cos","k","index","vs","fs","DEFAULT_COLOR","defaultProps","x","ColumnLayer","Layer","gl","transpileToGLSL100","isWebGL2","defines","useDerivatives","hasFeature","FEATURES","project32","phongLighting","gouraudLighting","picking","params","oldProps","changeFlags","regenerateModels","_this$state$model","diskResolution","hasThinkness","geometry","meanVertexDistance","p","Model","extruded","stroked","uniforms","lineWidthUnits","lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","radiusUnits","elevationScale","filled","wireframe","offset","coverage","angle","model","fillVertexCount","wireframeVertexCount","edgeDistance","UNIT","_defineProperty","AGGREGATION_OPERATION","sumReducer","accu","cur","maxReducer","minReducer","getMean","pts","accessor","filtered","getSum","getMax","getMin","getValueFunc","aggregation","context","op","wrapAccessor","pt","wrapGetValueFunc","getValue","defaultColorRange","filterProps","filterKeys","filteredProps","key","AggregationLayer","CompositeLayer","args","dimensions","opts","shaders","changedAttributes","viewport","mousePosition","cssToDeviceRatio","updateOpts","compareAll","dimension","ignoreProps","dataProps","accessors","updateTriggersChanged","compareProps","name","isObjectEmpty","AttributeManager","obj","isEmpty","getScale","domain","range","scaleFunction","scale","getQuantizeScale","value","quantizeScale","getLinearScale","linearScale","getQuantileScale","sortedDomain","ascending","n","thresholds","threshold","thresholdsScale","b","fraction","domainLength","domainFraction","lowIndex","low","high","bisectRight","lo","hi","mid","ordinalScale","domainMap","d","getOrdinalScale","uniqueDomain","domainRange","step","idx","clampIdx","notNullOrUndefined","unique","values","results","getTruthyValues","data","valueAccessor","getQuantileDomain","getOrdinalDomain","clamp","min","max","getScaleFunctionByScaleType","scaleType","defaultGetValue","points","MAX_32_BIT_FLOAT","defaultGetPoints","bin","defaultGetIndex","BinSorter","bins","getPoints","getIndex","filterData","hasFilter","binCount","aggregatedBins","binIndex","filteredPoints","percentileRange","len","lower","upper","lowerIdx","upperIdx","binMap","maxCount","maxValue","minValue","totalCount","idxRange","indexEdge","nop","dimensionSteps","defaultDimensions","defaultGetCellSize","CPUAggregator","aggregationParams","reprojectNeeded","aggregationDirty","f","updateObject","result","weight","pickingInfo","getBins","getDomain","getScaleFunc","nullValue","dimensionStep","item","updaters","needUpdate","_updateTriggers","updateTriggers","prop","updateTrigger","fromProp","dimensionUpdater","sortedBins","lowerPercentile","upperPercentile","valueDomain","onSet","dimensionRange","dimensionDomain","scaleFunc","cell","cv","info","isPicked","object","binInfo","dimensionKey","thirdPi","angles","pointX","pointY","hexbin","x0","y0","x1","y1","y","r","dx","dy","binsById","px","point","py","pj","pi","py1","px1","pi2","pj2","px2","py2","hexagon","centers","fragment","_","pointToHexbin","centerLngLat","getPointsCenter","radiusCommon","getRadiusInCommon","screenPoints","iterable","objectInfo","createIterable","size","posIndex","position","hex","minX","minY","maxX","maxY","center","unitsPerMeter","HexagonLayer","cpuAggregator","aggregatorState","hexagonVertices","vertex0","vertex3","centroid","centroidFlat","metersPerUnit","vt","vtFlat","material","transitions","SubLayerClass","ambient","diffuse","shininess","specularColor","INITIAL_VIEW","zoom","longitude","latitude","pitch","bearing","viewId","colorRamp","dark","raw","Float32Array","length","extrude","highlights","mapIsIndependent","maxHeight","metric","selectedHexStats","rows","numHexagons","selectedHexagonIds","onClick","viewState","setViewState","useState","REACT_VIEW_HANDLES","view","globalStore","state","handleViewState","commit","colors","colormap","nshades","format","alpha","map","c","getTooltip","lat","lng","count","html","Number","isFinite","toFixed","style","color","backgroundColor","handleClick","target","event","row","getPosition","layers","ArcLayer","getSourcePosition","getTargetPosition","pickable","opacity","getHeight","getWidth","getSourceColor","getTargetColor","colorRange","slice","reverse","autoHighlight","elevationRange","type","duration","React","createElement","DeckGL","controller","useDevicePixels","onViewStateChange","e","StaticMap","mapStyle","getters","preventStyleDiffing","mapboxApiAccessToken","MAPBOX_TOKEN","i18n","MyComponent","defineComponent","CollapsiblePanel","DrawingTool","XyHexDeckMap","VueSlider","ToggleButton","ZoomButtons","colorRamps","HTTPFileSystem","svnProject","group","lightmode","darkmode","ColorScheme","pickedObject","_a","parts","suffix","revSuffix","origKey","origArray","inverseArray","arcFilteredRows","zoffset","coords","groupName","number","cacheKey","text","YAML","projection","filename","Status","hasYaml","configuration","buffer","base64","util","arrays","selectedHexes","samples","numLinks","gap","currentView","deckmap","logo","right","CSVParserWorker","rowCache","columnLookup","agg","dataArray","render","_vm","_h","_c","element","$event","$$v","staticRenderFns"],"mappings":"25BAGe,MAAMA,WAAuBC,EAAS,CACnD,YAAYC,EAAO,CACjB,KAAM,CACJ,GAAAC,EAAKC,GAAI,iBAAiB,CAC3B,EAAGF,EACE,CACJ,QAAAG,EACA,WAAAC,CACN,EAAQC,GAAgBL,CAAK,EACzB,MAAM,CAAE,GAAGA,EACT,GAAAC,EACA,QAAAE,EACA,WAAAC,CACN,CAAK,CACF,CAEH,CAEA,SAASC,GAAgBL,EAAO,CAC9B,KAAM,CACJ,OAAAM,EACA,OAAAC,EAAS,EACT,QAAAC,EAAU,EACX,EAAGR,EACJ,GAAI,CACF,SAAAS,CACD,EAAGT,EAEAS,IACFC,EAAI,OAAOD,EAAS,QAAUD,CAAO,EACrCC,EAAWA,EAAS,QAAQE,GAAK,CAACA,EAAE,GAAIA,EAAE,EAAE,CAAC,EAC7CC,GAA8BH,EAAUI,GAAQ,iBAAiB,GAGnE,MAAMC,EAAaP,EAAS,EACtBQ,EAAkBP,EAAU,EAC5BQ,EAAcF,EAAaC,EAAkB,EAAI,EAAIP,EACrDS,EAAY,KAAK,GAAK,EAAIT,EAC1BL,EAAU,IAAI,YAAYW,EAAaN,EAAU,EAAI,EAAI,CAAC,EAC1DU,EAAY,IAAI,aAAaF,EAAc,CAAC,EAC5CG,EAAU,IAAI,aAAaH,EAAc,CAAC,EAChD,IAAII,EAAI,EAER,GAAIN,EAAY,CACd,QAASO,EAAI,EAAGA,EAAIN,EAAiBM,IAAK,CACxC,MAAMC,EAAID,EAAIJ,EACRM,EAAcF,EAAIb,EAClBgB,EAAM,KAAK,IAAIF,CAAC,EAChBG,EAAM,KAAK,IAAIH,CAAC,EAEtB,QAASI,EAAI,EAAGA,EAAI,EAAGA,IACrBR,EAAUE,EAAI,GAAKX,EAAWA,EAASc,EAAc,GAAKE,EAAMnB,EAChEY,EAAUE,EAAI,GAAKX,EAAWA,EAASc,EAAc,EAAI,GAAKC,EAAMlB,EACpEY,EAAUE,EAAI,IAAM,EAAI,EAAIM,GAAKnB,EACjCY,EAAQC,EAAI,GAAKX,EAAWA,EAASc,EAAc,GAAKE,EACxDN,EAAQC,EAAI,GAAKX,EAAWA,EAASc,EAAc,EAAI,GAAKC,EAC5DJ,GAAK,CAER,CAEDF,EAAUE,EAAI,GAAKF,EAAUE,EAAI,GACjCF,EAAUE,EAAI,GAAKF,EAAUE,EAAI,GACjCF,EAAUE,EAAI,GAAKF,EAAUE,EAAI,GACjCA,GAAK,CACN,CAED,QAASC,EAAIP,EAAa,EAAI,EAAGO,EAAIN,EAAiBM,IAAK,CACzD,MAAMV,EAAI,KAAK,MAAMU,EAAI,CAAC,EAAI,KAAK,KAAK,GAAMA,EAAI,CAAC,EAC7CC,EAAIX,EAAIM,EACRM,GAAeZ,EAAIH,GAAWA,EAC9BgB,EAAM,KAAK,IAAIF,CAAC,EAChBG,EAAM,KAAK,IAAIH,CAAC,EACtBJ,EAAUE,EAAI,GAAKX,EAAWA,EAASc,EAAc,GAAKE,EAAMnB,EAChEY,EAAUE,EAAI,GAAKX,EAAWA,EAASc,EAAc,EAAI,GAAKC,EAAMlB,EACpEY,EAAUE,EAAI,GAAKb,EAAS,EAC5BY,EAAQC,EAAI,GAAK,EACjBA,GAAK,CACN,CAED,GAAIN,EAAY,CACd,IAAIa,EAAQ,EAEZ,QAASN,EAAI,EAAGA,EAAIb,EAASa,IAC3BlB,EAAQwB,KAAWN,EAAI,EAAI,EAC3BlB,EAAQwB,KAAWN,EAAI,EAAI,EAC3BlB,EAAQwB,KAAWN,EAAI,EAAI,EAC3BlB,EAAQwB,KAAWN,EAAI,EAAI,EAC3BlB,EAAQwB,KAAWN,EAAI,EAAI,EAC3BlB,EAAQwB,KAAWN,EAAI,EAAI,CAE9B,CAED,MAAO,CACL,QAAAlB,EACA,WAAY,CACV,SAAU,CACR,KAAM,EACN,MAAOe,CACR,EACD,OAAQ,CACN,KAAM,EACN,MAAOC,CACR,CACF,CACL,CACA,CC5GA,IAAAS,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECAfC,GAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,ECMf,MAAMC,EAAgB,CAAC,EAAG,EAAG,EAAG,GAAG,EAC7BC,GAAe,CACnB,eAAgB,CACd,KAAM,SACN,IAAK,EACL,MAAO,EACR,EACD,SAAU,KACV,OAAQ,CACN,KAAM,SACN,IAAK,EACL,MAAO,GACR,EACD,MAAO,CACL,KAAM,SACN,MAAO,CACR,EACD,OAAQ,CACN,KAAM,QACN,MAAO,CAAC,EAAG,CAAC,CACb,EACD,SAAU,CACR,KAAM,SACN,IAAK,EACL,IAAK,EACL,MAAO,CACR,EACD,eAAgB,CACd,KAAM,SACN,IAAK,EACL,MAAO,CACR,EACD,YAAa,SACb,eAAgB,SAChB,eAAgB,EAChB,mBAAoB,EACpB,mBAAoB,OAAO,iBAC3B,SAAU,GACV,UAAW,GACX,OAAQ,GACR,QAAS,GACT,YAAa,CACX,KAAM,WACN,MAAOC,GAAKA,EAAE,QACf,EACD,aAAc,CACZ,KAAM,WACN,MAAOF,CACR,EACD,aAAc,CACZ,KAAM,WACN,MAAOA,CACR,EACD,aAAc,CACZ,KAAM,WACN,MAAO,CACR,EACD,aAAc,CACZ,KAAM,WACN,MAAO,GACR,EACD,SAAU,GACV,SAAU,CACR,cAAe,CAAC,eAAgB,cAAc,CAC/C,CACH,EACe,MAAMG,UAAoBC,EAAM,CAC7C,YAAa,CACX,KAAM,CACJ,GAAAC,CACN,EAAQ,KAAK,QACHC,EAAqB,CAACC,GAASF,CAAE,EACjCG,EAAU,CAAA,EACVC,EAAiB,KAAK,MAAM,aAAeC,GAAWL,EAAIM,GAAS,gBAAgB,EAEzF,OAAIF,IACFD,EAAQ,aAAe,GAGlB,MAAM,WAAW,CACtB,GAAAV,GACA,GAAAC,GACA,QAAAS,EACA,mBAAAF,EACA,QAAS,CAACM,GAAWH,EAAiBI,GAAgBC,GAAiBC,EAAO,CACpF,CAAK,CACF,CAED,iBAAkB,CACS,KAAK,sBACb,aAAa,CAC5B,kBAAmB,CACjB,KAAM,EACN,KAAM,KACN,KAAM,KAAK,kBAAmB,EAC9B,WAAY,GACZ,SAAU,aACX,EACD,mBAAoB,CAClB,KAAM,EACN,WAAY,GACZ,SAAU,cACX,EACD,mBAAoB,CAClB,KAAM,KAAK,MAAM,YAAY,OAC7B,KAAM,KACN,WAAY,GACZ,WAAY,GACZ,SAAU,eACV,aAAcf,CACf,EACD,mBAAoB,CAClB,KAAM,KAAK,MAAM,YAAY,OAC7B,KAAM,KACN,WAAY,GACZ,WAAY,GACZ,SAAU,eACV,aAAcA,CACf,EACD,qBAAsB,CACpB,KAAM,EACN,SAAU,eACV,WAAY,EACb,CACP,CAAK,CACF,CAED,YAAYgB,EAAQ,CAClB,MAAM,YAAYA,CAAM,EACxB,KAAM,CACJ,MAAA9C,EACA,SAAA+C,EACA,YAAAC,CACD,EAAGF,EACEG,EAAmBD,EAAY,mBAAqBhD,EAAM,cAAgB+C,EAAS,YAEzF,GAAIE,EAAkB,CACpB,IAAIC,EAEJ,KAAM,CACJ,GAAAf,CACR,EAAU,KAAK,SACRe,EAAoB,KAAK,MAAM,SAAW,MAAQA,IAAsB,QAAkBA,EAAkB,OAAM,EACnH,KAAK,MAAM,MAAQ,KAAK,UAAUf,CAAE,EACpC,KAAK,sBAAsB,eAC5B,EAEGc,GAAoBjD,EAAM,iBAAmB+C,EAAS,gBAAkB/C,EAAM,WAAa+C,EAAS,WAAa/C,EAAM,UAAYA,EAAM,YAAc+C,EAAS,UAAYA,EAAS,WACvL,KAAK,gBAAgB/C,CAAK,CAE7B,CAED,YAAYmD,EAAgB1C,EAAU2C,EAAc,CAClD,MAAMC,EAAW,IAAIvD,GAAe,CAClC,OAAQ,EACR,OAAQsD,EAAe,EAAI,EAC3B,SAAA3C,EACA,QAAS0C,CACf,CAAK,EACD,IAAIG,EAAqB,EAEzB,GAAI7C,EACF,QAASW,EAAI,EAAGA,EAAI+B,EAAgB/B,IAAK,CACvC,MAAMmC,EAAI9C,EAASW,GAEnBkC,GADU,KAAK,KAAKC,EAAE,GAAKA,EAAE,GAAKA,EAAE,GAAKA,EAAE,EAAE,EACnBJ,CAC3B,MAEDG,EAAqB,EAGvB,YAAK,SAAS,CACZ,aAAc,KAAK,IAAI,KAAK,GAAKH,CAAc,EAAIG,CACzD,CAAK,EACMD,CACR,CAED,UAAUlB,EAAI,CACZ,OAAO,IAAIqB,GAAMrB,EAAI,CAAE,GAAG,KAAK,WAAY,EACzC,GAAI,KAAK,MAAM,GACf,YAAa,EACnB,CAAK,CACF,CAED,gBAAgB,CACd,eAAAgB,EACA,SAAA1C,EACA,SAAAgD,EACA,QAAAC,CACJ,EAAK,CACD,MAAML,EAAW,KAAK,YAAYF,EAAgB1C,EAAUgD,GAAYC,CAAO,EAC/E,KAAK,SAAS,CACZ,gBAAiBL,EAAS,WAAW,SAAS,MAAM,OAAS,EAC7D,qBAAsBA,EAAS,QAAQ,MAAM,MACnD,CAAK,EACD,KAAK,MAAM,MAAM,SAAS,CACxB,SAAAA,CACN,CAAK,CACF,CAED,KAAK,CACH,SAAAM,CACJ,EAAK,CACD,KAAM,CACJ,eAAAC,EACA,eAAAC,EACA,mBAAAC,EACA,mBAAAC,EACA,YAAAC,EACA,eAAAC,EACA,SAAAR,EACA,OAAAS,EACA,QAAAR,EACA,UAAAS,EACA,OAAAC,EACA,SAAAC,EACA,OAAA/D,EACA,MAAAgE,CACN,EAAQ,KAAK,MACH,CACJ,MAAAC,EACA,gBAAAC,EACA,qBAAAC,EACA,aAAAC,CACN,EAAQ,KAAK,MACTH,EAAM,YAAYZ,CAAQ,EAAE,YAAY,CACtC,OAAArD,EACA,MAAOgE,EAAQ,IAAM,KAAK,GAC1B,OAAAF,EACA,SAAAX,EACA,QAAAC,EACA,SAAAW,EACA,eAAAJ,EACA,aAAAS,EACA,YAAaC,EAAKX,GAClB,WAAYW,EAAKf,GACjB,WAAYC,EACZ,eAAgBC,EAChB,eAAgBC,CACtB,CAAK,EAEGN,GAAYU,IACdI,EAAM,SAAS,CACb,UAAW,EACnB,CAAO,EACDA,EAAM,eAAeE,CAAoB,EAAE,YAAY,CAAC,EAAE,YAAY,CACpE,SAAU,EAClB,CAAO,EAAE,KAAI,GAGLP,IACFK,EAAM,SAAS,CACb,UAAW,EACnB,CAAO,EACDA,EAAM,eAAeC,CAAe,EAAE,YAAY,CAAC,EAAE,YAAY,CAC/D,SAAU,EAClB,CAAO,EAAE,KAAI,GAGL,CAACf,GAAYC,IACfa,EAAM,SAAS,CACb,UAAW,EACnB,CAAO,EACDA,EAAM,eAAeC,EAAkB,EAAI,CAAC,EAAE,YAAY,CAAC,EAAE,YAAY,CACvE,SAAU,EAClB,CAAO,EAAE,KAAI,EAEV,CAEH,CAEAI,EAAgB3C,EAAa,YAAa,aAAa,EAEvD2C,EAAgB3C,EAAa,eAAgBF,EAAY,8FCvRlD,MAAM8C,EAAwB,CACnC,IAAK,EACL,KAAM,EACN,IAAK,EACL,IAAK,CACP,EAEA,SAASC,EAAWC,EAAMC,EAAK,CAC7B,OAAOD,EAAOC,CAChB,CAEA,SAASC,GAAWF,EAAMC,EAAK,CAC7B,OAAOA,EAAMD,EAAOC,EAAMD,CAC5B,CAEA,SAASG,GAAWH,EAAMC,EAAK,CAC7B,OAAOA,EAAMD,EAAOC,EAAMD,CAC5B,CAEO,SAASI,GAAQC,EAAKC,EAAU,CACrC,GAAI,OAAO,SAASA,CAAQ,EAC1B,OAAOD,EAAI,OAASC,EAAW,KAGjC,MAAMC,EAAWF,EAAI,IAAIC,CAAQ,EAAE,OAAO,OAAO,QAAQ,EACzD,OAAOC,EAAS,OAASA,EAAS,OAAOR,EAAY,CAAC,EAAIQ,EAAS,OAAS,IAC9E,CACO,SAASC,GAAOH,EAAKC,EAAU,CACpC,GAAI,OAAO,SAASA,CAAQ,EAC1B,OAAOD,EAAI,OAASA,EAAI,OAASC,EAAW,KAG9C,MAAMC,EAAWF,EAAI,IAAIC,CAAQ,EAAE,OAAO,OAAO,QAAQ,EACzD,OAAOC,EAAS,OAASA,EAAS,OAAOR,EAAY,CAAC,EAAI,IAC5D,CACO,SAASU,GAAOJ,EAAKC,EAAU,CACpC,GAAI,OAAO,SAASA,CAAQ,EAC1B,OAAOD,EAAI,OAASC,EAAW,KAGjC,MAAMC,EAAWF,EAAI,IAAIC,CAAQ,EAAE,OAAO,OAAO,QAAQ,EACzD,OAAOC,EAAS,OAASA,EAAS,OAAOL,GAAY,IAAS,EAAI,IACpE,CACO,SAASQ,GAAOL,EAAKC,EAAU,CACpC,GAAI,OAAO,SAASA,CAAQ,EAC1B,OAAOD,EAAI,OAASC,EAAW,KAGjC,MAAMC,EAAWF,EAAI,IAAIC,CAAQ,EAAE,OAAO,OAAO,QAAQ,EACzD,OAAOC,EAAS,OAASA,EAAS,OAAOJ,GAAY,GAAQ,EAAI,IACnE,CACO,SAASQ,GAAaC,EAAaN,EAAUO,EAAS,CAC3D,MAAMC,EAAKhB,EAAsBc,IAAgBd,EAAsB,IAGvE,OAFAQ,EAAWS,GAAaT,EAAUO,CAAO,EAEjCC,QACDhB,EAAsB,IACzB,OAAOO,GAAOK,GAAOL,EAAKC,CAAQ,OAE/BR,EAAsB,IACzB,OAAOO,GAAOG,GAAOH,EAAKC,CAAQ,OAE/BR,EAAsB,KACzB,OAAOO,GAAOD,GAAQC,EAAKC,CAAQ,OAEhCR,EAAsB,IACzB,OAAOO,GAAOI,GAAOJ,EAAKC,CAAQ,UAGlC,OAAO,KAEb,CAEA,SAASS,GAAaT,EAAUO,EAAU,GAAI,CAC5C,OAAI,OAAO,SAASP,CAAQ,EACnBA,EAGFU,IACLH,EAAQ,MAAQG,EAAG,MACZV,EAASU,EAAG,OAAQH,CAAO,EAEtC,CAEO,SAASI,GAAiBC,EAAUL,EAAU,GAAI,CACvD,OAAOR,IACLQ,EAAQ,QAAUR,EAAI,IAAIW,GAAMA,EAAG,KAAK,EACjCE,EAASb,EAAI,IAAIW,GAAMA,EAAG,MAAM,EAAGH,CAAO,EAErD,CCzFO,MAAMM,GAAoB,CAAC,CAAC,IAAK,IAAK,GAAG,EAAG,CAAC,IAAK,IAAK,GAAG,EAAG,CAAC,IAAK,IAAK,EAAE,EAAG,CAAC,IAAK,IAAK,EAAE,EAAG,CAAC,IAAK,GAAI,EAAE,EAAG,CAAC,IAAK,EAAG,EAAE,CAAC,ECAxH,SAASC,GAAYnG,EAAOoG,EAAY,CAC7C,MAAMC,EAAgB,CAAA,EAEtB,UAAWC,KAAOtG,EACXoG,EAAW,SAASE,CAAG,IAC1BD,EAAcC,GAAOtG,EAAMsG,IAI/B,OAAOD,CACT,CCNe,MAAME,UAAyBC,EAAe,CAC3D,eAAeC,EAAM,CACnB,MAAM,GAAGA,CAAI,EAEb7B,EAAgB,KAAM,QAAS,MAAM,CACtC,CAED,2BAA2B8B,EAAY,CACrC,MAAM,gBAAgB,KAAK,OAAO,EAClC,KAAK,SAAS,CACZ,YAAaP,GAAY,KAAK,YAAY,WAAYO,EAAW,KAAK,KAAK,EAC3E,WAAAA,CACN,CAAK,CACF,CAED,YAAYC,EAAM,CAChB,MAAM,YAAYA,CAAI,EACtB,KAAM,CACJ,YAAA3D,CACD,EAAG2D,EAEJ,GAAI3D,EAAY,kBAAmB,CACjC,MAAM4D,EAAU,KAAK,WAAW,CAAE,CAAA,EAE9BA,GAAWA,EAAQ,UACrBA,EAAQ,QAAQ,oBAAsB,GAGxC,KAAK,cAAcA,CAAO,CAC3B,CAED,KAAK,kBAAiB,CACvB,CAED,iBAAiBC,EAAmB,CAClC,KAAK,SAAS,CACZ,kBAAAA,CACN,CAAK,CACF,CAED,eAAgB,CACd,OAAO,KAAK,sBAAsB,qBACnC,CAED,mBAAoB,CAClB,KAAM,CACJ,SAAAC,EACA,cAAAC,EACA,GAAA5E,CACN,EAAQ,KAAK,QAOT,OANuB,OAAO,OAAO,OAAO,OAAO,KAAK,KAAK,EAAG,CAC9D,SAAA2E,EACA,cAAAC,EACA,cAAe,EACf,iBAAkBC,GAAiB7E,CAAE,CAC3C,CAAK,CAEF,CAED,cAAcyE,EAAS,CAAE,CAEzB,mBAAmBK,EAAYnE,EAAS,GAAI,CAC1C,KAAM,CACJ,MAAA9C,EACA,SAAA+C,EACA,YAAAC,CACD,EAAGiE,EACE,CACJ,WAAAC,EAAa,GACb,UAAAC,CACD,EAAGrE,EACE,CACJ,YAAAsE,CACN,EAAQ,KAAK,MACH,CACJ,MAAOC,EACP,UAAAC,EAAY,CAAE,CACf,EAAGH,EACE,CACJ,sBAAAI,CACD,EAAGvE,EAEJ,GAAIA,EAAY,YACd,MAAO,GAGT,GAAIuE,EAAuB,CACzB,GAAIA,EAAsB,IACxB,MAAO,GAGT,UAAWlC,KAAYiC,EACrB,GAAIC,EAAsBlC,GACxB,MAAO,EAGZ,CAED,GAAI6B,EACF,OAAIlE,EAAY,kBACP,GAGFwE,GAAa,CAClB,SAAAzE,EACA,SAAU/C,EACV,YAAAoH,EACA,UAAW,KAAK,YAAY,UACpC,CAAO,EAGH,UAAWK,KAAQJ,EACjB,GAAIrH,EAAMyH,KAAU1E,EAAS0E,GAC3B,MAAO,GAIX,MAAO,EACR,CAED,mBAAmBA,EAAM,CACvB,KAAM,CACJ,kBAAAZ,CACN,EAAQ,KAAK,MAET,OAAKY,EAIEZ,GAAqBA,EAAkBY,KAAU,OAH/C,CAACC,GAAcb,CAAiB,CAI1C,CAED,sBAAuB,CACrB,OAAO,IAAIc,GAAiB,KAAK,QAAQ,GAAI,CAC3C,GAAI,KAAK,MAAM,GACf,MAAO,KAAK,QAAQ,KAC1B,CAAK,CACF,CAEH,CAEA/C,EAAgB2B,EAAkB,YAAa,kBAAkB,EAEjE,SAASmB,GAAcE,EAAK,CAC1B,IAAIC,EAAU,GAEd,UAAWvB,KAAOsB,EAAK,CACrBC,EAAU,GACV,KACD,CAED,OAAOA,CACT,CC3JO,SAASC,EAASC,EAAQC,EAAOC,EAAe,CACrD,MAAMC,EAAQD,EAEd,OAAAC,EAAM,OAAS,IAAMH,EAErBG,EAAM,MAAQ,IAAMF,EAEbE,CACT,CACO,SAASC,EAAiBJ,EAAQC,EAAO,CAG9C,OAAOF,EAASC,EAAQC,EAFFI,GAASC,GAAcN,EAAQC,EAAOI,CAAK,CAErB,CAC9C,CACO,SAASE,GAAeP,EAAQC,EAAO,CAG5C,OAAOF,EAASC,EAAQC,EAFFI,GAASG,GAAYR,EAAQC,EAAOI,CAAK,CAEnB,CAC9C,CACO,SAASI,GAAiBT,EAAQC,EAAO,CAC9C,MAAMS,EAAeV,EAAO,KAAKW,CAAS,EAC1C,IAAItH,EAAI,EACR,MAAMuH,EAAI,KAAK,IAAI,EAAGX,EAAM,MAAM,EAC5BY,EAAa,IAAI,MAAMD,EAAI,CAAC,EAElC,KAAO,EAAEvH,EAAIuH,GACXC,EAAWxH,EAAI,GAAKyH,GAAUJ,EAAcrH,EAAIuH,CAAC,EAGnD,MAAMV,EAAgBG,GAASU,GAAgBF,EAAYZ,EAAOI,CAAK,EAEvE,OAAAH,EAAc,WAAa,IAAMW,EAE1Bd,EAASC,EAAQC,EAAOC,CAAa,CAC9C,CAEA,SAASS,EAAUpH,EAAGyH,EAAG,CACvB,OAAOzH,EAAIyH,CACb,CAEA,SAASF,GAAUd,EAAQiB,EAAU,CACnC,MAAMC,EAAelB,EAAO,OAE5B,GAAIiB,GAAY,GAAKC,EAAe,EAClC,OAAOlB,EAAO,GAGhB,GAAIiB,GAAY,EACd,OAAOjB,EAAOkB,EAAe,GAG/B,MAAMC,GAAkBD,EAAe,GAAKD,EACtCG,EAAW,KAAK,MAAMD,CAAc,EACpCE,EAAMrB,EAAOoB,GACbE,EAAOtB,EAAOoB,EAAW,GAC/B,OAAOC,GAAOC,EAAOD,IAAQF,EAAiBC,EAChD,CAEA,SAASG,GAAYhI,EAAGU,EAAG,CACzB,IAAIuH,EAAK,EACLC,EAAKlI,EAAE,OAEX,KAAOiI,EAAKC,GAAI,CACd,MAAMC,EAAMF,EAAKC,IAAO,EAEpBd,EAAUpH,EAAEmI,GAAMzH,CAAC,EAAI,EACzBwH,EAAKC,EAELF,EAAKE,EAAM,CAEd,CAED,OAAOF,CACT,CAEA,SAAST,GAAgBF,EAAYZ,EAAOI,EAAO,CACjD,OAAOJ,EAAMsB,GAAYV,EAAYR,CAAK,EAC5C,CAEA,SAASsB,GAAa3B,EAAQ4B,EAAW3B,EAAOI,EAAO,CACrD,MAAM9B,EAAM,GAAG,OAAO8B,CAAK,EAC3B,IAAIwB,EAAID,EAAU,IAAIrD,CAAG,EAEzB,OAAIsD,IAAM,SACRA,EAAI7B,EAAO,KAAKK,CAAK,EACrBuB,EAAU,IAAIrD,EAAKsD,CAAC,GAGf5B,GAAO4B,EAAI,GAAK5B,EAAM,OAC/B,CAEO,SAAS6B,GAAgB9B,EAAQC,EAAO,CAC7C,MAAM2B,EAAY,IAAI,IAChBG,EAAe,CAAA,EAErB,UAAWF,KAAK7B,EAAQ,CACtB,MAAMzB,EAAM,GAAG,OAAOsD,CAAC,EAElBD,EAAU,IAAIrD,CAAG,GACpBqD,EAAU,IAAIrD,EAAKwD,EAAa,KAAKF,CAAC,CAAC,CAE1C,CAID,OAAO9B,EAASC,EAAQC,EAFFI,GAASsB,GAAaI,EAAcH,EAAW3B,EAAOI,CAAK,CAErC,CAC9C,CACO,SAASC,GAAcN,EAAQC,EAAOI,EAAO,CAClD,MAAM2B,EAAchC,EAAO,GAAKA,EAAO,GAEvC,GAAIgC,GAAe,EACjB,OAAArJ,EAAI,KAAK,mDAAmD,IACrDsH,EAAM,GAGf,MAAMgC,EAAOD,EAAc/B,EAAM,OAC3BiC,EAAM,KAAK,OAAO7B,EAAQL,EAAO,IAAMiC,CAAI,EAC3CE,EAAW,KAAK,IAAI,KAAK,IAAID,EAAKjC,EAAM,OAAS,CAAC,EAAG,CAAC,EAC5D,OAAOA,EAAMkC,EACf,CACO,SAAS3B,GAAYR,EAAQC,EAAOI,EAAO,CAChD,OAAQA,EAAQL,EAAO,KAAOA,EAAO,GAAKA,EAAO,KAAOC,EAAM,GAAKA,EAAM,IAAMA,EAAM,EACvF,CAEA,SAASmC,EAAmBP,EAAG,CAC7B,OAA0BA,GAAM,IAClC,CAEO,SAASQ,GAAOC,EAAQ,CAC7B,MAAMC,EAAU,CAAA,EAChB,OAAAD,EAAO,QAAQ1J,GAAK,CACd,CAAC2J,EAAQ,SAAS3J,CAAC,GAAKwJ,EAAmBxJ,CAAC,GAC9C2J,EAAQ,KAAK3J,CAAC,CAEpB,CAAG,EACM2J,CACT,CAEA,SAASC,GAAgBC,EAAMC,EAAe,CAE5C,OADe,OAAOA,GAAkB,WAAaD,EAAK,IAAIC,CAAa,EAAID,GACjE,OAAOL,CAAkB,CACzC,CAMO,SAASO,GAAkBF,EAAMC,EAAe,CACrD,OAAOF,GAAgBC,EAAMC,CAAa,CAC5C,CACO,SAASE,GAAiBH,EAAMC,EAAe,CACpD,OAAOL,GAAOG,GAAgBC,EAAMC,CAAa,CAAC,CACpD,CAiBO,SAASG,GAAMxC,EAAOyC,EAAKC,EAAK,CACrC,OAAO,KAAK,IAAID,EAAK,KAAK,IAAIC,EAAK1C,CAAK,CAAC,CAC3C,CACO,SAAS2C,GAA4BC,EAAW,CACrD,OAAQA,OACD,WACH,OAAO7C,MAEJ,SACH,OAAOG,OAEJ,WACH,OAAOE,OAEJ,UACH,OAAOqB,WAGP,OAAO1B,EAEb,CC5LA,MAAM8C,GAAkBC,GAAUA,EAAO,OAGnCC,GAAmB,cAEnBC,GAAmBC,GAAOA,EAAI,OAE9BC,GAAkBD,GAAOA,EAAI,MAE7B3C,EAAY,CAACpH,EAAGyH,IAAMzH,EAAIyH,EAAI,GAAKzH,EAAIyH,EAAI,EAAIzH,GAAKyH,EAAI,EAAI,IAE5DhH,GAAe,CACnB,SAAUkJ,GACV,UAAWG,GACX,SAAUE,GACV,WAAY,IACd,EACe,MAAMC,EAAU,CAC7B,YAAYC,EAAO,GAAIxL,EAAQ+B,GAAc,CAC3C6C,EAAgB,KAAM,WAAY,MAAM,EAExCA,EAAgB,KAAM,WAAY,MAAM,EAExCA,EAAgB,KAAM,WAAY,MAAM,EAExCA,EAAgB,KAAM,aAAc,MAAM,EAE1CA,EAAgB,KAAM,iBAAkB,MAAM,EAE9CA,EAAgB,KAAM,aAAc,MAAM,EAE1CA,EAAgB,KAAM,SAAU,MAAM,EAEtC,KAAK,eAAiB,KAAK,kBAAkB4G,EAAMxL,CAAK,EAExD,KAAK,oBAAmB,EAExB,KAAK,OAAS,KAAK,WACpB,CAED,kBAAkBwL,EAAMxL,EAAO,CAC7B,KAAM,CACJ,SAAAiG,EAAWgF,GACX,UAAAQ,EAAYL,GACZ,SAAAM,EAAWJ,GACX,WAAAK,CACD,EAAG3L,EACE4L,EAAY,OAAOD,GAAe,WAClCE,EAAWL,EAAK,OAChBM,EAAiB,CAAA,EACvB,IAAInK,EAAQ,EAEZ,QAASoK,EAAW,EAAGA,EAAWF,EAAUE,IAAY,CACtD,MAAMV,EAAMG,EAAKO,GACXb,EAASO,EAAUJ,CAAG,EACtBjK,EAAIsK,EAASL,CAAG,EAChBW,EAAiBJ,EAAYV,EAAO,OAAOS,CAAU,EAAIT,EAC/DG,EAAI,eAAiBO,EAAYI,EAAiB,KAClD,MAAM5D,EAAQ4D,EAAe,OAAS/F,EAAS+F,CAAc,EAAI,KAE7D5D,GAAU,OACZ0D,EAAenK,GAAS,CACtB,EAAG,OAAO,SAASP,CAAC,EAAIA,EAAI2K,EAC5B,MAAA3D,EACA,OAAQ4D,EAAe,MACjC,EACQrK,IAEH,CAED,OAAOmK,CACR,CAED,mBAAmBG,EAAiB,CAClC,MAAMC,EAAM,KAAK,WAAW,OAE5B,GAAIA,EAAM,EACR,MAAO,CAAC,EAAG,CAAC,EAGd,KAAM,CAACC,EAAOC,CAAK,EAAIH,EAAgB,IAAItD,GAAKiC,GAAMjC,EAAG,EAAG,GAAG,CAAC,EAC1D0D,EAAW,KAAK,KAAKF,EAAQ,KAAOD,EAAM,EAAE,EAC5CI,EAAW,KAAK,MAAMF,EAAQ,KAAOF,EAAM,EAAE,EACnD,MAAO,CAACG,EAAUC,CAAQ,CAC3B,CAED,WAAY,CACV,MAAMC,EAAS,CAAA,EAEf,UAAWlB,KAAO,KAAK,eACrBkB,EAAOlB,EAAI,GAAKA,EAGlB,OAAOkB,CACR,CAED,qBAAsB,CACpB,IAAIC,EAAW,EACXC,EAAW,EACXC,EAAWvB,GACXwB,EAAa,EAEjB,UAAW3K,KAAK,KAAK,eACnBwK,EAAWA,EAAWxK,EAAE,OAASwK,EAAWxK,EAAE,OAC9CyK,EAAWA,EAAWzK,EAAE,MAAQyK,EAAWzK,EAAE,MAC7C0K,EAAWA,EAAW1K,EAAE,MAAQ0K,EAAW1K,EAAE,MAC7C2K,GAAc3K,EAAE,OAGlB,KAAK,SAAWwK,EAChB,KAAK,SAAWC,EAChB,KAAK,SAAWC,EAChB,KAAK,WAAaC,CACnB,CAED,cAAcV,EAAiB,CAK7B,GAJK,KAAK,aACR,KAAK,WAAa,KAAK,eAAe,KAAK,CAAC3K,EAAGyH,IAAML,EAAUpH,EAAE,MAAOyH,EAAE,KAAK,CAAC,GAG9E,CAAC,KAAK,WAAW,OACnB,MAAO,GAGT,IAAIsD,EAAW,EACXC,EAAW,KAAK,WAAW,OAAS,EAExC,GAAI,MAAM,QAAQL,CAAe,EAAG,CAClC,MAAMW,EAAW,KAAK,mBAAmBX,CAAe,EAExDI,EAAWO,EAAS,GACpBN,EAAWM,EAAS,EACrB,CAED,MAAO,CAAC,KAAK,WAAWP,GAAU,MAAO,KAAK,WAAWC,GAAU,KAAK,CACzE,CAED,sBAAsBpE,EAAO,CAACiE,EAAQ,EAAGC,EAAQ,GAAG,EAAI,GAAI,CAK1D,GAJK,KAAK,aACR,KAAK,WAAa,KAAK,eAAe,KAAK,CAAC9K,EAAGyH,IAAML,EAAUpH,EAAE,MAAOyH,EAAE,KAAK,CAAC,GAG9E,CAAC,KAAK,WAAW,OACnB,MAAO,GAGT,MAAM8D,EAAY,KAAK,mBAAmB,CAACV,EAAOC,CAAK,CAAC,EAExD,OAAO,KAAK,gBAAgBlE,EAAO2E,CAAS,CAC7C,CAED,gBAAgB7B,EAAW,CAACqB,EAAUC,CAAQ,EAAG,CAC/C,MAAMd,EAAO,KAAK,WAElB,OAAQR,OACD,eACA,SACH,MAAO,CAACQ,EAAKa,GAAU,MAAOb,EAAKc,GAAU,KAAK,MAE/C,WACH,OAAO5B,GAAkBc,EAAK,MAAMa,EAAUC,EAAW,CAAC,EAAG1C,GAAKA,EAAE,KAAK,MAEtE,UACH,OAAOe,GAAiBa,EAAM5B,GAAKA,EAAE,KAAK,UAG1C,MAAO,CAAC4B,EAAKa,GAAU,MAAOb,EAAKc,GAAU,KAAK,EAEvD,CAEH,CCxKA,SAASQ,GAAM,CAAE,CAEjB,MAAMC,EAAiB,CAAC,UAAW,YAAa,cAAc,EACxDC,EAAoB,CAAC,CACzB,IAAK,YACL,SAAU,eACV,YAAa,aACb,QAAS,CACP,SAAU,CACR,MAAO,CACL,KAAM,gBACN,cAAe,eAChB,EACD,OAAQ,CACN,KAAM,iBACN,cAAe,gBAChB,EACD,YAAa,CACX,KAAM,kBACP,EACD,WAAY,CACV,KAAM,cACN,cAAe,aAChB,CACF,CACF,EACD,UAAW,CACT,SAAU,CACR,gBAAiB,CACf,KAAM,iBACP,EACD,gBAAiB,CACf,KAAM,iBACP,EACD,UAAW,CACT,KAAM,gBACP,CACF,CACF,EACD,aAAc,CACZ,SAAU,CACR,OAAQ,CACN,KAAM,aACP,EACD,MAAO,CACL,KAAM,YACP,CACF,EACD,MAAO,CACL,MAAO,kBACR,CACF,EACD,UAAW,CAAC,EAAG,EAAG,EAAG,CAAC,CACxB,EAAG,CACD,IAAK,YACL,SAAU,eACV,YAAa,iBACb,QAAS,CACP,SAAU,CACR,MAAO,CACL,KAAM,oBACN,cAAe,mBAChB,EACD,OAAQ,CACN,KAAM,qBACN,cAAe,oBAChB,EACD,YAAa,CACX,KAAM,sBACP,EACD,WAAY,CACV,KAAM,cACN,cAAe,aAChB,CACF,CACF,EACD,UAAW,CACT,SAAU,CACR,gBAAiB,CACf,KAAM,0BACP,EACD,gBAAiB,CACf,KAAM,0BACP,EACD,UAAW,CACT,KAAM,oBACP,CACF,CACF,EACD,aAAc,CACZ,SAAU,CACR,OAAQ,CACN,KAAM,iBACP,EACD,MAAO,CACL,KAAM,gBACP,CACF,EACD,MAAO,CACL,MAAO,sBACR,CACF,EACD,UAAW,EACb,CAAC,EAEKC,GAAqBjN,GAASA,EAAM,SAE3B,MAAMkN,EAAc,CACjC,YAAYvG,EAAM,CAChB,KAAK,MAAQ,CACX,UAAW,CAAE,EACb,WAAY,CAAE,CACpB,EACI,KAAK,YAAc,GACnB,KAAK,kBAAoB,GACzB,KAAK,aAAeA,EAAK,aAAesG,GACxC,KAAK,eAAiBtG,EAAK,cAE3B,KAAK,cAAcA,EAAK,YAAcqG,CAAiB,CACxD,CAED,OAAO,mBAAoB,CACzB,OAAOA,CACR,CAED,YAAYrG,EAAMwG,EAAmB,CACnC,KAAM,CACJ,SAAApK,EACA,MAAA/C,EACA,YAAAgD,CACD,EAAG2D,EACJ,KAAK,oBAAoB5D,EAAU/C,EAAOgD,CAAW,EACrD,MAAMoK,EAAkB,KAAK,qBAAqBrK,EAAU/C,EAAOgD,CAAW,EAC9E,IAAIqK,EAAmB,GAEvB,OAAIrK,EAAY,aAAeoK,GAC7B,KAAK,kBAAkBpN,EAAOmN,CAAiB,EAC/CE,EAAmB,MAEM,KAAK,oBAAoBtK,EAAU/C,EAAOgD,CAAW,GAAK,IAClE,QAAQsK,GAAK,OAAOA,GAAM,YAAcA,EAAC,CAAE,EAC5DD,EAAmB,IAGrB,KAAK,SAAS,CACZ,iBAAAA,CACN,CAAK,EACM,KAAK,KACb,CAED,SAASE,EAAc,CACrB,KAAK,MAAQ,CAAE,GAAG,KAAK,MACrB,GAAGA,CACT,CACG,CAED,kBAAkBjH,EAAKiH,EAAc,CACnC,KAAK,SAAS,CACZ,WAAY,CAAE,GAAG,KAAK,MAAM,WAC1B,CAACjH,GAAM,CAAE,GAAG,KAAK,MAAM,WAAWA,GAChC,GAAGiH,CACJ,CACF,CACP,CAAK,CACF,CAED,gBAAgBC,EAAS,GAAI,CAC3B,OAAIA,EAAO,SACF,CACL,KAAMA,EAAO,SACb,GAAGA,CACX,EACeA,EAAO,UACT,CACL,KAAMA,EAAO,UACb,GAAGA,CACX,EAGWA,CACR,CAED,kBAAkBxN,EAAOmN,EAAmB,CAG1C,MAAMK,EAFa,KAAK,eAAexN,CAAK,EAElBA,EAAOmN,CAAiB,EAClD,KAAK,SAAS,CACZ,UAAW,KAAK,gBAAgBK,CAAM,CAC5C,CAAK,EACD,KAAK,YAAc,CACjB,UAAW,EACjB,EACI,KAAK,cAAcxN,CAAK,CACzB,CAED,oBAAoB+C,EAAU/C,EAAOgD,EAAa,CAChD,UAAWsD,KAAO,KAAK,kBAAmB,CACxC,KAAM,CACJ,MAAA8B,EACA,OAAAqF,EACA,YAAA9H,CACD,EAAG,KAAK,kBAAkBW,GAAK,QAAQ,SACxC,IAAIL,EAAWjG,EAAMoI,EAAM,MACH,KAAK,wBAAwB,KAAK,kBAAkB9B,GAAK,QAASvD,EAAU/C,EAAOgD,CAAW,IAGhHiD,EACFA,EAAWD,GAAiBC,EAAU,CACpC,KAAMjG,EAAM,IACxB,CAAW,EAEDiG,EAAWP,GAAa1F,EAAM2F,EAAY,MAAO3F,EAAMyN,EAAO,MAAO,CACnE,KAAMzN,EAAM,IACxB,CAAW,GAIDiG,GACF,KAAK,kBAAkBK,EAAK,CAC1B,SAAAL,CACV,CAAS,CAEJ,CACF,CAED,qBAAqBlD,EAAU/C,EAAOgD,EAAa,CACjD,OAAO,KAAK,aAAaD,CAAQ,IAAM,KAAK,aAAa/C,CAAK,GAAK,KAAK,eAAe+C,CAAQ,IAAM,KAAK,eAAe/C,CAAK,GAAKgD,EAAY,wBAA0BA,EAAY,sBAAsB,KAAOA,EAAY,sBAAsB,YACrP,CAED,aAAa0D,EAAY,CACvB,KAAK,cAAcA,CAAU,CAC9B,CAED,cAAcA,EAAa,GAAI,CAC7BA,EAAW,QAAQS,GAAa,CAC9B,KAAM,CACJ,IAAAb,CACD,EAAGa,EACJ,KAAK,kBAAkBb,GAAO,KAAK,qBAAqBa,CAAS,EACjE,KAAK,MAAM,WAAWb,GAAO,CAC3B,SAAU,KACV,OAAQ,KACR,WAAY,KACZ,UAAWwG,CACnB,CACA,CAAK,CACF,CAED,qBAAqB,CACnB,IAAAxG,EACA,SAAAjB,EACA,YAAAqI,EACA,QAAAC,EACA,UAAAC,EACA,aAAAC,EACA,UAAAC,CACJ,EAAK,CACD,MAAO,CACL,IAAAxH,EACA,SAAAjB,EACA,YAAAqI,EACA,QAAS,CACP,QAAS,KAAK,uBACd,GAAGC,CACJ,EACD,UAAW,CACT,QAAS,KAAK,wBACd,GAAGC,CACJ,EACD,aAAc,CACZ,QAAS,KAAK,kBACd,GAAGC,CACJ,EACD,kBAAmB,KAAK,8BAA8BvH,EAAKwH,CAAS,CAC1E,CACG,CAED,wBAAwBC,EAAehL,EAAU/C,EAAOgD,EAAa,CACnE,OAAO,OAAO,OAAO+K,EAAc,QAAQ,EAAE,KAAKC,GAC5CA,EAAK,cACAhL,EAAY,aAAeA,EAAY,wBAA0BA,EAAY,sBAAsB,KAAOA,EAAY,sBAAsBgL,EAAK,gBAGnJjL,EAASiL,EAAK,QAAUhO,EAAMgO,EAAK,KAC3C,CACF,CAED,oBAAoBjL,EAAU/C,EAAOgD,EAAa,CAChD,MAAMiL,EAAW,CAAA,EAEjB,UAAW3H,KAAO,KAAK,kBAAmB,CACxC,MAAM4H,EAAanB,EAAe,KAAK/C,GAAQ,KAAK,wBAAwB,KAAK,kBAAkB1D,GAAK0D,GAAOjH,EAAU/C,EAAOgD,CAAW,CAAC,EAExIkL,GACFD,EAAS,KAAK,KAAK,kBAAkB3H,GAAK4H,GAAY,QAAQ,KAAK,KAAMlO,EAAO,KAAK,kBAAkBsG,EAAI,CAAC,CAE/G,CAED,OAAO2H,EAAS,OAASA,EAAW,IACrC,CAED,kBAAkBjO,EAAO,CACvB,MAAMmO,EAAkBnO,EAAM,gBAAkB,GAE1CoO,EAAiB,CAAA,EAEvB,UAAW9H,KAAO,KAAK,kBAAmB,CACxC,KAAM,CACJ,SAAAjB,CACR,EAAU,KAAK,kBAAkBiB,GAC3B8H,EAAe/I,GAAY,GAC3B0H,EAAe,QAAQ/C,GAAQ,CAC7B,OAAO,OAAO,KAAK,kBAAkB1D,GAAK0D,GAAM,QAAQ,EAAE,QAAQ,CAAC,CACjE,KAAAqE,EACA,cAAAC,CACV,IAAc,CACJ,GAAIA,EAAe,CACjB,MAAMC,EAAWJ,EAAgBG,GAE7B,OAAOC,GAAa,UAAY,CAAC,MAAM,QAAQA,CAAQ,EACzD,OAAO,OAAOH,EAAe/I,GAAWkJ,CAAQ,EACvCA,IAAa,SACtBH,EAAe/I,GAAUgJ,GAAQE,EAE/C,MACYH,EAAe/I,GAAUgJ,GAAQrO,EAAMqO,EAEnD,CAAS,CACT,CAAO,CACF,CAED,OAAOD,CACR,CAED,cAAcpO,EAAO,CACnB,UAAWsG,KAAO,KAAK,kBACrB,KAAK,uBAAuBtG,EAAO,KAAK,kBAAkBsG,EAAI,CAEjE,CAED,uBAAuBtG,EAAOwO,EAAkB,CAC9C,KAAM,CACJ,IAAAlI,CACD,EAAGkI,EACE,CACJ,SAAAvI,CACD,EAAG,KAAK,MAAM,WAAWK,GACpBmI,EAAa,IAAIlD,GAAU,KAAK,MAAM,UAAU,MAAQ,GAAI,CAChE,SAAAtF,EACA,WAAYjG,EAAM,WACxB,CAAK,EACD,KAAK,kBAAkBsG,EAAK,CAC1B,WAAAmI,CACN,CAAK,EACD,KAAK,wBAAwBzO,EAAOwO,CAAgB,CACrD,CAED,wBAAwBxO,EAAOwO,EAAkB,CAC/C,KAAM,CACJ,UAAAZ,EACA,IAAAtH,CACD,EAAGkI,EACE,CACJ,SAAU,CACR,gBAAAE,EACA,gBAAAC,EACA,UAAA3D,CACD,CACF,EAAG4C,EACEgB,EAAc,KAAK,MAAM,WAAWtI,GAAK,WAAW,sBAAsBtG,EAAMgL,EAAU,MAAO,CAAChL,EAAM0O,EAAgB,MAAO1O,EAAM2O,EAAgB,KAAK,CAAC,EACjK,KAAK,kBAAkBrI,EAAK,CAC1B,YAAAsI,CACN,CAAK,EACD,KAAK,kBAAkB5O,EAAOwO,CAAgB,CAC/C,CAED,kBAAkBxO,EAAOwO,EAAkB,CACzC,KAAM,CACJ,IAAAlI,EACA,aAAAuH,EACA,UAAAD,CACD,EAAGY,EACE,CACJ,OAAAzG,EACA,MAAAC,CACN,EAAQ6F,EAAa,SACX,CACJ,UAAA7C,CACN,EAAQ4C,EAAU,SACR,CACJ,MAAAiB,CACD,EAAGhB,EACEiB,EAAiB9O,EAAMgI,EAAM,MAC7B+G,EAAkB/O,EAAM+H,EAAO,OAAS,KAAK,MAAM,WAAWzB,GAAK,YAEnE0I,EADmBjE,GAA4BC,GAAahL,EAAMgL,EAAU,KAAK,EACpD+D,EAAiBD,CAAc,EAE9D,OAAOD,GAAU,UAAY,OAAO7O,EAAM6O,EAAM,QAAW,YAC7D7O,EAAM6O,EAAM,OAAOG,EAAU,OAAQ,CAAA,EAGvC,KAAK,kBAAkB1I,EAAK,CAC1B,UAAA0I,CACN,CAAK,CACF,CAED,8BAA8B1I,EAAKwH,EAAW,CAC5C,OAAOmB,GAAQ,CACb,KAAM,CACJ,WAAAR,EACA,UAAAO,CACD,EAAG,KAAK,MAAM,WAAW1I,GACpB+E,EAAMoD,EAAW,OAAOQ,EAAK,OAEnC,GAAI5D,GAAOA,EAAI,SAAW,EACxB,OAAOyC,EAGT,MAAMoB,EAAK7D,GAAOA,EAAI,MAChBtD,EAASiH,EAAU,SAEzB,OADwBE,GAAMnH,EAAO,IAAMmH,GAAMnH,EAAOA,EAAO,OAAS,GAC/CiH,EAAUE,CAAE,EAAIpB,CAC/C,CACG,CAED,qBAAqB9N,EAAO,CAC1B,MAAMsH,EAAY,CAAA,EAElB,UAAWhB,KAAO,KAAK,kBAAmB,CACxC,KAAM,CACJ,SAAAjB,CACR,EAAU,KAAK,kBAAkBiB,GAC3BgB,EAAUjC,GAAY,KAAK,8BAA8BrF,EAAOsG,CAAG,CACpE,CAED,OAAOgB,CACR,CAED,eAAe,CACb,KAAA6H,CACJ,EAAK,CACD,MAAMC,EAAWD,EAAK,QAAUA,EAAK,MAAQ,GAC7C,IAAIE,EAAS,KAEb,GAAID,EAAU,CACZ,MAAMH,EAAO,KAAK,MAAM,UAAU,KAAKE,EAAK,OACtCG,EAAU,CAAA,EAEhB,UAAWhJ,KAAO,KAAK,kBAAmB,CACxC,KAAM,CACJ,YAAAoH,CACV,EAAY,KAAK,kBAAkBpH,GACrB,CACJ,WAAAmI,CACD,EAAG,KAAK,MAAM,WAAWnI,GACpB8B,EAAQqG,EAAW,OAAOQ,EAAK,QAAUR,EAAW,OAAOQ,EAAK,OAAO,MAC7EK,EAAQ5B,GAAetF,CACxB,CAEDiH,EAAS,OAAO,OAAOC,EAASL,EAAM,CACpC,OAAQA,EAAK,gBAAkBA,EAAK,MAC5C,CAAO,CACF,CAED,OAAAE,EAAK,OAAS,QAAQE,CAAM,EAC5BF,EAAK,OAASE,EACPF,CACR,CAED,YAAYI,EAAc,CACxB,OAAK,KAAK,kBAAkB,eAAeA,CAAY,EAIhD,KAAK,kBAAkBA,GAAc,kBAHnCzC,CAIV,CAEH,CCjeA,IAAI0C,EAAU,KAAK,GAAK,EACpBC,GAAS,CAAC,EAAGD,EAAS,EAAIA,EAAS,EAAIA,EAAS,EAAIA,EAAS,EAAIA,CAAO,EAE5E,SAASE,GAAO9F,EAAG,CACjB,OAAOA,EAAE,EACX,CAEA,SAAS+F,GAAO/F,EAAG,CACjB,OAAOA,EAAE,EACX,CAEe,SAAAgG,IAAW,CACxB,IAAIC,EAAK,EACLC,EAAK,EACLC,EAAK,EACLC,EAAK,EACLhO,EAAI0N,GACJO,EAAIN,GACJO,EACAC,EACAC,EAEJ,SAASR,EAAO1E,EAAQ,CACtB,IAAImF,EAAW,CAAE,EAAE7E,EAAO,CAAA,EAAIpK,EAAGuH,EAAIuC,EAAO,OAE5C,IAAK9J,EAAI,EAAGA,EAAIuH,EAAG,EAAEvH,EACnB,GAAI,QAAMkP,EAAK,CAACtO,EAAE,KAAK,KAAMuO,EAAQrF,EAAO9J,GAAIA,EAAG8J,CAAM,CAAC,GACnD,MAAMsF,EAAK,CAACP,EAAE,KAAK,KAAMM,EAAOnP,EAAG8J,CAAM,CAAC,GAEjD,KAAIqF,EACAD,EACAE,EACAC,EAAK,KAAK,MAAMD,EAAKA,EAAKJ,CAAE,EAC5BM,EAAK,KAAK,MAAMJ,EAAKA,EAAKH,GAAMM,EAAK,GAAK,CAAC,EAC3CE,EAAMH,EAAKC,EAEf,GAAI,KAAK,IAAIE,CAAG,EAAI,EAAI,EAAG,CACzB,IAAIC,EAAMN,EAAKI,EACXG,EAAMH,GAAMJ,EAAKI,EAAK,GAAK,GAAK,EAChCI,EAAML,GAAMD,EAAKC,EAAK,GAAK,GAC3BM,EAAMT,EAAKO,EACXG,EAAMR,EAAKM,EACXF,EAAMA,EAAMD,EAAMA,EAAMI,EAAMA,EAAMC,EAAMA,IAAKN,EAAKG,GAAOJ,EAAK,EAAI,EAAI,IAAM,EAAGA,EAAKK,EAC3F,CAED,IAAI7Q,EAAKyQ,EAAK,IAAMD,EAAIpF,EAAMgF,EAASpQ,GACnCoL,EAAKA,EAAI,KAAKkF,CAAK,GAErB/E,EAAK,KAAKH,EAAMgF,EAASpQ,GAAM,CAACsQ,CAAK,CAAC,EACtClF,EAAI,GAAKqF,GAAMD,EAAK,GAAK,GAAKN,EAC9B9E,EAAI,EAAIoF,EAAKL,GAIjB,OAAO5E,CACR,CAED,SAASyF,EAAQ3Q,EAAQ,CACvB,IAAIuP,EAAK,EAAGC,EAAK,EACjB,OAAOL,GAAO,IAAI,SAASnL,EAAO,CAChC,IAAIyL,EAAK,KAAK,IAAIzL,CAAK,EAAIhE,EACvB0P,EAAK,CAAC,KAAK,IAAI1L,CAAK,EAAIhE,EACxB6P,EAAKJ,EAAKF,EACVO,EAAKJ,EAAKF,EACd,OAAAD,EAAKE,EAAID,EAAKE,EACP,CAACG,EAAIC,CAAE,CACpB,CAAK,CACF,CAED,OAAAR,EAAO,QAAU,SAAStP,EAAQ,CAChC,MAAO,IAAM2Q,EAAQ3Q,GAAU,KAAO4P,EAAI,CAAC5P,CAAM,EAAE,KAAK,GAAG,EAAI,GACnE,EAEEsP,EAAO,QAAU,UAAW,CAI1B,QAHIsB,EAAU,CAAE,EACZ7P,EAAI,KAAK,MAAMyO,EAAKM,CAAE,EACtBhP,EAAI,KAAK,MAAMyO,EAAKM,CAAE,EACjBF,EAAI5O,EAAI+O,EAAIH,EAAID,EAAKE,EAAGD,GAAKG,EAAI,EAAE/O,EAC1C,QAASW,EAAIZ,EAAI+O,GAAM9O,EAAI,GAAK8O,EAAK,EAAGnO,EAAI+N,EAAKI,EAAK,EAAGnO,GAAKmO,EAC5De,EAAQ,KAAK,CAAClP,EAAGiO,CAAC,CAAC,EAGvB,OAAOiB,CACX,EAEEtB,EAAO,KAAO,UAAW,CACvB,IAAIuB,EAAWF,EAAQf,CAAC,EAAE,MAAM,EAAG,CAAC,EAAE,KAAK,GAAG,EAC9C,OAAON,EAAO,QAAS,EAAC,IAAI,SAASrM,EAAG,CAAE,MAAO,IAAMA,EAAI,IAAM4N,CAAS,CAAE,EAAE,KAAK,EAAE,CACzF,EAEEvB,EAAO,EAAI,SAASwB,EAAG,CACrB,OAAO,UAAU,QAAUpP,EAAIoP,EAAGxB,GAAU5N,CAChD,EAEE4N,EAAO,EAAI,SAASwB,EAAG,CACrB,OAAO,UAAU,QAAUnB,EAAImB,EAAGxB,GAAUK,CAChD,EAEEL,EAAO,OAAS,SAASwB,EAAG,CAC1B,OAAO,UAAU,QAAUlB,EAAI,CAACkB,EAAGjB,EAAKD,EAAI,EAAI,KAAK,IAAIV,CAAO,EAAGY,EAAKF,EAAI,IAAKN,GAAUM,CAC/F,EAEEN,EAAO,KAAO,SAASwB,EAAG,CACxB,OAAO,UAAU,QAAUvB,EAAKC,EAAK,EAAGC,EAAK,CAACqB,EAAE,GAAIpB,EAAK,CAACoB,EAAE,GAAIxB,GAAU,CAACG,EAAKF,EAAIG,EAAKF,CAAE,CAC/F,EAEEF,EAAO,OAAS,SAASwB,EAAG,CAC1B,OAAO,UAAU,QAAUvB,EAAK,CAACuB,EAAE,GAAG,GAAItB,EAAK,CAACsB,EAAE,GAAG,GAAIrB,EAAK,CAACqB,EAAE,GAAG,GAAIpB,EAAK,CAACoB,EAAE,GAAG,GAAIxB,GAAU,CAAC,CAACC,EAAIC,CAAE,EAAG,CAACC,EAAIC,CAAE,CAAC,CACxH,EAESJ,EAAO,OAAO,CAAC,CACxB,CC7GO,SAASyB,GAAcrR,EAAOmN,EAAmB,CACtD,KAAM,CACJ,KAAA3C,EACA,OAAAlK,CACD,EAAGN,EACE,CACJ,SAAA8G,EACA,WAAA1G,CACD,EAAG+M,EACEmE,EAAe9G,EAAK,OAAS+G,GAAgB/G,EAAM2C,CAAiB,EAAI,KACxEqE,EAAeC,GAAkBnR,EAAQwG,EAAUwK,CAAY,EAC/DI,EAAe,CAAA,EACf,CACJ,SAAAC,EACA,WAAAC,CACJ,EAAMC,GAAerH,CAAI,EACjBtJ,EAAYd,EAAW,UAAU,MACjC,CACJ,KAAA0R,CACJ,EAAM1R,EAAW,UAAU,cAEzB,UAAWiP,KAAUsC,EAAU,CAC7BC,EAAW,QACX,MAAMG,EAAWH,EAAW,MAAQE,EAC9BE,EAAW,CAAC9Q,EAAU6Q,GAAW7Q,EAAU6Q,EAAW,EAAE,EACxC,OAAO,SAASC,EAAS,EAAE,GAAK,OAAO,SAASA,EAAS,EAAE,EAG/EN,EAAa,KAAK,CAChB,YAAa5K,EAAS,YAAYkL,CAAQ,EAC1C,OAAQ3C,EACR,MAAOuC,EAAW,KAC1B,CAAO,EAEDlR,EAAI,KAAK,gCAAgC,GAE5C,CAID,MAAO,CACL,SAHgBkP,KAAS,OAAO4B,CAAY,EAAE,EAAE5H,GAAKA,EAAE,YAAY,EAAE,EAAE,EAAEA,GAAKA,EAAE,YAAY,EAAE,EAClE8H,CAAY,EAElB,IAAI,CAACO,EAAKtQ,KAAW,CACzC,SAAUmF,EAAS,cAAc,CAACmL,EAAI,EAAGA,EAAI,CAAC,CAAC,EAC/C,OAAQA,EACR,MAAAtQ,CACN,EAAM,EACF,aAAA6P,CACJ,CACA,CACO,SAASD,GAAgB/G,EAAM2C,EAAmB,CACvD,KAAM,CACJ,WAAA/M,CACD,EAAG+M,EACEjM,EAAYd,EAAW,UAAU,MACjC,CACJ,KAAA0R,CACJ,EAAM1R,EAAW,UAAU,cACzB,IAAI8R,EAAO,IACPC,EAAO,IACPC,EAAO,KACPC,EAAO,KACPjR,EAEJ,IAAKA,EAAI,EAAGA,EAAI0Q,EAAOtH,EAAK,OAAQpJ,GAAK0Q,EAAM,CAC7C,MAAM9P,EAAId,EAAUE,GACd6O,EAAI/O,EAAUE,EAAI,GACF,OAAO,SAASY,CAAC,GAAK,OAAO,SAASiO,CAAC,IAG3DiC,EAAO,KAAK,IAAIlQ,EAAGkQ,CAAI,EACvBE,EAAO,KAAK,IAAIpQ,EAAGoQ,CAAI,EACvBD,EAAO,KAAK,IAAIlC,EAAGkC,CAAI,EACvBE,EAAO,KAAK,IAAIpC,EAAGoC,CAAI,EAE1B,CAED,MAAO,CAACH,EAAMC,EAAMC,EAAMC,CAAI,EAAE,MAAM,OAAO,QAAQ,EAAI,EAAEH,EAAOE,GAAQ,GAAID,EAAOE,GAAQ,CAAC,EAAI,IACpG,CACO,SAASZ,GAAkBnR,EAAQwG,EAAUwL,EAAQ,CAC1D,KAAM,CACJ,cAAAC,CACJ,EAAMzL,EAAS,kBAAkBwL,CAAM,EACrC,OAAOhS,EAASiS,EAAc,EAChC,CC7EA,SAASzF,GAAM,CAAE,CAEjB,MAAM/K,GAAe,CACnB,YAAa,KACb,WAAYmE,GACZ,cAAe,CACb,KAAM,WACN,MAAO,IACR,EACD,eAAgB,CACd,KAAM,WACN,MAAO,CACR,EACD,iBAAkB,MAClB,gBAAiB,CACf,KAAM,SACN,MAAO,EACP,IAAK,EACL,IAAK,GACN,EACD,gBAAiB,CACf,KAAM,SACN,MAAO,IACP,IAAK,EACL,IAAK,GACN,EACD,eAAgB,WAChB,iBAAkB4G,EAClB,gBAAiB,KACjB,eAAgB,CAAC,EAAG,GAAI,EACxB,kBAAmB,CACjB,KAAM,WACN,MAAO,IACR,EACD,mBAAoB,CAClB,KAAM,WACN,MAAO,CACR,EACD,qBAAsB,MACtB,yBAA0B,CACxB,KAAM,SACN,MAAO,EACP,IAAK,EACL,IAAK,GACN,EACD,yBAA0B,CACxB,KAAM,SACN,MAAO,IACP,IAAK,EACL,IAAK,GACN,EACD,eAAgB,CACd,KAAM,SACN,IAAK,EACL,MAAO,CACR,EACD,mBAAoB,SACpB,qBAAsBA,EACtB,OAAQ,CACN,KAAM,SACN,MAAO,IACP,IAAK,CACN,EACD,SAAU,CACR,KAAM,SACN,IAAK,EACL,IAAK,EACL,MAAO,CACR,EACD,SAAU,GACV,kBAAmBuE,GACnB,YAAa,CACX,KAAM,WACN,MAAOrP,GAAKA,EAAE,QACf,EACD,SAAU,GACV,YAAa,CACX,KAAM,WACN,MAAO,KACP,SAAU,EACX,CACH,EACe,MAAMwQ,UAAqBjM,CAAiB,CACzD,eAAeE,EAAM,CACnB,MAAM,GAAGA,CAAI,EAEb7B,EAAgB,KAAM,QAAS,MAAM,CACtC,CAED,iBAAkB,CAChB,MAAM6N,EAAgB,IAAIvF,GAAc,CACtC,cAAelN,GAASA,EAAM,kBAC9B,YAAaA,GAASA,EAAM,MAClC,CAAK,EACD,KAAK,MAAQ,CACX,cAAAyS,EACA,gBAAiBA,EAAc,MAC/B,SAAU,IAChB,EAC6B,KAAK,sBACb,IAAI,CACnB,UAAW,CACT,KAAM,EACN,KAAM,KACN,SAAU,aACX,CACP,CAAK,CACF,CAED,YAAY9L,EAAM,CAGhB,GAFA,MAAM,YAAYA,CAAI,EAElBA,EAAK,YAAY,mBAAoB,CACvC,MAAM+L,EAAkB,KAAK,MAAM,cAAc,YAAY/L,EAAM,CACjE,SAAU,KAAK,QAAQ,SACvB,WAAY,KAAK,cAAe,CACxC,CAAO,EAED,GAAI,KAAK,MAAM,gBAAgB,YAAc+L,EAAgB,UAAW,CACtE,KAAM,CACJ,gBAAAC,CACV,EAAYD,EAAgB,WAAa,GACjC,KAAK,SAAS,CACZ,SAAUC,GAAmB,KAAK,2BAA2BA,CAAe,CACtF,CAAS,CACF,CAED,KAAK,SAAS,CACZ,gBAAAD,CACR,CAAO,CACF,CACF,CAED,2BAA2BC,EAAiB,CAC1C,KAAM,CACJ,SAAA7L,CACN,EAAQ,KAAK,QAET,GAAI,MAAM,QAAQ6L,CAAe,GAAKA,EAAgB,SAAW,EAAG,CAClE,MAAMC,EAAUD,EAAgB,GAC1BE,EAAUF,EAAgB,GAC1BG,EAAW,EAAEF,EAAQ,GAAKC,EAAQ,IAAM,GAAID,EAAQ,GAAKC,EAAQ,IAAM,CAAC,EACxEE,EAAejM,EAAS,YAAYgM,CAAQ,EAC5C,CACJ,cAAAE,CACR,EAAUlM,EAAS,kBAAkBgM,CAAQ,EAKvC,OAJiBH,EAAgB,IAAIM,GAAM,CACzC,MAAMC,EAASpM,EAAS,YAAYmM,CAAE,EACtC,MAAO,EAAEC,EAAO,GAAKH,EAAa,IAAMC,EAAc,IAAKE,EAAO,GAAKH,EAAa,IAAMC,EAAc,EAAE,CAClH,CAAO,CAEF,CAED,OAAAtS,EAAI,MAAM,gEAAgE,IACnE,IACR,CAED,eAAe,CACb,KAAAyO,CACJ,EAAK,CACD,OAAO,KAAK,MAAM,cAAc,eAAe,CAC7C,KAAAA,CACN,CAAK,CACF,CAED,oBAAoBF,EAAM,CACxB,OAAO,KAAK,MAAM,cAAc,YAAY,WAAW,EAAEA,CAAI,CAC9D,CAED,wBAAwBA,EAAM,CAC5B,OAAO,KAAK,MAAM,cAAc,YAAY,WAAW,EAAEA,CAAI,CAC9D,CAED,4BAA6B,CAC3B,OAAO,KAAK,MAAM,cAAc,kBAAkB,KAAK,KAAK,CAC7D,CAED,cAAe,CACb,KAAM,CACJ,eAAAhL,EACA,SAAAR,EACA,SAAAY,EACA,SAAA8O,EACA,YAAAC,CACN,EAAQ,KAAK,MACH,CACJ,gBAAAV,EACA,SAAAjS,CACN,EAAQ,KAAK,MACH4S,EAAgB,KAAK,iBAAiB,eAAgBpR,CAAW,EAEjEmM,EAAiB,KAAK,6BAEtB/K,EAAW5C,EAAW,CAC1B,SAAAA,EACA,OAAQ,CACd,EAAQ,CACF,OAAQiS,EAAgB,UAAU,cAAgB,EAClD,YAAa,SACb,MAAO,EACb,EACI,OAAO,IAAIW,EAAc,CAAE,GAAGhQ,EAC5B,eAAgB,EAChB,eAAAY,EACA,SAAAR,EACA,SAAAY,EACA,SAAA8O,EACA,aAAc,KAAK,oBAAoB,KAAK,IAAI,EAChD,aAAc,KAAK,wBAAwB,KAAK,IAAI,EACpD,YAAaC,GAAe,CAC1B,aAAcA,EAAY,eAAiBA,EAAY,eACvD,aAAcA,EAAY,mBAAqBA,EAAY,kBAC5D,CACP,EAAO,KAAK,iBAAiB,CACvB,GAAI,eACJ,eAAAhF,CACN,CAAK,EAAG,CACF,KAAMsE,EAAgB,UAAU,IACtC,CAAK,CACF,CAEH,CAEA9N,EAAgB4N,EAAc,YAAa,cAAc,EAEzD5N,EAAgB4N,EAAc,eAAgBzQ,EAAY,EC/N1D,MAAMoR,GAAW,CACfG,QAAS,IACTC,QAAS,GACTC,UAAW,GACXC,cAAe,CAAC,GAAI,GAAI,EAAE,CAC5B,EAEMC,GAAe,CACnBC,KAAM,GACNC,UAAW,MACXC,SAAU,KACVC,MAAO,EACPC,QAAS,CACX,EAGA,SAAwB7R,GAAM,CAC5B8R,OAAAA,EAAS,EACTC,UAAAA,EAAY,cACZ5P,SAAAA,EAAW,IACX6P,KAAAA,EAAO,GACP1J,KAAAA,EAAO,CAAE2J,IAAK,IAAIC,aAAa,CAAC,EAAGC,OAAQ,CAAE,EAC7CC,QAAAA,EAAU,GACVC,WAAAA,EAAa,CAAC,EACdC,iBAAAA,EAAmB,GACnBC,UAAAA,EAAY,IACZC,OAAAA,EAAS,QACTpU,OAAAA,EAAS,IACTqU,iBAAAA,EAAmB,CAAEC,KAAM,EAAGC,YAAa,EAAGC,mBAAoB,CAAA,CAAG,EACrEnG,gBAAAA,EAAkB,IAClBoG,QAAAA,EAAU,CAAC,CACb,EAAG,CAED,KAAM,CAACC,EAAWC,CAAY,EAAIC,oBAASxB,EAAY,EAEpCyB,EAAAnB,GAAWoB,GAAc,CAExCH,EADEG,GAGWC,EAAYC,MAAMN,SAFd,GAMrB,SAASO,EAAgBH,EAAW,CAC9B,CAACA,EAAKvB,WAELuB,EAAK9C,SAAa8C,EAAA9C,OAAS,CAAC,EAAG,CAAC,GAChC8C,EAAA9C,OAAO,GAAK8C,EAAKxB,UACjBwB,EAAA9C,OAAO,GAAK8C,EAAKvB,SACtBoB,EAAaG,CAAI,EAEZZ,GAA8Ba,EAAAG,OAAO,eAAgBJ,CAAI,EAChE,CAEA,MAAMK,EAASC,GAAS,CACtBA,SAAUzB,EACV0B,QAAS,GACTC,OAAQ,MACRC,MAAO,CACR,CAAA,EAAEC,IAAKC,GAAgB,CAACA,EAAE,GAAIA,EAAE,GAAIA,EAAE,EAAE,CAAC,EAEjC,SAAAC,EAAW,CAAE3G,OAAAA,CAAO,EAAQ,CAC/B,GAAA,CAACA,GAAU,CAACA,EAAO2C,UAAY,CAAC3C,EAAO2C,SAASqC,OAC3C,OAAA,KAGH,MAAA4B,EAAM5G,EAAO2C,SAAS,GACtBkE,EAAM7G,EAAO2C,SAAS,GACtBmE,EAAQ9G,EAAOnE,OAAOmJ,OAErB,MAAA,CACL+B,KAAM,cACC7B,EAAWF,OAAS,QAAUK,MAAWyB;AAAAA,UAC5CE,OAAOC,SAASL,CAAG,EAAIA,EAAIM,QAAQ,CAAC,EAAI,QAC1CF,OAAOC,SAASJ,CAAG,EAAIA,EAAIK,QAAQ,CAAC,EAAI;AAAA,QAG1CC,MAAOtC,EACH,CAAEuC,MAAO,OAAQC,gBAAiB,SAAU,EAC5C,CAAED,MAAO,OAAQC,gBAAiB,OAAQ,EAElD,CAES,SAAAC,EAAYC,EAAaC,EAAY,CAC5C9B,EAAQ6B,EAAQC,CAAK,CACvB,CAGA,IAAIjC,EAAO,KACPL,EAAWF,OACbO,EAAOL,EAAWuB,IAAWgB,GAAAA,EAAI,EAAE,EACzBtM,EAAK6J,OAGRO,EAAA,CACLP,OAAQ7J,EAAK6J,OACbjU,WAAY,CACV2W,YAAa,CAAE3O,MAAOoC,EAAK2J,IAAKrC,KAAM,CAAE,CAC1C,GANK8C,EAAA,KAUT,MAAMoC,EAAS,CACb,IAAIC,GAAS,CACXhX,GAAI,YACJuK,KAAM+J,EACN2C,kBAAoBtN,GAAWA,EAAE,GACjCuN,kBAAoBvN,GAAWA,EAAE,GACjCwN,SAAU,GACVC,QAAS,GACTC,UAAW,EACXC,SAAU,EACVC,eAAgBtD,EAAO,CAAC,IAAK,GAAI,GAAG,EAAI,CAAC,IAAK,IAAK,GAAG,EACtDuD,eAAgBvD,EAAO,CAAC,IAAK,GAAI,GAAG,EAAI,CAAC,IAAK,IAAK,GAAG,CACxD,CAAC,EACD,IAAI1B,EAAa,CACfvS,GAAI,WACJuK,KAAMoK,EACNmC,YAAaxC,EAAWF,OAAUzK,GAAWA,EAAI,KACjD8N,WAAYxD,EAAOuB,EAAOkC,MAAM,CAAC,EAAIlC,EAAOmC,QAAA,EAAUD,MAAM,CAAC,EAC7DtT,SAAAA,EACAwT,cAAe,GACfC,eAAgB,CAAC,EAAGrD,CAAS,EAC7BxQ,eAAgBuG,GAAQA,EAAK6J,OAAS,GAAK,EAC3C5Q,SAAU6Q,EACVK,iBAAAA,EAEAyC,SAAU,GACVC,QAAS,GACT/W,OAAAA,EACAqO,gBAAAA,EACAwE,SAAAA,GACAC,YAAa,CACXnP,eAAgB,CAAE8T,KAAM,gBAAiBC,SAAU,GAAK,EACxDX,QAAS,CAAEU,KAAM,gBAAiBC,SAAU,GAAI,CAClD,CACD,CAAA,CAAA,EAGH,OACGC,EAAAC,cAAAC,GAAA,CACCnB,OAAAA,EACAoB,WAAY,GACZC,gBAAiB,GACjBrD,UAAAA,EACAgB,WAAAA,EACAjB,QAAS4B,EACT2B,kBAAoBC,GAAWhD,EAAgBgD,EAAEvD,SAAS,CAAA,EAKvDiD,EAAAC,cAAAM,GAAA,CACCC,SAAUpD,EAAYqD,QAAQD,SAC9BE,oBAAqB,GACrBC,qBAAsBC,EACxB,CAAA,CAEJ,CAEJ,CCxHA,MAAAC,GAAA,CACA,SAAA,CACA,GAAA,CACA,QAAA,kBACA,QAAA,uBACA,UAAA,UACA,UAAA,YACA,YAAA,eACA,UAAA,YACA,MAAA,QACA,MAAA,OACA,EACA,GAAA,CACA,QAAA,mBACA,QAAA,eACA,UAAA,QACA,UAAA,cACA,YAAA,mBACA,UAAA,gBACA,MAAA,OACA,MAAA,QACA,CACA,CACA,EAqDAC,GAAAC,GAAA,CACA,KAAA,mBACA,KAAAF,GACA,WAAA,CACA,iBAAAG,GACA,YAAAC,GAAA,aACAC,GACA,UAAAC,GAAA,aACAC,GAAA,QAAA,aACA,YAAAC,EACA,EACA,MAAA,CACA,KAAA,CAAA,KAAA,OAAA,SAAA,EAAA,EACA,UAAA,CAAA,KAAA,OAAA,SAAA,EAAA,EACA,WAAA,OACA,OAAA,OACA,UAAA,OACA,EACA,KAAA,IAAA,CACA,MAAAC,EAAA,CAAA,aAAA,MAAA,cAAA,OAAA,EACA,MAAA,CACA,GAAA,MAAA,KAAA,MAAA,KAAA,KAAA,OAAA,CAAA,IACA,qBAAA,CACA,MAAA,GACA,YAAA,GACA,KAAA,GACA,WAAA,GACA,UAAA,GACA,aAAA,CAAA,EACA,OAAA,IACA,UAAA,EACA,OAAA,KACA,KAAA,EACA,iBAAA,EACA,EACA,mBAAA,CAAA,KAAA,GAAA,aAAA,CAAA,CAAA,EACA,WAAAA,EACA,aAAA,CAAA,UAAA,UAAA,UAAA,SAAA,EACA,aAAA,CAAA,EACA,aAAA,CAAA,EACA,WAAA,KACA,UAAAA,EAAA,GACA,YAAAlE,EAAA,MACA,WAAA,CACA,MAAA,GACA,YAAA,GACA,KAAA,GACA,WAAA,GACA,UAAA,GACA,aAAA,CAAA,EACA,OAAA,IACA,UAAA,EACA,OAAA,KACA,KAAA,CACA,EACA,QAAA,CACA,cAAA,GACA,UAAA,GACA,WAAA,GACA,UAAA,EACA,EACA,SAAA,CAAA,EAGA,SAAA,CAAA,IAAA,IAAA,aAAA,CAAA,EAAA,OAAA,CAAA,EACA,iBAAA,CAAA,EACA,WAAA,GACA,cAAA,GACA,SAAA,GACA,kBAAA,GACA,mBAAA,GACA,sBAAA,CAAA,EACA,aAAA,yCACA,SAAA,KAKA,QAAA,IAAA,CAEA,EACA,SAAA,CACA,SAAA,CACA,OAAA,IAAAmE,GAAA,KAAA,WAAAnE,CAAA,CACA,EACA,YAAA,CACA,MAAAoE,EAAA,KAAA,OAAA,MAAA,YAAA,OACAnY,GAAAA,EAAA,OAAA,KAAA,IAAA,EAEA,GAAAmY,EAAA,SAAA,EACA,cAAA,IAAA,iBAAA,EACA,MAEA,OAAAA,EAAA,EACA,EAEA,cAAA,CACA,OAAA,KAAA,YACA,EAEA,aAAA,CACA,KAAA,CAAAC,EAAAtV,CAAA,EAAA,KAAA,kBAAA,MAAA,GAAA,EACA,OAAA,KAAA,aAAAsV,GAAAtV,GAAA,KACA,EACA,eAAA,CACA,OAAA,KAAA,WAAA,UAAA,CACA,EAEA,UAAA,CACA,MAAA,CACA,OAAA,KAAA,GACA,UAAA,KAAA,UACA,SAAA,IACA,KAAA,KAAA,OAAA,MAAA,WACA,KAAA,KAAA,SACA,QAAA,KAAA,cACA,WAAA,KAAA,iBACA,iBAAA,KAAA,WAAA,iBACA,UAAA,KAAA,WAAA,UACA,OAAA,KAAA,YACA,OAAA,KAAA,WAAA,OACA,iBAAA,KAAA,SACA,gBAAA,IACA,QAAA,KAAA,WAAA,CAEA,EACA,WAAA,CACA,MAAAuV,EAAA,CACA,KAAA,UACA,GAAA,WAAA,EAGAC,EAAA,CACA,KAAA,QACA,GAAA,WAAA,EAGA,OAAA,KAAA,OAAA,MAAA,cAAAC,GAAA,SAAAD,EAAAD,CACA,CACA,EACA,MAAA,CACA,eAAA,CACA,KAAA,eAAA,KAAA,YAAA,UAAA,OAAA,GACAtE,EAAA,OACA,eACA,OAAA,OAAA,CAAA,EAAA,KAAA,YAAA,UAAA,CAAA,MAAA,GAAA,CAAA,CAGA,EACA,0BAAA,CACA,KAAA,WAAA,kBACAF,EAAA,KAAA,KAAAA,EAAA,KAAA,KACA,CACA,EACA,QAAA,CACA,YAAAyB,EAAAC,EAAA,CACA,QAAA,IAAA,CAAA,OAAAD,EAAA,MAAAC,CAAA,CAAA,EACAD,EAAA,MACA,KAAA,eAAAA,EAAAC,CAAA,EADA,KAAA,iBAAA,CAEA,EAEA,kBAAA,CACA,KAAA,2BAAA,CAAA,CAAA,CACA,EAEA,eAAAiD,EAAAjD,EAAA,OACA,GAAA,CAAAA,EAAA,SAAA,SAAA,CACA,KAAA,sBAAA,GACA,KAAA,SAAA,KACA,KAAA,2BAAAiD,CAAA,EACA,MACA,CAGA,MAAAnY,GAAAoY,EAAAD,GAAA,YAAAA,EAAA,SAAA,YAAAC,EAAA,MACApY,IAAA,SACAA,KAAA,KAAA,sBACA,OAAA,KAAA,sBAAAA,GAEA,KAAA,sBAAAA,GAAAmY,EAAA,OAAA,OAEA,KAAA,SAAA,KAAA,4BAEA,EAEA,2BAAAA,EAAA,CACA,KAAA,mBAEA,KAAA,mBAAA,GACAA,EAAA,OAIA,KAAA,mBAAA,GAFA,KAAA,mBAAA,GAKA,MAAAE,EAAA,KAAA,kBAAA,MAAA,GAAA,EAEA,IAAAC,EAAA,EACAC,EAAA,EAGA,GAAA,CAAA,KAAA,mBAEA,KAAA,SAAA,KACA,KAAA,sBAAA,GACA,KAAA,eAAAF,EAAA,GAAA,SAAAA,EAAA,EAAA,CAAA,MACA,CAEAC,EAAA,SAAAD,EAAA,EAAA,EACAE,EAAAD,EAAA,EAAAA,EAAA,EAAAA,EAAA,EAEA,MAAAE,EAAA,GAAAH,EAAA,KAAAC,IACAG,EAAA,KAAA,SAAAD,GAEA7T,EAAA,GAAA0T,EAAA,KAAAE,IACAG,EAAA,KAAA,SAAA/T,GAEAgU,EAAA,CAAA,EAEA,UAAAxD,KAAAgD,EAAA,OAAA,OAAA,CACA,MAAAS,EAAAzD,EAAA,MAAA,EACA0D,EAAA,CAAAH,EAAA,IAAAE,GAAAF,EAAA,IAAAE,EAAA,EAAA,EAEAD,EAAA,KAAA,CAEA,CAAAF,EAAA,IAAAG,GAAAH,EAAA,IAAAG,EAAA,EAAA,EAEAC,CAAA,CACA,EACA,KAAA,iBAAAF,CACA,CAEA,KAAA,WAAA,KAAA,SAAA,mBAAA,IACA,KAAA,sBAAA,GAEA,KAAA,UAAA,KAAA,WAAAJ,EACA,CAGA,KAAA,qBACA,KAAA,iBAAA,GAIA,EAEA,MAAA,eAAAO,EAAAC,EAAA,CACA,MAAAC,EAAAF,EAAAC,EAEA,KAAA,SAAA,KACA,KAAA,sBAAA,GAMA,KAAA,iBAAA,GACA,KAAA,kBAAA,GAAAD,KAAAC,IAQA,KAAA,SAAA,KAAA,SAAAC,GACA,KAAA,UAAA,KAAA,WAAAD,EACA,EAEA,MAAA,iBAAA,CACA,GAAA,MAAA,UAEA,SAAA,IAAA,kBAAA,EAEA,GAAA,CACA,MAAAE,EAAA,MAAA,KAAA,QAAA,YACA,KAAA,QAAA,UAAA,IAAA,KAAA,QAAA,UAAA,EAEA,KAAA,WAAAC,EAAA,MAAAD,CAAA,QACArC,GACA,QAAA,MAAAA,CAAA,CACA,EACA,EAEA,MAAA,eAAA,CACA,GAAA,KAAA,OAAA,CACA,KAAA,aAAA,EACA,KAAA,WAAA,OAAA,OAAA,CAAA,EAAA,KAAA,MAAA,EACA,KAAA,mBAAA,EACA,MACA,CAEA,IAAA,OAAA,eAAA,EAAA,KAAA,KAAA,QAAA,UAAA,EAGA,MAAA,KAAA,2BAEA,KAAA,sBAAA,CAEA,EAEA,uBAAA,CACA,IAAAuC,EAAA,aACA,KAAA,QAAA,YACAA,EAAA,OAAA,qCAAA,GAAA,aACA,SAAAA,EAAA,EAAA,IAAAA,EAAA,QAAAA,IAGA,KAAA,WAAA,CACA,MAAA,eACA,YAAA,KAAA,QAAA,WACA,KAAA,KAAA,QAAA,WACA,WAAAA,EACA,aAAA,CACA,eAAA,CACA,CAAA,MAAA,UAAA,EAAA,UAAA,EAAA,SAAA,EACA,CAAA,MAAA,eAAA,EAAA,QAAA,EAAA,OAAA,CACA,CACA,EACA,OAAA,KAAA,WAAA,OACA,UAAA,KAAA,WAAA,UACA,OAAA,KAAA,WAAA,OACA,KAAA,KAAA,WAAA,IAAA,EAEA,KAAA,MAAA,QAAA,KAAA,WAAA,KAAA,CAGA,EAEA,oBAAA,CACA,KAAA,WAAA,SAAA,KAAA,WAAA,OAAA,KAEA,KAAA,WAAA,YAAA,KAAA,WAAA,UAAA,EACA,EAEA,MAAA,0BAAA,CACA,GAAA,CAEA,MAAAC,EACA,KAAA,QAAA,WAAA,QAAA,GAAA,EAAA,GACA,KAAA,QAAA,WACA,KAAA,QAAA,UAAA,IAAA,KAAA,QAAA,WAEAH,EAAA,MAAA,KAAA,QAAA,YAAAG,CAAA,EACA,KAAA,qBAAA,OAAA,OAAA,GAAAF,EAAA,MAAAD,CAAA,CAAA,EACA,KAAA,aAAA,EACA,KAAA,cAAA,QAGA,QAAA,IAAA,QAAA,EAEA,KAAA,OAAA,OAAA,YAAA,CACA,KAAAI,EAAA,MACA,IAAA,iBACA,KAAA,mBAAA,KAAA,QAAA,aAAA,KAAA,QAAA,YAAA,CACA,CACA,CACA,EAEA,cAAA,CACA,QAAA,IAAA,sBAAA,EAEA,MAAAC,EAAA,IAAA,OAAA,eAAA,EAAA,KAAA,KAAA,QAAA,UAAA,EACA,IAAAC,EAAA,CAAA,EAEAD,GACA,QAAA,IAAA,UAAA,EACAC,EAAA,KAAA,uBAEA,QAAA,IAAA,SAAA,EACAA,EAAA,KAAA,QAGA,UAAA5U,KAAA,KAAA,mBACAA,KAAA4U,GACA,KAAA,OAAA,OAAA,YAAA,CACA,KAAAF,EAAA,MACA,IAAA,GAAA,KAAA,qCAAA1U,IACA,KAAA,iDAAA,CACA,EAIA4U,EAAA,QAAA,GACA,KAAA,OAAA,OAAA,YAAA,CACA,KAAAF,EAAA,QACA,IAAA,qBACA,KAAA,qDAAA,CACA,GAGAE,EAAA,KAAA,GAAAA,EAAA,KAAA,KACA,KAAA,OAAA,OAAA,YAAA,CACA,KAAAF,EAAA,QACA,IAAA,wCACA,KAAA,0CAAA,CACA,CAEA,EAEA,eAAA,CACA,KAAA,WAAA,OAAA,OAAA,CAAA,EAAA,KAAA,WAAA,KAAA,oBAAA,EAEA,KAAA,mBAAA,EAEA,MAAA,EAAA,KAAA,WAAA,MAAA,KAAA,WAAA,MAAA,kBACA,KAAA,MAAA,QAAA,CAAA,CACA,EAEA,MAAA,gBAAA,CACA,GAAA,KAAA,WAAA,KAAA,WAAA,UACA,GAAA,CAIA,MAAAG,EAAA,MAHA,MAAA,KAAA,QAAA,YACA,KAAA,QAAA,UAAA,IAAA,KAAA,WAAA,SAAA,GAEA,cACAC,EAAAC,GAAA,oBAAAF,CAAA,EACAC,IACA,KAAA,aAAA,sDAAAA,YACA7C,GACA,QAAA,MAAAA,CAAA,CACA,CAEA,EACA,2BAAA,CACA,MAAA+C,EAAA,OAAA,OAAA,KAAA,qBAAA,EACA,IAAApQ,EAAA,CAAA,EACAoQ,EAAA,IAAAha,GAAA4J,EAAAA,EAAA,OAAA5J,CAAA,CAAA,EAEA,MAAAwY,EAAA,CAAA,OAAA,CAAA,OAAA5O,CAAA,CAAA,EACA,KAAA,2BAAA4O,CAAA,CACA,EAEA,2BAIA,CACA,MAAAyB,EAAA,OAAA,KAAA,KAAA,qBAAA,EAAA,IAAAja,GAAA,SAAAA,CAAA,CAAA,EACA,OAAAia,EAAA,OAKA,CAAA,KAHA,OAAA,OAAA,KAAA,qBAAA,EACA,OAAA,CAAAja,EAAAX,IAAAW,EAAAX,EAAA,OAAA,CAAA,EAEA,YAAA4a,EAAA,OAAA,mBAAAA,GALA,IAMA,EAEA,MAAA,cAAA,CACA,MAAA/Q,EAAA,OAAA,OAAA,KAAA,QAAA,EAAA,GAAA,IAGA,GAAA,KAAA,WAAA,OAAA,CACA,OAAA,KAAA,WAAA,QAAA,WACA,KAAA,WAAA,OAAA,KAAA,WAAA,OAAA,MAAA,GAAA,EAAA,IAAA,MAAA,GAGA,MAAA4K,EAAA,CACA,UAAA,KAAA,WAAA,OAAA,GACA,SAAA,KAAA,WAAA,OAAA,GACA,QAAA,EACA,MAAA,EACA,KAAA,KAAA,WAAA,MAAA,GACA,KAAA,EAAA,EAIAD,EAAA,KAAA,KAAAA,EAAA,KAAA,IAAAC,CAAA,EAEA,MACA,CAGA,GAAA,CAAA5K,EAAA,OAAA,OAEA,IAAAgR,EAAA,EACA5H,EAAA,EACAC,EAAA,EAEA,MAAA4H,EAAAjR,EAAA,OAAA,EAEAkR,EAAA,IACA,QAAAta,EAAA,EAAAA,EAAAqa,EAAAra,GAAAsa,EACA9H,GAAApJ,EAAApJ,EAAA,GACAyS,GAAArJ,EAAApJ,EAAA,EAAA,GACAoa,IAGA5H,EAAAA,EAAA4H,EACA3H,EAAAA,EAAA2H,EAEA,MAAAG,EAAA,KAAA,OAAA,MAAA,UAEA/H,GAAAC,GACA,KAAA,OAAA,OAAA,eAAA,CACA,UAAAD,EACA,SAAAC,EACA,QAAA8H,EAAA,QACA,MAAAA,EAAA,MACA,KAAA,KAAA,WAAA,MAAAA,EAAA,KACA,KAAA,EAAA,CACA,CAEA,EAEA,gBAAA,CACA,KAAA,QAAA,IAAA,eAAA,KAAA,QAAA,EACA,MAAAC,EAAA,SAAA,eAAA,MAAA,KAAA,IAAA,EACA,KAAA,QAAA,QAAAA,CAAA,CACA,EAEA,UAAA,CACA,MAAAA,EAAA,SAAA,eAAA,MAAA,KAAA,IAAA,EACAC,EAAAD,GAAA,YAAAA,EAAA,cAAA,8BACA,GAAAC,EAAA,CACA,MAAAC,EAAAF,EAAA,YAAA,IAAA,QAAA,OACAC,EAAA,MAAA,MAAAC,CACA,CACA,EAEA,MAAA,aAAAf,EAAA,CACA,KAAA,QAAA,cAAA,kBAGA,KAAA,WAAA,IAAAgB,GAEA,KAAA,WAAA,UAAA,MAAAZ,GAAA,CACA,GAAAA,EAAA,KAAA,OACA,KAAA,QAAA,cAAAA,EAAA,KAAA,eACAA,EAAA,KAAA,MACA,KAAA,QAAA,cAAAA,EAAA,KAAA,MACA,KAAA,OAAA,OAAA,YAAA,CACA,KAAAH,EAAA,MACA,IAAA,gBACA,KAAA,kEAAA,CACA,MACA,CACA,KAAA,CAAA,SAAAgB,EAAA,aAAAC,GAAAd,EAAA,KACA,KAAA,YAAA,KAAA,WAAA,YACA,KAAA,aAAA,CAAA,SAAAa,EAAA,aAAAC,CAAA,CAAA,CACA,CAAA,EAGA,KAAA,WAAA,YAAA,CACA,SAAAlB,EACA,WAAA,KAAA,WACA,aAAA,KAAA,WAAA,aACA,WAAA,KAAA,WAAA,UAAA,CACA,CACA,EAEA,aAAA,CAAA,SAAAiB,EAAA,aAAAC,GAAA,CACA,KAAA,aAAAA,EACA,KAAA,SAAAD,EAEA,MAAAE,EAAA,KAAA,kBAAA,WAAA,IAAA,EAAA,EACA,KAAA,SAAA,KAAA,SAAAA,GAEA,KAAA,aAAA,EACA,KAAA,SAAA,EACA,KAAA,QAAA,cAAA,EACA,EAEA,MAAA,WAAA,CACA,IAAAC,EAAA,CAAA,EACA,GAAA,CAAA,KAAA,QAAA,MAAA,CAAA,UAAAA,CAAA,EAEA,GAAA,CACA,IAAApB,EAAA,GAAA,KAAA,QAAA,aAAA,KAAA,WAAA,OACA,MAAA,KAAA,aAAAA,CAAA,QACA,GACA,QAAA,MAAA,CAAA,EACA,KAAA,QAAA,cAAA,GAAA,EACA,KAAA,OAAA,OAAA,YAAA,CACA,KAAAC,EAAA,MACA,IAAA,wBACA,KAAA,0EAAA,CACA,CACA,CACA,CACA,EACA,MAAA,SAAA,CACA,KAAA,OAAA,OAAA,gBAAA,CAAA,KAAA,SAAA,EAEA,KAAA,QAAA,UAAA,KAAA,UACA,KAAA,QAAA,WAAA,KAAA,YAAA,GACA,KAAA,QAAA,UAAA,KAAA,UAEA,MAAA,KAAA,gBAEA,MAAA,YAEA,KAAA,eAAA,EAEA,KAAA,QAAA,cAAA,GAAA,KAAA,MAAA,EAAA,SAAA,IACA,KAAA,aAAA,KAAA,WAAA,aAGA,MAAA,KAAA,YAIA,KAAA,eAAA,EAEA,KAAA,SAAA,GACA,KAAA,eAAA,OAAA,KAAA,KAAA,YAAA,EAAA,GAAA,CAAA,EACA,EAEA,eAAA,CAEA7F,EAAA,KAAA,IAAA,OACA,OAAAA,EAAA,KAAA,IAEA,GAAA,CACA,KAAA,YACA,KAAA,WAAA,kBAEAoD,GACA,QAAA,KAAAA,CAAA,CACA,CAEA,KAAA,OAAA,OAAA,gBAAA,EAAA,CACA,CACA,CAAA,EC7uBA,IAAI6D,GAAS,UAAY,CACvB,IAAIC,EAAI,KACJC,EAAGD,EAAI,eACPE,EAAGF,EAAI,MAAM,IAAIC,EAErB,OAAOC,EAAG,MAAO,CACf,YAAa,cACb,MAAO,CACL,iBAAkB,CAACF,EAAI,SACxB,EACD,MAAO,CACL,cAAiB,eACjB,GAAM,MAAMA,EAAI,IACjB,CACL,EAAK,CAAC,CAACA,EAAI,WAAaA,EAAI,SAAWE,EAAG,kBAAmBF,EAAI,GAAG,CAChE,YAAa,WACjB,EAAK,kBAAmBA,EAAI,SAAU,EAAK,CAAC,EAAIA,EAAI,GAAI,EAAGA,EAAI,UAAiCA,EAAI,GAAE,EAA3BE,EAAG,cAAc,EAAeF,EAAI,UAExGA,EAAI,KAFgHE,EAAG,eAAgB,CAC1I,YAAa,cACd,CAAA,EAAcF,EAAI,UAAY,CAACA,EAAI,WAAaA,EAAI,WAAW,MAAQE,EAAG,MAAO,CAChF,YAAa,WACjB,EAAK,CAACA,EAAG,oBAAqB,CAC1B,MAAO,CACL,UAAa,OACb,OAAU,EACX,CACF,EAAE,CAACF,EAAI,SAAWE,EAAG,MAAO,CAC3B,YAAa,cACb,YAAa,CACX,MAAS,MACV,CACL,EAAK,CAACA,EAAG,IAAK,CACV,YAAa,MACb,YAAa,CACX,aAAc,MACf,CACF,EAAE,CAACF,EAAI,GAAGA,EAAI,GAAGA,EAAI,GAAG,WAAW,CAAC,EAAI,GAAG,CAAC,CAAC,EAAGE,EAAG,KAAM,CACxD,YAAa,CACX,aAAc,OACf,CACL,EAAK,CAACF,EAAI,GAAGA,EAAI,GAAGA,EAAI,GAAG,OAAO,CAAC,EAAI,KAAOA,EAAI,GAAGA,EAAI,SAAS,WAAW,EAAI,KAAOA,EAAI,GAAGA,EAAI,GAAG,OAAO,CAAC,EAAI,KAAOA,EAAI,GAAGA,EAAI,SAAS,IAAI,CAAC,CAAC,CAAC,EAAGE,EAAG,SAAU,CAChK,YAAa,SACb,YAAa,CACX,MAAS,OACT,eAAgB,MACjB,EACD,GAAI,CACF,MAASF,EAAI,yBACd,CACF,EAAE,CAACA,EAAI,GAAGA,EAAI,GAAGA,EAAI,GAAG,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAIA,EAAI,GAAE,CAAE,CAAC,CAAC,EAAG,CAAC,EAAIA,EAAI,GAAE,EAAIA,EAAI,UAAY,CAACA,EAAI,WAAa,CAACA,EAAI,QAAQ,cAAgBE,EAAG,MAAO,CACnJ,YAAa,eACjB,EAAK,CAACF,EAAI,GAAG,OAAO,KAAKA,EAAI,YAAY,EAAG,SAAU3C,EAAO,CACzD,OAAO6C,EAAG,MAAO,CACf,IAAK7C,EACL,YAAa,YACnB,EAAO,CAAC6C,EAAG,IAAK,CACV,YAAa,aACnB,EAAO,CAACF,EAAI,GAAGA,EAAI,GAAG3C,CAAK,CAAC,CAAC,CAAC,EAAG2C,EAAI,GAAGA,EAAI,aAAa3C,GAAQ,SAAU8C,EAASpb,EAAG,CACjF,OAAOmb,EAAG,SAAU,CAClB,IAAKnb,EACL,YAAa,qCACb,MAAO,CACL,gBAAiB,UACjB,MAASib,EAAI,oBAAsB,GAAG3C,KAAStY,IAAM,QAAUib,EAAI,aAAajb,GAChF,OAAU,aAAaib,EAAI,aAAajb,KACxC,eAAgB,gBAAgBib,EAAI,aAAajb,KACjD,gBAAiB,MACjB,mBAAoBib,EAAI,oBAAsB,GAAG3C,KAAStY,IAAMib,EAAI,aAAajb,GAAKib,EAAI,OAAO,MAAM,WAAa,OAAS,OAC9H,EACD,GAAI,CACF,MAAS,SAAUI,EAAQ,CACzB,OAAOJ,EAAI,eAAe3C,EAAOtY,CAAC,CACnC,CACF,CACT,EAAS,CAACib,EAAI,GAAGA,EAAI,GAAGG,EAAQ,KAAK,CAAC,CAAC,CAAC,CACxC,CAAK,CAAC,EAAG,CAAC,CACV,CAAG,EAAGD,EAAG,MAAO,CACZ,YAAa,kBACjB,EAAK,CAACA,EAAG,IAAK,CACV,YAAa,aACjB,EAAK,CAACF,EAAI,GAAGA,EAAI,GAAGA,EAAI,GAAG,WAAW,CAAC,EAAI,KAAOA,EAAI,GAAGA,EAAI,WAAW,SAAS,CAAC,CAAC,CAAC,EAAGE,EAAG,aAAc,CACpG,YAAa,eACb,MAAO,CACL,IAAO,EACP,IAAO,IACP,SAAY,EACZ,SAAY,EACZ,QAAW,GACX,QAAW,MACZ,EACD,MAAO,CACL,MAAOF,EAAI,WAAW,UACtB,SAAU,SAAUK,EAAK,CACvBL,EAAI,KAAKA,EAAI,WAAY,YAAaK,CAAG,CAC1C,EACD,WAAY,sBACb,CACL,CAAG,EAAGH,EAAG,IAAK,CACV,YAAa,aACd,EAAE,CAACF,EAAI,GAAG,eAAiBA,EAAI,GAAGA,EAAI,WAAW,MAAM,CAAC,CAAC,CAAC,EAAGE,EAAG,aAAc,CAC7E,YAAa,eACb,MAAO,CACL,IAAO,GACP,IAAO,IACP,SAAY,EACZ,SAAY,EACZ,QAAW,GACX,QAAW,MACZ,EACD,MAAO,CACL,MAAOF,EAAI,WAAW,OACtB,SAAU,SAAUK,EAAK,CACvBL,EAAI,KAAKA,EAAI,WAAY,SAAUK,CAAG,CACvC,EACD,WAAY,mBACb,CACL,CAAG,CAAC,EAAG,CAAC,CAAC,EAAG,CAAC,EAAIL,EAAI,GAAE,EAAI,CAACA,EAAI,WAAaA,EAAI,QAAQ,cAAgBE,EAAG,MAAO,CAC/E,YAAa,SACjB,EAAK,CAACA,EAAG,IAAK,CACV,YAAa,gBACjB,EAAK,CAACF,EAAI,GAAGA,EAAI,GAAGA,EAAI,QAAQ,aAAa,CAAC,CAAC,CAAC,CAAC,CAAC,EAAIA,EAAI,GAAI,CAAA,EAAG,CAAC,CAClE,EACIM,GAAkB,CAAE"}